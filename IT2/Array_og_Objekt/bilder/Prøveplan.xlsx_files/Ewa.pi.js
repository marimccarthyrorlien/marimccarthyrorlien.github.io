function $d(){}Type.registerNamespace("Common.App.ImageProcessor");Common.App.ImageProcessor.a=function(n){this.b=n;this.a=this.b.b("UserAction","ImageProcessor");this.c=67};Common.App.ImageProcessor.a.prototype={b:null,a:null,c:0,f:function(n,t){var u=null;if(n){var i=n.width,r=n.height,f=this.e(i,r,t);i=Math.floor(i*f);r=Math.floor(r*f);try{u=this.d(n,i,r)}catch(e){Diag.a.a(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+e.message+", Call stack: "+e.stack)}}return u},d:function(n,t,i){var r,o,s,h;if(t<=0||i<=0)return null;var u=0,f=0,e=0;return this.a.d(),r=document.createElement("canvas"),r.width=t,r.height=i,o=r.getContext("2d"),u=this.a.b(),o.drawImage(n,0,0,t,i),f=this.a.b()-u,s=r.toDataURL("image/png",null),e=this.a.b()-(u+f),h=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",n.width,n.height,t,i,u,f,e),Diag.a.a(20841028,813,50,h),s},e:function(n,t,i){return n<=0||t<=0?0:i>0&&(n>i||t>i)?Math.min(i/n,i/t):1}};Type.registerNamespace("Common.App.InsertFile");Common.App.InsertFile.a=function(n,t){this.S=Function.createDelegate(this,this.bv);Common.App.InsertFile.a.initializeBase(this);this.Q=n;this.cu=!1;this.y=!1;this.o=this.bc();this.j(1,this.T());this.M(this.bd(),this.S);t&&this.bl();this.bS=!1};Common.App.InsertFile.a.a=function(n){var t=document.getElementById("errorText");t.innerText=n;t.style.display="inline-block"};Common.App.InsertFile.a.prototype={Q:null,a:null,ca:function(){this.a.a||Diag.a.a(25798091,322,10,"UploadFrame.FileInputElement is null");var n=this.a.a.value;return n?!0:(Common.App.InsertFile.a.a($a.cN),!1)},bv:function(n){n===1&&this.be()?(this.cD(),this.Q.f(this.a,this.de)):n||this.h()},bl:function(){this.a=this.bk(document.getElementById("uploadFrameContainer"),this.Q);this.a.a||Diag.a.a(25798092,322,15,"UploadFrame.FileInputElement is null")},dispose:function(){this.a=null;CommonUI.b.prototype.dispose.call(this)}};Common.App.InsertFile.c=function(n,t,i){this.o=Function.createDelegate(this,this.K);this.n=Function.createDelegate(this,this.V);this.C=Function.createDelegate(this,this.U);this.D=n;this.I=t;this.d=i;this.e=!1;this.q=!0;this.W();this.v=this.d.a("NativeFileOpenDialogIsEnabled")};Common.App.InsertFile.c.prototype={I:null,D:null,d:null,e:!1,p:null,q:!1,b:null,v:!1,E:0,F:0,G:0,H:0,i:null,V:function(n){if(this.b=n,!this.e){if(this.q){if(this.v&&Common.c.m()){this.i=n.E(this.C);return}if(this.i=n.E(null),!this.s(this.i,n))return}this.f(n,null)}},U:function(n){this.s(n,this.b)&&((Common.c.m()||Common.c.c())&&(this.i=n),this.f(this.b,null))},r:function(){this.p&&this.p()},W:function(){this.E=0;this.F=this.d.b("Box4UploadRetryCount",20);this.G=this.d.b("Box4UploadRetryDelayStart",200);this.H=this.d.b("Box4UploadRetryDelayMax",3200);this.b&&(this.b.dispose(),this.b=null)}};Common.App.InsertFile.b=function(n,t){this.b=n;this.a=t};Common.App.InsertFile.b.prototype={b:null,a:null};Common.App.InsertFile.d=function(n,t,i,r,u,f,e,o,s){this.w=Function.createDelegate(this,this.J);this.z=Function.createDelegate(this,this.Q);this.x=Function.createDelegate(this,this.K);this.y=Function.createDelegate(this,this.N);this.g=n;this.r=t;this.o=i;this.m=r;this.p=f;this.j=e;this.k=s;this.i=!1;this.b=document.createElement("iframe");this.b.className=u;this.b.id=u;this.m&&(this.b.style.visibility="visible",this.b.style.height="30px",this.b.setAttribute("frameborder","0"));this.h=this.y;Common.j.a(this.b,"load",this.h);o&&this.B()};Common.App.InsertFile.d.prototype={t:"FileUpload.ashx",b:null,n:!1,r:null,o:null,l:null,g:null,c:null,a:null,h:null,e:null,m:!1,p:null,j:null,k:null,d:null,s:!1,i:!1,q:function(){return Common.a.a?Common.a.a.a("NativeFileOpenDialogIsEnabled"):!1},M:function(){return this.b.contentWindow.location.pathname.endsWith(this.t)},E:function(n){return(Common.a.b().x(),!this.a)?(Diag.a.a(25798093,322,50,"_fileInput is null"),""):(this.q()&&Common.c.m()&&(this.l=n,this.e=this.x,Common.j.a(this.a,"change",this.e)),this.L(),this.a.value)},K:function(){this.l&&this.l(this.a.value)},L:function(){for(var n=!1;!n;)try{Diag.a.a(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element.");this.a.click();n=!0}catch(t){Diag.a.a(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",t.message)}},O:function(){this.c.submit()},P:function(n){var t,i;this.c.removeChild(this.a);t=new(Type.parse("FormData"))(this.c);t.append("applicationfileInput",n.a,n.b);i=this.C();this.d=new XMLHttpRequest;this.d.open("POST",i);this.d.onreadystatechange=this.z;this.d.send(t)},Q:function(){this.d.readyState===4&&this.v(this.d.responseText)},dispose:function(){this.s||(this.g.removeChild(this.b),Common.j.c(this.b,"load",this.h),this.h=null,this.e&&(Common.j.c(this.a,"change",this.e),this.e=null),this.b=null,this.g=null,this.c=null,this.a=null,this.s=!0,Diag.a.a(25798094,322,50,"UploadFrame disposed"))},J:function(){this.dispose()},I:function(n,t){var i=this.b.contentWindow.document.createElement("input");i.type="hidden";i.id=n;i.name=n;i.value=t;this.c.appendChild(i)},N:function(){try{if(!this.b.contentWindow.document.body)return}catch(t){this.G();return}if(this.n||this.q()&&Common.c.m()){if(!(this.q()&&Common.c.m())||this.M()){var n;n=Common.c.a()?this.b.contentWindow.document.body.innerText:this.i?this.b.contentWindow.document.body.firstChild.innerText:this.b.contentWindow.document.body.firstChild.innerHTML;this.v(n)}}else this.F()},F:function(){var n,t,i;if(!this.n){var u=this.u("uploadForm"),r=this.u("fileInput"),f=this.C();this.c=this.b.contentWindow.document.createElement("form");this.c.id=u;this.c.method="post";this.c.encoding="multipart/form-data";this.c.action=f;this.a=this.b.contentWindow.document.createElement("input");this.a.type="file";this.j&&(this.a.accept=this.j,this.k&&(this.a.capture=this.k));this.a.id=r;this.a.name=r;this.m&&(n=this.b.contentWindow.document.body,n.style.margin="0",n.style.overflow="hidden",t=Common.a.b(),this.a.style.fontFamily=t.G(),this.a.style.fontSize=t.H(),this.a.style.margin="0");i=document.getElementById("__REQUESTDIGEST");i&&this.I("__REQUESTDIGEST",i.value);this.D();this.c.appendChild(this.a);this.b.contentWindow.document.body.appendChild(this.c);this.n=!0;this.r(this)}},B:function(){this.g.appendChild(this.b);this.q()&&Common.c.m()&&this.F()},C:function(){var t=new Common.bx(this.t),n;return Common.a.bo(t),this.H(t),n=t.toString(),(Common.c.c()||Common.c.m()||Common.c.l())&&(n=Common.l.n(n)),n},A:function(){var n=new Common.I(2,1,0,this.w,4,null);Common.a.e().a(n)}};Common.App.InsertFile.a.registerClass("Common.App.InsertFile.a",CommonUI.b);Common.App.InsertFile.c.registerClass("Common.App.InsertFile.c");Common.App.InsertFile.d.registerClass("Common.App.InsertFile.d",null,Sys.IDisposable);Type.registerNamespace("Common.App.InsertPicture");Common.App.InsertPicture.c=function(n,t){Common.App.InsertPicture.c.initializeBase(this,[n,t])};Common.App.InsertPicture.c.prototype={T:function(){return $a.cQ},bd:function(){return $a.cT},bc:function(){return Common.App.InsertPicture.b.b()},ca:function(){var n,t;return(this.a.a||Diag.a.a(25798095,322,10,"UploadFrame.FileInputElement is null"),n=Common.App.InsertPicture.a.b(this.a.a.value),n)?(t=Common.App.InsertPicture.a.c(n),Common.App.InsertFile.a.a(t),!1):!0}};Common.App.InsertPicture.a=function(n,t,i){Common.App.InsertPicture.a.initializeBase(this,[n,t,i])};Common.App.InsertPicture.a.c=function(n){switch(n){case 1:return $a.S;case 2:return $a.cU;default:return""}};Common.App.InsertPicture.a.d=function(n){for(var i=n.toLowerCase(),t=0;t<Common.App.InsertPicture.a.a.length;++t)if(i.endsWith(Common.App.InsertPicture.a.a[t]))return!0;return!1};Common.App.InsertPicture.a.b=function(n){return n?Common.App.InsertPicture.a.d(n)?0:2:1};Common.App.InsertPicture.a.prototype={c:null,j:null,Y:function(){return Common.a.b().c()},s:function(n,t){var i=Common.App.InsertPicture.a.b(n),r,u;return i?(t.A(),i===2&&(r=Common.App.InsertPicture.a.c(i),u=this.L(i),this.Z(u,r)),!1):!0},f:function(n,t){Diag.a.a(36783360,322,50,"PictureUploader.FinalizeUpload");this.p=t;this.N()&&this.ba();Common.PerfMetrics.a(5576);this.j=this.Y().a("LoadResource","PictureUploadTime");var i=this.O();i?this.J(n):this.r()},Z:function(n,t){var i=new CommonUI.d;i.g(0);i.e(n,$a.cS,t,null)},r:function(){Diag.a.a(36783361,322,50,"PictureUploader.OnUploadComplete");Common.App.InsertFile.c.prototype.r.call(this);this.j&&(this.j.a(),this.j=null);this.M()&&this.X()},ba:function(){this.c=new CommonUI.f(!1);this.c.P=$a.cV;this.c.g(5);this.c.C=!1;this.c.e(null,null,null)},X:function(){return this.c?(this.c.a(),this.c=null,!0):!1}};Common.App.InsertPicture.b=function(){};Common.App.InsertPicture.b.b=function(){return CommonUI.b.a(Common.App.InsertPicture.b.a,$a.cR,$a.S)};Common.App.InsertPicture.c.registerClass("Common.App.InsertPicture.c",Common.App.InsertFile.a);Common.App.InsertPicture.a.registerClass("Common.App.InsertPicture.a",Common.App.InsertFile.c);Common.App.InsertPicture.a.a=[".jpg",".jpeg",".png",".gif",".bmp",".tif",".tiff"];Common.App.InsertPicture.b.a="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'><\/div> <div class='WACDialogError' id='errorText' role='alert'>{1}<\/div> <\/div>";Type.registerNamespace("_Ewa");_Ewa.zt=function(n,t,i,r,u,f,e){_Ewa.zt.initializeBase(this,[n,t,i,r,u,!1]);this.q=!1;this.k=e;this.w=f;this.b=new _Ewa.jU(this.a.r(),this.n,this.o,!1,this.a)};_Ewa.zt.prototype={k:null,w:null,B:function(n,t,i){_Ewa.jT.prototype.B.call(this,n,t,i);this.k.SX(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))},u:function(n,t,i){_Ewa.jT.prototype.u.call(this,n,t,i);_Ewa.h.b(n.Errors)?this.k.SX(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",_Ewa.h.a(n.Errors,",")))):this.k.b(!0)},R:function(n){var e=null,i=this.w.split(","),r,o,f,t,u,s;for(r=i[0].indexOf("base64")>=0?window.self.atob(i[1]):window.self.decodeURI(i[1]),o=i[0].split(":")[1].split(";")[0],f=new Uint8Array(r.length),t=0;t<r.length;t++)f[t]=r.charCodeAt(t);e=new Blob([f],{type:o});u=e;u.name="Image.png";s=new Common.App.InsertFile.b(u.name,u);n.P(s)}};_Ewa.zu=function(n,t){this.e=Function.createDelegate(this,this.bx);_Ewa.zu.initializeBase(this,[n,!1]);this.R=t;this.d=n;this.b=Common.p.a();Common.App.InsertFile.a.prototype.bl.call(this);this.bw()};_Ewa.zu.prototype={R:null,d:null,c:null,P:!1,b:null,bk:function(n,t){return new _Ewa.jU(n,t.n,t.o,!0,this.R)},dispose:function(){this.bm();this.d=null;this.b=null;Common.App.InsertFile.a.prototype.dispose.call(this)},ca:function(){var i=this.d.S(this.a),n=this.d.T(this.a.a.value,i),t;return n?(t=this.d.y(n).Description,this.c.innerHTML=t,this.bJ(),!1):!0},be:function(){return!0},bw:function(){this.c=document.getElementById("errorText");this.c.style.display="inline-block";this.P=!1;this.c.innerHTML="";this.ba().style.maxWidth=this.ba().currentStyle.minWidth},bJ:function(){this.b.a("click",this.a.a,this.e);this.b.a("keydown",this.a.a,this.e);this.P=!0},bm:function(){this.P&&(this.b.b("click",this.a.a,this.e),this.b.b("keydown",this.a.a,this.e),this.P=!1)},bx:function(){return this.c.innerHTML="",this.bm(),!1}};_Ewa.zv=function(n){this.a=n};_Ewa.zv.prototype={a:null,q:function(n,t,i){if(this.a.c(237)&&i&&"dataUrl"in i){var r=new($$sc.D.$$(Boolean));return new _Ewa.zt(this.a,null,Common.C.a(),Common.a.a,i,i.dataUrl,r),r.a}return new _Ewa.jT(this.a,t,Common.C.a(),Common.a.a,i,!0),$$sc.a.a(Boolean,!0)},p:function(n,t){return t.a===1403967063&&this.a.p()},r:function(){return!1},s:function(n,t){return this.a.c(338)&&t===1403967063&&_Ewa.P.a(this.a).i()}};_Ewa.qA=function(n){_Ewa.qA.initializeBase(this,[n])};_Ewa.qA.a=function(n){_Ewa.U.a(86,new _Ewa.qA(n))};_Ewa.qA.prototype={k:function(){this.l([new _Ewa.zv(this.h)],null)}};_Ewa.jT=function(n,t,i,r,u,f){this.P=Function.createDelegate(this,this.be);_Ewa.jT.initializeBase(this,[null,i,r]);this.a=n;this.t=t;this.m=n.o().b("WebServiceCall","InsertPictureOperation");this.g=_Ewa.x.a().a(this.P,1e5,!1,!1);this.h=!1;this.l=this.a.f().InsertPictureMaxFileSizeBytes;u&&(this.z="TestOnly"in u);f&&this.bf()};_Ewa.jT.c=function(n){return!n||_Ewa.j.a(n,"UnknownError",!0)?2:_Ewa.j.a(n,"NoFileSelectedError",!0)?1:_Ewa.j.a(n,"FileTooBig",!0)?3:_Ewa.j.a(n,"MaxConnectionsReached",!0)?5:0};_Ewa.jT.b=function(n,t,i,r){return _Ewa.bh.a(1,0,0,n,t,i,r)};_Ewa.jT.a=function(n){switch(n){case 1:return 1;case 2:return 6}return 0};_Ewa.jT.prototype={m:null,t:null,A:null,x:null,g:null,h:!1,l:0,z:!1,a:null,bb:function(){return this.l/1048576},K:function(n){var t,u,i,r;this.m.a();this.g.a();t=n;u=!_Ewa.jU.a(t);u?(i=_Ewa.jT.c(t),i?(Diag.a.a(34193863,0,50,"Server returned error, response: {0}",t),this.Q(i)):this.bc(t)):(this.h?this.Q(4):(r=new Common.eu(0,2,null,null,!1,null,null,null),r.a=8,this.B(new Common.et(r),null,"InsertPictureWebMethod")),Diag.a.a(33863624,0,50,"Http Error occurred, isTimeoutError: {0}",this.h));Common.App.InsertPicture.a.prototype.r.call(this);this.dispose()},dispose:function(){System.a.a(this.g);this.b.A();this.a=null;this.g=null;this.b=null},f:function(n,t){Common.App.InsertPicture.a.prototype.f.call(this,n,t);var i=this,r=function(t,r){return i.A=t,i.x=r,i.m.d(),i.g.b(),i.h=!1,i.R(n),$$sc.a.a(Boolean,!0)},u=this,f=function(n){var t=new _Ewa.bj(510,0,n,8);return t.H=!0,t.u=u.t,t};_Ewa.T.a(this.a.g(),r,f,this.t)},S:function(n){var i=-1,t=n.a;return t&&t.files&&t.files.length>0&&(i=t.files[0].size),i},T:function(n,t){var i=_Ewa.jT.a(Common.App.InsertPicture.a.b(n));return i?i===6&&this.bd(n):t!==-1&&(Diag.a.a(34193864,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",t,this.l,this.a.b().bp()),t>this.l?i=3:t>this.a.b().bp()&&(i=7)),Diag.a.a(34193865,0,50,"Validated file on client, validation result: {0}",i),i},L:function(){return 0},O:function(){return!0},N:function(){return!0},M:function(){return!0},J:function(){},s:function(n,t){var r=this.S(t),i=this.T(n,r);return i?(this.e||i===1||this.bg(i),!1):!0},R:function(n){n.O()},y:function(n){var u=0,t=1,i=1,r="InsertPictureUnknownError",f=null,e;switch(n){case 1:u=1247;t=0;i=517;r="InsertPictureNoFileSelected";break;case 3:t=0;i=519;r="InsertPicturePictureTooBig";f=String.format(_Ewa.b.a().c(102),this.bb().toLocaleString());break;case 6:u=1251;t=0;i=523;r="InsertPictureUnsupportedFormat";break;case 7:u=1248;t=0;i=521;r="InsertPictureExceedWorkbookSize";break;case 4:u=1249;t=0;i=522;r="InsertPictureExceedUploadTimeout";break;case 5:u=1250;t=0;i=520;r="InsertPictureServiceNonDeterministicError"}return e=_Ewa.jT.b(u,t,i,r),f&&(e.Description=f),e},bf:function(){if(Diag.a.a(34193866,0,50,"Showing Insert Picture dialog"),!this.z&&(Common.c.j()||Common.c.m()))this.e=!1,this.b=new _Ewa.jU(this.a.r(),this.n,this.o,!1,this.a);else{this.e=!0;var n=new _Ewa.zu(this,this.a);this.b=n.a}},bc:function(n){var t={},r,i;try{t=_Ewa.H.b(n);_Ewa.y.a().b(this.m.c(),t.ServerCorrelationId,_Ewa.F.toString(0),"ServerActions");!_Ewa.h.b(t.Errors)&&t.Result&&(this.a.b().Q(t.StateId,"PictureUploaderWrapper.UploadResponseReceived"),r=t.Result,_Ewa.P.a(this.a).d(1,r,!1),i=this.a.a().a(_Ewa.gE,273,!1),i&&i.b(this.a,1,t.Result,t,"InsertPicture"),Diag.a.a(34193867,0,50,"Insert picture completed successfully :)"))}catch(u){Diag.a.a(25801035,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:-1,u)}this.u(t,null,"InsertPictureWebMethod")},Q:function(n){var i=this.y(n),t={};t.Errors=[i];this.u(t,null,"InsertPictureWebMethod")},u:function(n,t,i){this.A(n,t,i)},B:function(n,t,i){this.x(n,t,i)},bg:function(n){var t=this.y(n),i=new _Ewa.dF(this.a,t);i.v(!1)},be:function(){this.h=!0},bd:function(n){for(var i=this.a.f().InsertPicturUnsupportedExtensionsForLogging,r=n.toLowerCase(),t=0;t<i.length;++t)if(r.endsWith(i[t])){Diag.a.a(34193868,0,50,"Insert picture blocked invalid extension: {0}",i[t]);return}}};_Ewa.jU=function(n,t,i,r,u){_Ewa.jU.initializeBase(this,[n,t,i,r,"UploadFrame",u.b().h(),"image/*",!1,null]);this.f=u;this.i=!0;Common.App.InsertFile.d.prototype.B.call(this)};_Ewa.jU.a=function(n){return!n||_Ewa.j.a(n,"ServerUploadError",!1)};_Ewa.jU.prototype={f:null,u:function(n){return n},H:function(n){Diag.a.b(33863626,0,!!this.p,"SessionId shouldn't be null.");_Ewa.X.e(n,this.f.f());n.b("sessionId",this.p);var i=_Ewa.c.a(this.f).a(),t=_Ewa.k.c(i.D(),this.f);n.b("sheetName",this.f.e().a().a);n.b("row",t.FirstRow.toString());n.b("col",t.FirstColumn.toString())},D:function(){},G:function(){this.o("ServerUploadError")},v:function(n){this.o(n)}};_Ewa.jT.registerClass("_Ewa.jT",Common.App.InsertPicture.a,Sys.IDisposable);_Ewa.zt.registerClass("_Ewa.zt",_Ewa.jT);_Ewa.zu.registerClass("_Ewa.zu",Common.App.InsertPicture.c);_Ewa.qA.registerClass("_Ewa.qA",_Ewa.U);_Ewa.jU.registerClass("_Ewa.jU",Common.App.InsertFile.d);Type.registerNamespace("_Ewa");_Ewa.KZ=function(){};_Ewa.KZ.a=function(){_Ewa.g.a(function(n){_Ewa.qA.a(n)})};_Ewa.KZ.a();Type.registerNamespace("_Ewa");_Ewa.BQ=function(n,t){var i,r;this.a=new($$sc.v.$$(_Ewa.ro));this.b=n;this.c=t;i=this;this.e=function(n){return Promise.resolve(n)};r=this;this.d=function(n){return Promise.reject(n)}};_Ewa.BQ.prototype={a:null,b:null,e:null,d:null,c:null,j:function(n){var t,i;return this.k(n.a)?(Diag.a.a(37364047,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",n.a),t=this.a.a(n.a),this.a.b(n.a,n),i=t.g,t.f=!1,this.h(n,i)):(this.a.b(n.a,n),this.l(n))},k:function(n){return this.a.c(n)},l:function(n){var t=this;return new Promise(function(i,r){n.g=t.b.a(n).then(function(r){return i(null),t.f(n,r)},function(n){return r(null),t.d(n)})})},h:function(n,t){var i=this;return new Promise(function(r,u){n.g=t.then(function(t){return i.n(n,t),i.b.a(n).then(function(t){return r(null),i.f(n,t)},function(n){return u(null),i.d(n)})},function(n){return i.d(n)})})},f:function(n,t){return n.f&&(this.g(n.a),this.m(n,t)),this.e(t)},g:function(n){this.a.d(n)},m:function(n,t){var i=this.i();n.a===i&&this.b.d(n.b,t,n.c.b)},i:function(){var n=_Ewa.c.a(this.c).a().o(),t;return n||(t=_Ewa.k.a(_Ewa.c.a(this.c).a().a(),this.c),n=t.FirstRow+"_"+t.FirstColumn),n},n:function(n,t){n.b=null;n.e=t}};_Ewa.cl=function(){};_Ewa.cl.b=function(n){if(!n.clipboardItems)return!1;var t=n.clipboardItems.getItem("metadata/is-last-copy-was-external");return t?t==="1":!1};_Ewa.cl.c=function(n){return _Ewa.cl.b(n)&&!!n.clipboardItems.getItem("image/png")&&!n.clipboardItems.getItem("text/plain")};_Ewa.cl.a=function(n){if(n){var t=n.getCachedMetadata();if(t&&t.lastCopy)return t.lastCopy}return null};_Ewa.ev=function(){};_Ewa.ev.prototype={range:0,art:1};_Ewa.ev.registerEnum("_Ewa.ev",!1);_Ewa.Hs=function(){};_Ewa.kV=function(){};_Ewa.kV.b=function(n){return CommonUI.b.a(_Ewa.kV.a,_Ewa.b.a().a(16),_Ewa.b.a().a(n?18:17),_Ewa.b.a().a(19))};_Ewa.jr=function(n,t,i,r){var u,f;this.M=Function.createDelegate(this,this.X);this.N=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.V);this.P=Function.createDelegate(this,this.bd);this.E=Function.createDelegate(this,this.bc);this.D=Function.createDelegate(this,this.bb);this.C=Function.createDelegate(this,this.Y);this.w=Function.createDelegate(this,this.W);_Ewa.jr.initializeBase(this,[!1]);this.e=n;u=n.c();this.I=String.format("url({0}), auto",_Ewa.r.b.a(70));u.e().b(this.w);u.e().x(this.C);u.k().b(this.w);u.g().c(this.D);n.f().d(this.E);u.z(this.P);this.n=u.b();this.i=t;this.B=r;this.o=new _Ewa.jr.b;this.m=new _Ewa.jr.e;this.x=!1;f=this;this.l=new($$sc.y.$$($$sc.C.$$(_Ewa.dN)))(function(){return _Ewa.l.a(_Ewa.dN,u.a(),18,f.cT())});this.F=i;this.h=new _Ewa.dD(this.e.c(),this.e)};_Ewa.jr.c=function(n,t){return n<=1?n:Math.min(t,Math.ceil(Math.log(n)/Math.LN2))};_Ewa.jr.a=function(n,t){t.f=2;t.h=_Ewa.jr.c(n.length,31)};_Ewa.jr.prototype={n:null,B:null,I:null,j:0,t:null,g:null,A:null,f:null,z:null,e:null,G:!1,K:null,o:null,m:null,x:!1,h:null,c:function(){return!!(387&this.j)},b:function(){var n=this.e.a().a(),t=this.S(n);return t?this.K:null},l:null,y:function(){return this.c()?this.g:null},u:function(){return this.e.a().s()},bh:function(n){return this.e.a().t(n),n},i:null,F:null,dispose:function(){if(this.e){var n=this.e.c();n.e().d(this.w);n.e().A(this.C);n.k().d(this.w);n.g().e(this.D);this.e.f().c(this.E)}!this.l.b&&_Ewa.bI.a(this.l.a())&&System.a.a(this.l.a().a());this.e=null;this.g=null;this.A=null;this.z=null;this.f=null;_Ewa.IR.prototype.dispose.call(this)},q:function(n,t,i){var o=this.e.c(),y=t.a,s=!1,f=this.d(t,i),h=i.cutCopyText,c=i.inLoadedRange,l=i.duplicateCopy,e=i.pasteText,u=null,r,a,p,w,v;f&&(u=i.event);r=this.e.a().a();a=!0;switch(y){case-893975939:f||this.u()!==4?this.H(r,1,!f,c,l,t,h):(p=this.e.a().k(),this.H(p,i.cutCopyPasteFlag,!0,c,l,t,h));break;case 1902045020:this.H(r,2,!f,c,l,t,h);break;case 1696566924:this.T(t,o,f,r,u,e);break;case 1804571062:Diag.a.a(20821018,0,50,"PasteFormatting was clicked from ribbon");this.v(r,36,!0,t,u,e,!1);break;case 1766348718:this.v(r,68,!0,t,u,e,!1);break;case-958589048:Diag.a.a(22374108,0,50,"PasteTranspose was clicked from ribbon");this.v(r,516,!0,t,u,e,!1);break;case-185374993:this.v(r,20,!0,t,u,e,!1);break;case-617905554:case 808159687:w=o.E().a(1);!w&&o.P(r,1)?(v=0,this.u()===4&&(v=i.cutCopyPasteFlag),this.v(r,v,!f,t,u,e,!1)):(_Ewa.z.a(u,!0),s=!0);break;case 1872288872:s=!0;break;default:a=!1}return s&&this.k(!1),a?$$sc.a.a(Boolean,!0):_Ewa.I.a(y)},T:function(n,t,i,r,u,f){var e=this.e.a(),o,s;return(Diag.a.a(21303497,0,50,"FormatPainter was clicked, fromKeyboardShortcut = {0}",i),!r)?(Diag.a.a(22856003,0,10,"selctedRange should not be null during format paint"),null):(this.g=r.f(),Diag.a.a(22856004,0,50,"FormatPainter was clicked, fromKeyboardShortcut = {0}, SourceRange = {1}, this.gridControl.IsFormatPainterOn = {2}.",i,this.g,this.e.W()),this.e.W()?(Diag.a.a(21303500,0,50,"FormatPainter toggle off"),e.i(this.t),this.k(!1),this.e.bc(!1)):(o=this,this.t=function(){r=e.a();Diag.a.a(21303498,0,50,"FormatPainter handler, SourceRange = {0}, DestinationRange = {1}.",o.g,r.toString());o.v(r,36,!0,n,u,f,!0);o.k(!1)},this.g=r.f(),this.j=2,s=new _Ewa.bz(t.e()),s.d(r,this.e)&&this.h.c(r,2),this.f=this.n.j(),Diag.a.a(21303499,0,50,"FormatPainter toggle on"),e.j(this.t),e.x(this.I),this.e.bc(!0)),r)},p:function(n,t,i){var r=n===1&&!!i&&(!this.d(t,i)||!this.e.q());if(r)switch(t.a){case-893975939:case 1902045020:case 1804571062:case 1766348718:case-185374993:case-617905554:case 808159687:case 1872288872:case 1696566924:break;case-958589048:r=this.e.c().c(75);break;default:r=!1}return r},s:function(){return!1},r:function(){return!1},a:function(){this.k(!1)},d:function(n,t){return this.h.f(n,t)},J:function(n){return(n?this.z:this.f)===this.n.j()},v:function(n,t,i,r,u,f,e){t||(t=this.j);var o=this.e.c(),s=new _Ewa.bz(o.e());(o.P(null,1)||36===t&&s.a(4))&&(this.m.f(this.e.c(),this.i,this.c(),i,r.a,t),this.x=!1,this.c()||e?this.bf(n,t,r,u,e):this.be(n,t,i,r,f),this.x||this.m.c())},be:function(n,t,i,r,u){var o=this.e.c(),e,f;t!==36&&t!==68&&t!==516&&(e=i?this.i.c(!0):$$sc.a.a(String,u),this.x=!0,f=this,e.CWCT(function(t){var c=f.i.b(),o=t.a(),u=o===c,e=!f.i.a()&&(i||u),s=Common.c.e(),h=e&&i&&s;f.m.e(u,e,h);e?f.i.i(i,h,s,f.L):(u||f.bg(n,o,r),f.m.c())},o.j(),3,this.B||$$sc.c.a))},bf:function(n,t,i,r,u){var f=this.e.c(),o,s,a,e,h,c,l;if(!this.g||!n){Diag.a.a(22856005,0,10,"source range/destination range should not be null on PasteFromRange");return}if(o=this.h.e(t,this.g,n),!o){Diag.a.a(22856006,0,10,"paste range should not be null");return}if(s=_Ewa.k.a(this.y(),f),!s){Diag.a.a(22856007,0,10,"source should not be null");return}this.f&&(s.SheetName=this.f.d());a=_Ewa.k.a(n,f);e=this.j;e&=3;e|=-5&t;var p=this.J(!1)&&!!o.l(this.y())||!!(this.j&1)||this.u()===4,w=new _Ewa.jr.d(n.f(),o.f(),p,e),b=f.d().a().b(),v=this,k=function(n,t){return f.H(),_Ewa.id.a(f.d().a(),s,a,e,_Ewa.n.a(n,v.O),_Ewa.n.b(t,v.N),w,b,null)},y=new _Ewa.bj(506,0,k,0);y.t=1;f.g().a(y,i);u&&this.l&&_Ewa.bI.a(this.l.a())&&(h=this.y().l(this.e.n()),c=n.l(this.e.n()),h&&c&&this.f&&(l=_Ewa.k.a(h,f),l.SheetName=this.f.d(),this.l.a().a().c(this.e,l,_Ewa.k.a(c,f),null,!0,!1)));_Ewa.z.a(r,!0)},V:function(n,t){this.m.d(n,t);this.m.c();this.e.o()},bg:function(n,t,i){var r,c,l,e;if(!t||(t=_Ewa.j.h(t,"\n","\r")),r=this.e.c(),!!t&&!this.U(n,t))if(_Ewa.jr.a(t,i),t.length>102400)alert(_Ewa.b.a().b(6));else{var u,f,o=_Ewa.k.a(n,r),h=!this.n.a()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1&&_Ewa.j.j(t),s=r.d().a().b();h?(_Ewa.bI.a(this.l.a())&&this.l.a().a().d(r,_Ewa.c.a(r).j(n.g()),t,!0,null,!1),f=526,c=this,u=function(i,u){return r.H(),_Ewa.i.c(r.d().a(),o,t,_Ewa.bb.b(t,!0),!1,!1,63,i,u,n,s,null)}):(f=180,l=this,u=function(n,i){return r.H(),_Ewa.id.b(r.d().a(),o,t,n,i,null,s,null)});e=new _Ewa.bj(f,0,u,0);e.t=1;r.g().a(e,i)}},U:function(n,t){var i=this.F.a(n);try{return n.e(this.A)&&this.J(!0)&&_Ewa.j.a(t,i.toString().replace(new RegExp("\r\n","g"),"\n"),!1)}finally{i&&i.dispose()}},S:function(n){return this.G&&!!this.y()&&this.y().e(n)&&this.n.j()===this.f},H:function(n,t,i,r,u,f,e){var h=this.e.c(),s,o;this.k(!0);this.j=t;this.g=n.f();this.f=this.n.j();s=new _Ewa.bz(h.e());o=this.u()===4;this.o.f(this.e.c(),this.i,i,r,u,f.a,t,o);!o&&s.d(n,this.e)&&this.h.c(n,this.j);r||u?(this.Q(e,f,o),this.o.e(e)):this.h.g(n,f,this.M,null,null)},k:function(n){this.c()&&(this.j=0,this.A=this.g,this.g=null,this.z=this.f,this.f=null,n||this.i.g(),this.h.b());this.e.W()&&this.R()},R:function(){this.e.bc(!1);var n=this.e.a();n.x("default");n.i(this.t);this.t=null;this.e.c().F()},bi:function(){this.e.c().A(237279923,2,0,{cutCopyPasteFlag:this.j})},ba:function(n,t,i){var u=this.u()===4,r=t,f;Diag.a.a(22374109,0,50,"ClipboardManager.OnPasteRangeSuccess: Paste range completed. AreServerMessagesPresent: [{0}]. AreNonStatusMessagesPresent: [{1}] proxyFlags: [{2}] methodName: [{3}]",_Ewa.h.d(n.Errors),_Ewa.h.b(n.Errors),r.a,i);_Ewa.h.d(n.Errors)&&u&&!_Ewa.h.c(n.Errors,[159])?this.h.d(this.e.a().k()):u&&this.bh(-1);f=r.c;f&&this.k(!1);!_Ewa.h.b(n.Errors)&&r.b.e(this.e.a().a())&&this.e.a().e(r.b,r.d,0,!0)},Z:function(n,t,i){var r=t;Diag.a.a(22374110,0,50,"ClipboardManager.OnPasteRangeFailed: Paste range failed. proxyFlags: [{0}] methodName: [{1}]",r.a,i)},X:function(n,t){var r=this.u()===4,f=t,i,u;n.Errors&&n.Errors.length?(r&&this.h.d(this.e.a().k()),this.i.h(),this.k(!1),this.o.e("")):(this.G=!0,i=n.Result,this.K=i,this.Q(i,f,r),u=this,this.i.d(i,!0).CWCT(function(){u.o.e(i)},this.e.c().j(),3,this.B||$$sc.c.a))},Q:function(n,t,i){_Ewa.jr.a(n,t);i&&this.bi()},W:function(n,t){t.a&&t.a===this.f?this.h.c(this.g,this.j):this.h.b()},bb:function(n,t){t.a===1&&t.b.a.b()&2&&this.k(!1)},bc:function(){this.k(Common.c.o())},bd:function(n,t){t.b||this.k(!1)},Y:function(){this.c()&&this.J(!1)&&this.k(!1)}};_Ewa.jr.b=function(){};_Ewa.jr.b.prototype={a:null,c:null,d:null,b:0,f:function(n,t,i,r,u,f,e,o){this.b++;this.c=t;this.d=n;this.a={};this.a.a=n.f().UserSessionId;this.a.b=Common.c.k();this.a.c=Common.c.n();this.a.d=i;this.a.e=r;this.a.f=u;this.a.g=t.a();this.a.h=t.f();this.a.i=f;this.a.j=e;this.a.k=o;this.a.l=t.e();this.a.m="N/A";this.a.n="N/A"},e:function(n){if(this.b++,this.b!==2&&Diag.a.a(17154648,0,15,"ClipboardManager.CopyTelemetry.Log: Invalid Call Count:{0}. Expecting:{1}",this.b,2),this.a.o=this.b,this.b=0,this.c.a()&&!this.c.e()){var t=this;this.c.c(!0).CWCT(function(i){var r=i.a(),u,f;Common.c.k()&&(r=r.replace(new RegExp("\n","g"),"\r\n"));u=n===r||!n;f=r===t.c.b();t.a.m=u.toString();t.a.n=f.toString();_Ewa.y.a().a(4,t.a,!0);(!u||f)&&Diag.a.a(17154649,0,15,"ClipboardManager.CopyTelemetry.Log: Failure to Copy to clipboard. IsPasteMatchCopy: {0}. WaitMessageInClipboard: {1} ",t.a.m,t.a.n)},this.d.j(),3,$$sc.c.a)}else this.a.m="N/A",this.a.n="N/A",_Ewa.y.a().a(4,this.a,!0)}};_Ewa.jr.e=function(){};_Ewa.jr.e.prototype={a:null,b:0,f:function(n,t,i,r,u,f){this.b++;this.a={};this.a.a=n.f().UserSessionId;this.a.b=Common.c.k();this.a.c=Common.c.n();this.a.d=i;this.a.e=r;this.a.f=t.a();this.a.g=t.f();this.a.h=u;this.a.i=f;this.a.j="N/A";this.a.k="N/A";this.a.l="N/A";this.a.m="N/A";this.a.n="N/A"},e:function(n,t,i){this.b++;this.a.j=n.toString();this.a.k=t.toString();this.a.l=i.toString()},d:function(n,t){this.b++;this.a.m=n;this.a.n=t.toString()},c:function(){this.b++;(this.b<2||this.b>4)&&Diag.a.a(17154650,0,15,"ClipboardManager.PasteTelemetry.Log: Invalid Call Count:{0} Expecting in range [{1}, {2}]",this.b,2,4);this.a.o=this.b;this.b=0;_Ewa.y.a().a(5,this.a,!0)}};_Ewa.jr.d=function(n,t,i,r){this.d=n;this.b=t;this.c=i;this.a=r};_Ewa.jr.d.prototype={c:!1,d:null,b:null,a:0};_Ewa.jp=function(n,t){this.f=n;this.g=t};_Ewa.jp.a=function(n){return String.format("{0}.{{{1}}}",n.length+2,n.toUpperCase())};_Ewa.jp.prototype={f:null,g:null,i:function(n,t,i,r,u,f,e){var l=this.f.d().a().b(),h=null,c,o={},a,s;o.CopyPasteTargetType=2;o.FloatingObjectId=n;u===2?(c=505,a=this,h=function(n,t){return _Ewa.ij.a(a.f.d().a(),o,_Ewa.n.a(n,r),f?_Ewa.n.b(t,f):t,i,l,e)}):(c=179,s=this,h=function(u,h){return s.h(t,n),s.f.H(),_Ewa.ij.c(s.f.d().a(),o,_Ewa.n.a(u,r),f?_Ewa.n.b(h,f):h,i,l,e)});this.f.g().a(new _Ewa.bj(c,0,h,16),i)},h:function(n,t){var r=n+"_"+t,i=_Ewa.P.a(this.f).b(r,null);i?(_Ewa.c.a(this.f).a().q(i,!0),i.r(!1)):Diag.a.a(37790621,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",n,t)},c:function(n){if(!n)return"";var i=new Common.App.ImageProcessor.a(this.f.o()),t=new Image;return t.src=n.attributes.getNamedItem("src").value,t.height=n.height,t.width=n.width,i.f(t,Math.max(t.height,t.width))},e:function(n,t){var r=n+"_"+t,i=_Ewa.P.a(this.f).b(r,null);i&&i.r(!0)},b:function(n){var t=n;this.i(t.e,t.b,t.a,t.f,t.c,t.d,t.g)},j:function(n,t,i,r,u,f,e,o){var s=this;return new Promise(function(h,c){var l=function(n){if(_Ewa.h.i(n.Errors))f&&(f.encounteredDeploymentErrors=!0),Diag.a.a(36538328,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(n.Errors,","));else if(_Ewa.h.b(n.Errors))Diag.a.a(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.h.a(n.Errors,",")),c(new _Ewa.bX(8,n.Errors,null,""));else if(n.Result){var t=n.Result;Diag.a.a(36229124,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");s.k(e,t.FloatingObjectId,n.StateId);h(_Ewa.jp.a(t.FloatingObjectId))}else Diag.a.a(36229125,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),c(new _Ewa.bX(8,n.Errors,null,""))},a=function(n){var t=_Ewa.X.a(n.b);Diag.a.a(36229126,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",_Ewa.h.a(t,","));c(new _Ewa.bX(8,t,null,""))};s.l(n,u,t,i,l,a,r,o)})},k:function(n,t,i){var r=this.f.a().a(_Ewa.gE,273,!1);if(r){var u=n+"_"+_Ewa.jp.a(t),f=this,e=function(){return!!_Ewa.P.a(f.f).b(u,null)};r.a(e,i,"PasteArt")}},m:function(n,t){!t||this.g.d(n,n.b+"_"+t)},a:function(n){var t=n,r=this,i=this;return this.j(t.i,t.b,t.e,t.k,t.j,t.h,t.c.b,t.d).then(function(n){return n},function(n){return i.m(t.c,t.d),Promise.reject(n)})},d:function(n,t,i){if(n||(n=_Ewa.k.a(_Ewa.c.a(this.f).a().a(),this.f)),_Ewa.c.a(this.f).bv(_Ewa.k.b(n),1))_Ewa.P.a(this.f).d(i,t,!0);else{var r=_Ewa.c.a(this.f).a().B(n,t,i),u=this;r.CW(function(n){var i=n.a();i?Diag.a.a(36459653,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",t):Diag.a.a(36459654,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",t)})}},l:function(n,t,i,r,u,f,e,o){var c=this.f.d().a().b(),s=this,l=function(n,h){o||s.f.H();var l={};return l.ShadowWorkbookBase64=t.shadowWorkbookBase64,l.FloatingObjectId=r,l.DestinationRange=i,l.CopyPasteTargetType=2,l.ClientEstimationFloatingObjectId=o,_Ewa.ij.b(s.f.d().a(),l,_Ewa.n.a(n,u),_Ewa.n.b(h,f),null,c,e)},h=new _Ewa.bj(503,0,l,0);h.t=1;this.f.g().a(h,n)}};_Ewa.vf=function(n){this.e=n};_Ewa.vf.prototype={e:null,f:null,h:null,g:15,b:function(n,t){this.f=n;this.h=t},a:function(){var n,t,i,r,u;return!this.f||!this.h?(Diag.a.a(37857495,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),""):(n=_Ewa.S.c(new _Ewa.fj(this.f),null),n.Id=_Ewa.jp.a(Common.O.a().a),n.Version=-1,n.IsClientEstimation=!0,t=this.i(n),!t)?null:(i=new _Ewa.fj(n),t.a.e().b(i),i.d=-1,r=_Ewa.P.a(this.e),r.m(i,t),u=r.b(n.Type+"_"+n.Id,null),u&&u.cQ(this.h),r.d(n.Type,n.Id,!0),n.Id)},c:function(n){return this.e.c(351)&&n.c(this.e)&&!_Ewa.c.a(this.e).d()&&!_Ewa.c.a(this.e).i().e()},d:function(n,t){if(this.c(n)){var i=_Ewa.P.a(this.e).b(t,null);i&&(Diag.a.a(38012936,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",t,i.a().a),_Ewa.P.a(this.e).c(i,15,!0),i.i()&&i.Q(i.i(),!1))}},i:function(n){var u,f,t,r,i;return n?_Ewa.c.a(this.e).a().o()?(u=_Ewa.c.a(this.e).a().p().a(),n.OriginDeltaX=u.n+this.g,n.OriginDeltaY=u.r+this.g,n.AbsoluteLeft=n.AbsoluteLeft+this.g,n.AbsoluteTop=n.AbsoluteTop+this.g,n.AbsoluteRight=n.AbsoluteRight+this.g,n.AbsoluteBottom=n.AbsoluteBottom+this.g,n.ZOrder=u.o+1,_Ewa.c.a(this.e).a().p().i()):!this.e.i()||!this.e.i().g()?(Diag.a.a(37857497,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null):(f=this.e.i().g(),t=_Ewa.c.a(this.e).D(f),!t)?(Diag.a.a(37857498,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",f.toString()),null):(r=_Ewa.o.j(t.e(),t.f().h()),i=t.c().y(f,2,!1),!r||!i)?(Diag.a.a(37857499,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",!r,!i),null):(n.OriginDeltaX=i.a.a-r.x,n.OriginDeltaY=i.a.b-r.y,n.AbsoluteLeft=i.a.a,n.AbsoluteTop=i.a.b,n.AbsoluteRight=n.AbsoluteLeft+Math.abs(this.f.AbsoluteRight-this.f.AbsoluteLeft),n.AbsoluteBottom=n.AbsoluteTop+Math.abs(this.f.AbsoluteBottom-this.f.AbsoluteTop),n.ZOrder=this.f.ZOrder+100,new _Ewa.eX(t.c().b().e(t.b()),t.b())):(Diag.a.a(37857496,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null)}};_Ewa.jo=function(n,t,i,r){_Ewa.jo.initializeBase(this,[n,t,i,r]);this.f=new _Ewa.nX(n)};_Ewa.jo.b=function(n,t){return(t.val=null,!n||!n.ShadowWorkbookBase64||!n.SourceRange)?!1:(t.val={},t.val.shadowWorkbookBase64=n.ShadowWorkbookBase64,t.val.rangeRowStart=n.SourceRange.FirstRow,t.val.rangeRowEnd=n.SourceRange.LastRow,t.val.rangeColumnStart=n.SourceRange.FirstColumn,t.val.rangeColumnEnd=n.SourceRange.LastColumn,!0)};_Ewa.jo.c=function(n,t){t.val=null;var i=n.getItem("data/shadow-workbook");return i?(t.val=JSON.parse(i),_Ewa.jo.a(t.val)):!1};_Ewa.jo.a=function(n){return!!n&&!!n.shadowWorkbookBase64&&!isUndefined(n.rangeRowStart)&&!isUndefined(n.rangeRowEnd)&&!isUndefined(n.rangeColumnStart)&&!isUndefined(n.rangeColumnEnd)};_Ewa.jo.prototype={f:null,serialize:function(n){var r=n.sourceItem,t={},i=this.d.b(r),u,f;if(i)t.synchronousResult=i,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.b();else{if(this.o(r.a)){Diag.a.a(26035413,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");u=this.g.a(r.a);try{f=u.toString();i=this.a.a();i.setItem("text/plain",f);this.d.a(r,i);t.synchronousResult=i;n.clientSideCopyTime=n.commandParameters.stopwatch.b()}finally{u&&u.dispose()}}else n.isAsyncCopy=!0,t.synchronousResult=this.a.a(),t.synchronousResult.setItem("text/plain",this.m());t.asynchronousResult=this.q(n,r)}return t},shouldWaitForCopyToComplete:function(n){return!n||!n.copyContextSnapshot?(Diag.a.a(39084501,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1):n.copyContextSnapshot.sessionId===this.b.b().h()?(Diag.a.a(39084502,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1):!0},onDeferredPasteStarted:function(n){this.f.d(n)},onDeferredPasteCompleted:function(n){this.f.c(n)},deserialize:function(n){var u,t,i,r,f,e;if(_Ewa.ie.a(n,1),n.isClipboardDataContainShadowWorkbook=!isNullOrUndefined(n.clipboardItems.getItem("data/shadow-workbook")),u=n.copyContextSnapshot,t=this.c.a(u),t&&this.k(n,t),_Ewa.cl.b(n))return this.i(n);if(i=n.commandParameters.originalDestination,t&&(i=_Ewa.nT.a(n,t),n.isSameSession))return this.p(n,u,t,i);if(n.commandParameters.commandType!==516){if(r=null,e=_Ewa.jo.c(n.clipboardItems,f={val:r}),r=f.val,e)return n.isShadowWorkbookParsedSuccessfully=!0,this.r(n,_Ewa.k.a(i,this.b),r);if(n.isClipboardInaccessible)return Promise.reject(new _Ewa.bX(7,null,null,""));if(n.commandParameters.commandType!==36)return this.n(n)}return Promise.reject(new _Ewa.bX(5,null,null,""))},r:function(n,t,i){return Diag.a.b(33863617,0,!!i,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null"),Diag.a.b(33863618,0,!!i.shadowWorkbookBase64,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: ShadowWorkbookBase64 shouldn't be null"),n.pasteResult="CrossSessionPaste",n.shadowWorkbookPayloadSize=i.shadowWorkbookBase64.length,n.shadowWorkbookPayloadSize>4194304?(Diag.a.a(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request.",n.shadowWorkbookPayloadSize,4194304),Promise.reject(new _Ewa.bX(1,null,null,""))):(Diag.a.a(33863619,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request..."),this.c.j(n.commandParameters.ribbonCommandInfo,t,i,[n.commandParameters.stopwatch],n))},q:function(n,t){var i=this;return new Promise(function(r,u){var f=function(f){var h,o,e,s,c,l,a;if(_Ewa.h.b(f.Errors))_Ewa.h.i(f.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538326,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(f.Errors,","))):(Diag.a.a(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.h.a(f.Errors,",")),u(new _Ewa.fi(2,f.Errors)));else{if(Diag.a.a(26035418,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed."),n.markForCancellation){u(new _Ewa.fi(3,f.Errors));return}h=f.Result;o=h.PlainTextResult;isNullOrUndefined(o)||(n.plainTextPayloadSize=o.length);e=i.a.a();(l=_Ewa.jo.b(h,c={val:s}),s=c.val,l)&&(n.shadowWorkbookPayloadSize=s.shadowWorkbookBase64.length,a=JSON.stringify(s),e.setItem("data/shadow-workbook",a));e.setItem("text/plain",o);i.d.a(t,e);r(e)}},e=function(n){var t=_Ewa.X.a(n.b);Diag.a.a(26035420,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.h.a(t,","));u(new _Ewa.fi(2,t))};Diag.a.a(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");i.c.i(t.a,n.commandParameters.ribbonCommandInfo,f,e,[n.commandParameters.stopwatch])})}};_Ewa.nS=function(n,t,i,r,u){_Ewa.nS.initializeBase(this,[n]);this.a=n;this.j=new _Ewa.nX(n);this.g=t;this.e=i;this.d=_Ewa.c.a(n).a();this.h=u||new _Ewa.nV(this.g);this.k=new _Ewa.BQ(i,n);this.f=r};_Ewa.nS.a=function(n){return n.b===1||n.b===5};_Ewa.nS.prototype={d:null,a:null,e:null,g:null,h:null,k:null,f:null,j:null,getSourceItem:function(){return Diag.a.b(36227297,0,!!this.d.o(),"Expecting a floating object to be currently selected for copy"),Diag.a.a(39682266,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.d.o()),new _Ewa.fV(this.d.o(),this.a.b().j().d(),this.a.b().g(),this.a.f().UserSessionId,this.d.c().a().a)},beforeSerialize:function(n){if(!n||!n.commandParameters){Diag.a.a(36227298,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.");return}_Ewa.ie.b(n);n.commandParameters.copyPasteTargetType=2},serialize:function(n){var i=n.sourceItem,t={},u,r,f,e;return i?this.r()?(Diag.a.a(39682267,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",i.a),this.t(),u=this.h.b(i),u?(t.synchronousResult=u,n.isFromCache=!0,n.isAsyncCopy=!1,n.clientSideCopyTime=n.commandParameters.stopwatch.b(),n.commandParameters.commandType===1&&this.a.isChangeGateEnabled("OfficeVSO:2728786_ArtCCP_DeleteFloatingObjectOnCopyFromCache")&&this.a.A(2045211913,n.commandParameters.ribbonCommandInfo.b,n.commandParameters.ribbonCommandInfo.c,null)):(n.isFromCache=!1,n.isAsyncCopy=!0,r=this.g.a(),this.a.c(464)?(Diag.a.b(39977874,0,!!this.d.c(),"Expecting a floating object to be currently selected for copy"),Diag.a.b(39977875,0,!!this.d.c().D(),"Expecting the selected floating object to have an img element"),f=_Ewa.c.a(this.a).a().c().D(),f&&(e=String.format("<img src='{0}'>",this.e.c(f)),r.setItem("text/html",e))):r.setItem("text/plain",""),t.synchronousResult=r,t.asynchronousResult=this.q(n,i)),t):(Diag.a.a(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),t):(Diag.a.a(36227299,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),t)},t:function(){var n=this.d.c();this.f.b(_Ewa.S.c(n.a(),null),_Ewa.S.q(n.F()))},shouldWaitForCopyToComplete:function(){return!0},onDeferredPasteStarted:function(n){this.j.d(n)},onDeferredPasteCompleted:function(n){this.j.c(n)},deserialize:function(n){var r,t,u,i,h,f,e,o,s;if(_Ewa.ie.a(n,2),n.activeSelectionType=this.p(),_Ewa.cl.b(n))return this.i(n);if(r=n.copyContextSnapshot,t=r.sourceItem,!t)return Promise.reject(new _Ewa.bX(9,null,null,""));if(n.isSameSession=t.c(this.a),!t.c(this.a)&&!_Ewa.nS.a(t))return u=String.format("User attempted to paste art of type [{0}] between sessions.",t.b),Diag.a.a(36229120,0,50,u),Promise.reject(new _Ewa.bX(10,null,null,u));if(r.isAsyncSerializeFailed)return Promise.reject(new _Ewa.bX(16,null,null,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{h=n.clipboardItems.getItem("data/shadow-workbook");i=JSON.parse(h)}catch(c){return Diag.a.a(38102659,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(c)),Promise.reject(new _Ewa.bX(11,null,c,""))}if(i.floatingObjectId!==t.a?Diag.a.a(40134681,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",t.a,i.floatingObjectId):Diag.a.a(39682268,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",t.a,i.floatingObjectId),!i||!i.shadowWorkbookBase64)return Promise.reject(new _Ewa.bX(12,null,null,String.format("shadowWorkbookPayload is null = {0}",!i)));if(n.isShadowWorkbookParsedSuccessfully=!0,n.shadowWorkbookPayloadSize=i.shadowWorkbookBase64.length,n.shadowWorkbookPayloadSize>4194304)return f=String.format("Shadow workbook size [{0}] is over the limit [{1}].",n.shadowWorkbookPayloadSize,4194304),Diag.a.a(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",f),Promise.reject(new _Ewa.bX(1,null,null,f));if(e=null,o=null,_Ewa.c.a(this.a).a().d()&70?o=_Ewa.c.a(this.a).a().o():e=this.a.i()&&this.a.i().g()?_Ewa.k.a(this.a.i().g(),this.a):_Ewa.k.a(n.commandParameters.originalDestination,this.a),s=null,this.f.c(t))try{s=this.f.a()}catch(l){Diag.a.a(37857494,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(l))}return this.k.j(new _Ewa.ro(n.commandParameters.ribbonCommandInfo,e,o,n.commandParameters.commandType,[n.commandParameters.stopwatch],i,t,n,s))},i:function(n){if(n.isExternalPaste=!0,this.a.c(237)&&n.clipboardItems.getItem("image/png")){var t=this,i=this;return $$sc.j.toPromise$t(Boolean,this.a.A(1403967063,n.commandParameters.ribbonCommandInfo.b,n.commandParameters.ribbonCommandInfo.c,{dataUrl:n.clipboardItems.getItem("image/png")})).then(function(n){return n?Promise.resolve(null):Promise.reject(new _Ewa.bX(15,null,null,""))},function(){return Promise.reject(new _Ewa.bX(15,null,null,""))})}return Diag.a.b(39965841,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler"),_Ewa.Hp.prototype.i.call(this,n)},p:function(){return _Ewa.c.a(this.a).a().d()&214?"FloatingObject":_Ewa.c.a(this.a).a().d()===1?"Cells":"Other"},r:function(){var n=_Ewa.c.a(this.a).a(),t;return!n.o()||!n.c()||!n.c().a()?!1:(t=n.c().a(),t.T())},q:function(n,t){var i=this;return new Promise(function(r,u){var f=function(f){var o,e,h,s;if(_Ewa.h.b(f.Errors))_Ewa.h.i(f.Errors)?(n.encounteredDeploymentErrors=!0,Diag.a.a(36538327,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(f.Errors,","))):(Diag.a.a(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.h.a(f.Errors,",")),u(new _Ewa.fi(4,f.Errors)));else{if(Diag.a.a(36229121,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",t.a),n.markForCancellation){u(new _Ewa.fi(3,f.Errors));return}if(_Ewa.h.d(f.Errors)&&Diag.a.a(39688195,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",_Ewa.h.a(f.Errors,",")),o=f.Result,o){e={};e.shadowWorkbookBase64=o?o.ShadowWorkbookBase64:null;e.floatingObjectId=t.a;n.shadowWorkbookPayloadSize=e.shadowWorkbookBase64?e.shadowWorkbookBase64.length:0;try{h=JSON.stringify(e)}catch(c){u(new _Ewa.bX(13,null,c,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",n.shadowWorkbookPayloadSize,e.floatingObjectId)));return}s=i.g.a();s.setItem("data/shadow-workbook",h);n.commandParameters.commandType===1&&(i.s(t.b,t.a,f.StateId),i.o(t.a,t.b));i.h.a(t,s);r(s)}else Diag.a.a(36508684,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",t.a),r(i.h.b(t))}},e=function(r){var f=_Ewa.X.a(r.b);n.commandParameters.commandType===1&&i.e.e(t.b,t.a);Diag.a.a(36229123,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",_Ewa.h.a(f,","));u(new _Ewa.fi(4,f))};i.e.b(new _Ewa.wd(t.a,n.commandParameters.ribbonCommandInfo,f,n.commandParameters.commandType,t.b,e,[n.commandParameters.stopwatch]))})},o:function(n,t){var u=t+"_"+n,i=_Ewa.P.a(this.a).b(u,null),r;i?(r=14,_Ewa.P.a(this.a).c(i,r,!0),_Ewa.c.a(this.a).a().Z(null)):Diag.a.a(37839768,0,100,"ArtCopyPasteHandler.DeleteFloatingObject: tried to delete a non existing floating object")},s:function(n,t,i){var f=this.a.a().a(_Ewa.gE,273,!1);if(f){var u=null,e=n+"_"+t,r=_Ewa.P.a(this.a).b(e,null);if(r&&r.i()&&(u=r.i().a),!u)return;var o=r.a().g(),h=this,s=function(){return!u.e().d(o)};f.a(s,i,"CutArt")}}};_Ewa.Hp=function(n){this.b=n;this.l=_Ewa.b.a();this.c=new _Ewa.dD(n,_Ewa.c.a(n))};_Ewa.Hp.prototype={b:null,l:null,c:null,m:function(){return this.l.b(5)},shouldWaitForCopyToComplete:function(){return!1},onDeferredPasteStarted:function(){},onDeferredPasteCompleted:function(){},i:function(n){return n.isExternalPaste=!0,n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?this.n(n):Promise.reject(new _Ewa.bX(5,null,null,""))},n:function(n){var t=n.clipboardItems.getItem("text/plain"),i=!isNullOrUndefined(t)&&t.trim()===this.m();return i?Promise.reject(new _Ewa.bX(6,null,null,"")):(isNullOrUndefined(t)||(n.plainTextPayloadSize=t.length),n.isPlainTextPaste=!0,n.pasteResult="SystemClipboardPaste",Diag.a.a(39186568,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request..."),this.c.k(n.commandParameters.originalDestination,t,n.commandParameters.ribbonCommandInfo,[n.commandParameters.stopwatch],n))}};_Ewa.nT=function(n,t,i,r){_Ewa.nT.initializeBase(this,[n]);this.h=t;this.a=i;this.d=r||new _Ewa.nV(this.a);this.e=_Ewa.c.a(n);this.j=this.e.a();this.g=n.a().a(_Ewa.kY,165,!1)};_Ewa.nT.a=function(n,t){var i=n.commandParameters.originalDestination;return(t.a.o()&&t.a.j()===i.j()||t.a.m()&&t.a.i()===i.i())&&(i=n.commandParameters.expandDestination),i};_Ewa.nT.prototype={e:null,j:null,g:null,h:null,d:null,a:null,getSourceItem:function(){return new _Ewa.iH(this.j.a(),this.b.b().j().d(),this.b.b().g(),this.b.f().UserSessionId)},beforeSerialize:function(n){n.isSellectionAllowed=!1;n.isAsyncCopy=!1;n.isFromCache=!1;n.encounteredDeploymentErrors=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.clientSideCopyTime=0;var i=new _Ewa.bz(this.b.e()),t=n.sourceItem;i.d(t.a,this.e)&&(n.isSellectionAllowed=!0,this.c.c(t.a,n.commandParameters.commandType))},o:function(n){var t=this.e.L();return this.e.b().h()&&n.e(n.l(t))},k:function(n,t){var i=t.c(this.b);n.isSameSession=i;n.activeSelectionType=n.isSameSession?"SameSession":"CrossSession"},p:function(n,t,i,r){return n.commandParameters.ribbonCommandInfo.a===1804571062&&this.h.f(n,i.a,i.b,n.commandParameters.expandDestination,this.b.b().j().d(),t.commandParameters.commandType===1),this.s(n,i,_Ewa.k.a(r,this.b),t.commandParameters.commandType)},s:function(n,t,i,r){var u=_Ewa.k.a(t.a,this.b);return u.SheetName=t.b,n.pasteResult="SameSessionPaste",Diag.a.a(37003422,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request..."),this.c.h(n.commandParameters.ribbonCommandInfo,u,i,r,n.commandParameters.commandType,[n.commandParameters.stopwatch],n)}};_Ewa.nU=function(n){_Ewa.nU.initializeBase(this,[n])};_Ewa.nU.a=function(n){_Ewa.U.a(5,new _Ewa.nU(n))};_Ewa.nU.prototype={k:function(){var n=this;_Ewa.f.cw(_Ewa.l.a(_Ewa.dN,this.h.a(),18,this.cT()),function(){n.l([_Ewa.c.a(n.h).cn()],null)},this.h.j(),3)}};_Ewa.jq=function(){};_Ewa.jq.prototype={a:function(){var n=window.clipboardPlatform;return n?n.createClipboardItems():null}};_Ewa.id=function(){};_Ewa.id.a=function(n,t,i,r,u,f,e,o,s){var h=n.a(9,o);return h.sourceRange=t,h.destinationRange=i,h.flags=r,_Ewa.i.a(n,"PasteRange",h,u,f,e,64,s)};_Ewa.id.b=function(n,t,i,r,u,f,e,o){var s=n.a(9,e);return s.destinationRange=t,s.source=i,_Ewa.i.a(n,"PasteString",s,r,u,f,64,o)};_Ewa.id.c=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.sourceRange=t,_Ewa.i.a(n,"GetRangeForClipboard",o,i,r,u,4,e)};_Ewa.ie=function(){};_Ewa.ie.b=function(n){if(!n){Diag.a.a(36701969,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null.");return}n.isAsyncCopy=!1;n.isSellectionAllowed=!1;n.isFromCache=!1;n.plainTextPayloadSize=0;n.shadowWorkbookPayloadSize=0;n.clientSideCopyTime=0;n.encounteredDeploymentErrors=!1};_Ewa.ie.a=function(n,t){if(!n){Diag.a.a(36701970,0,10,"CommonCopyPasteUtils.InitializePasteContext: pasteContext is null.");return}n.commandParameters&&(n.commandParameters.copyPasteTargetType=t);n.isSameSession=!1;n.isShadowWorkbookParsedSuccessfully=!1;n.activeSelectionType="None";n.pasteResult="Undefined";n.encounteredDeploymentErrors=!1};_Ewa.nV=function(n){this.d=n};_Ewa.nV.prototype={c:null,e:null,d:null,b:function(n){return this.c&&this.c.g(n)?this.f(this.e):null},a:function(n,t){this.c=n;this.e=this.f(t)},f:function(n){var t=this.d.a(),u=n.getItem("text/plain"),i,r;return u&&t.setItem("text/plain",u),i=n.getItem("data/shadow-workbook"),i&&t.setItem("data/shadow-workbook",i),r=n.getItem("text/html"),r&&t.setItem("text/html",r),t}};_Ewa.nW=function(n){_Ewa.nW.initializeBase(this);this.h=n;this.k=_Ewa.b.a();this.j()};_Ewa.nW.a=function(n){n.a().b(_Ewa.Lv.$$(_Ewa.cq),251,new _Ewa.nW(n))};_Ewa.nW.prototype={h:null,k:null,b:function(){var i=_Ewa.r.e([45,46],4,!1),t=_Ewa.l.a(_Ewa.dN,this.h.a(),18,this.h.j()),n=this;_Ewa.f.cw(_Ewa.f.ws([t,i],this.cT(),3),function(){var r=new _Ewa.mL,i=null;n.l(r).then(function(u){var f,e;i=u;f=copyPasteInfra.createCopyPasteInfra(i,new _Ewa.vg(n.h),r,n.h);Diag.a.b(24970909,0,!!n.h.f(),"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Diag.a.b(24970910,0,!!n.h.f()&&!!n.h.f().DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");e=i.getMetadataManager();n.i(new _Ewa.cr(n.h,e,t.a(),f,new _Ewa.dD(n.h,_Ewa.c.a(n.h)),new _Ewa.vh,n.h.f().DocumentHostInfo.UserId))},function(n){Diag.a.b(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. error: {0}",n?copyPasteInfra.getStringifiedError(n):"null")})},this.cT(),3)},dispose:function(){_Ewa.cv.prototype.dispose.call(this)},l:function(n){var i=null,r=window.clipboardPlatform,s,h,c,l;if(r&&(i=r.getClipboardPlatformEnvironment()),!i)return Diag.a.b(24970911,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);var t=this.h.f(),u=[t.OfficeOnlineChromeExtensionId,t.ChromeClipboardAccessExtensionId],f=this.k.b(5),o=this.h.E().a(4)&&_Ewa.bA.c(this.h),e=this.m(o,!0);return this.h.isChangeGateEnabled("OfficeVSO:2673557_CCPInfra_add_support_signaturData")?(Diag.a.b(40380624,0,!!t.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null"),s=this,h=this,i.init(this.h,n,u,t.SharedClipboardHostingApp,t.SharedClipboardHostingApps,t.SharedClipboardHostingEnvironments,t.SharedClipboardOverrideOrigin,t.SharedClipboardSchemaVersion,t.SharedClipboardExpirationInMinutes,t.ClipboardPromiseTimeoutInMinutes,f,t.MachineCluster,new _Ewa.kU,e,t.DocumentHostInfo.UserId).then(function(){return i},function(n){return Promise.reject(n)})):(c=this,l=this,i.init(this.h,n,u,t.SharedClipboardHostingApp,t.SharedClipboardHostingApps,t.SharedClipboardHostingEnvironments,t.SharedClipboardOverrideOrigin,t.SharedClipboardSchemaVersion,t.SharedClipboardExpirationInMinutes,t.ClipboardPromiseTimeoutInMinutes,f,t.MachineCluster,new _Ewa.kU,e,"").then(function(){return i},function(n){return Promise.reject(n)}))},m:function(n,t){var i=[];return n&&t&&(this.h.c(461)?Array.add(i,6):Array.add(i,1)),t&&(Array.add(i,7),Array.add(i,0)),n&&Array.add(i,5),Array.add(i,4),Diag.a.a(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",n,t,i?i.join(","):"[]"),i}};_Ewa.cr=function(n,t,i,r,u,f,e){this.y=Function.createDelegate(this,this.ba);this.C=Function.createDelegate(this,this.bi);this.H=Function.createDelegate(this,this.bj);this.B=Function.createDelegate(this,this.bh);this.A=Function.createDelegate(this,this.bd);this.z=Function.createDelegate(this,this.bb);this.G=Function.createDelegate(this,this.be);_Ewa.cr.initializeBase(this,[!1]);this.p=n;this.x=i;this.r=_Ewa.c.a(n);this.s=u;this.E=f;this.q=t;this.u=r;this.bn();this.v=this.p.a().a(_Ewa.oc,81,!1);Diag.a.b(24388233,0,!!this.v,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");e||(Diag.a.a(37033877,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),e="cpiDID");this.w=Common.d.d(e);this.F="CultureTag: "+_Ewa.b.a().d()+" HASH: ";_Ewa.bA.c(this.p)&&this.q.addMetadataChangeListener("EwaJsMetadataChangeListenerId",this.G)};_Ewa.cr.g=function(n){var t=n.innerError;return t&&t.pasteErrorName?n.innerError:null};_Ewa.cr.f=function(n){var t=n.innerError;return t&&t.copyErrorName?n.innerError:null};_Ewa.cr.a=function(n){var t="",i,r;return n?(i=n,!i.errorName||(t=i.errorName,i.innerError&&(t+="_"+_Ewa.cr.a(i.innerError))),t||(r=n,t=r&&!!r.name?r.name:"UnknownError"),t):"UnknownError"};_Ewa.cr.prototype={p:null,r:null,q:null,x:null,v:null,u:null,s:null,E:null,w:0,F:null,g:function(n){this.cV("cpiOSC",n)},o:function(n){this.cW("cpiOSC",n)},i:function(n){var i,u,r,t;return n.stopwatch=this.p.o().a("UserAction",_Ewa.y.a().c(n.ribbonCommandInfo.a)+"ClientSide"),i=!!_Ewa.cl.a(this.q),u=this,this.c("Copy/before/"+Common.j.b.toString(n.ribbonCommandInfo.b),!1,!1,!0,n.copyPasteTargetType).catch(function(){}),n.userHash=this.w,n.id=Common.O.a().a,r=this,t=this,this.u.onCopy(n).then(function(t){return t.isAsyncCopy||n.stopwatch.a(),Diag.a.a(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",_Ewa.hl.a(n)),r.V(t,i),Promise.resolve(!0)},function(i){var r=i,f=!1,s="none",o="Unknown",e=!0,h=-1,c="CopyError_",l=!1,u;return r&&(h=r.reason,t.t()&&(c+=_Ewa.cr.a(r),!r.message||(o=r.message)),u=_Ewa.cr.f(r),u&&(u.copyErrorName===3?(f=!0,o=s="Async Copy canceled by the user.",e=!1):_Ewa.h.d(u.ewaErrors)&&(t.t()&&(o=t.D(u.ewaErrors)),_Ewa.h.g(u.ewaErrors)?(f=!0,s=_Ewa.h.a(u.ewaErrors,",")):_Ewa.h.c(u.ewaErrors,_Ewa.cr.b)?(f=!0,l=!0):_Ewa.h.c(u.ewaErrors,_Ewa.cr.d)&&(f=!0))),r.reason===13?(f=!0,e=!1):r.reason===11&&(e=!1)),f?Diag.a.a(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",e,s,r?copyPasteInfra.getStringifiedError(r):"null",_Ewa.hl.a(n)):Diag.a.a(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",e,r?copyPasteInfra.getStringifiedError(r):"null",_Ewa.hl.a(n)),e&&t.c("Copy/fail/"+Common.j.b.toString(n.ribbonCommandInfo.b),!0,!1,!1,n.copyPasteTargetType).catch(function(){}),t.U(n,f,o,c,h,l),Promise.reject(i)})},n:function(n){if(n.stopwatch=this.p.o().a("UserAction",_Ewa.y.a().c(n.ribbonCommandInfo.a)+"ClientSide"),n.originalDestination=this.r.a().a(),n.expandDestination=this.I(n.originalDestination,n.commandType),this.h(n.commandType,n.expandDestination)||this.Q()){n.userHash=this.w;n.id=Common.O.a().a;var t=this,i=this;return this.u.onPaste(n).then(function(i){return t.bg(i,n)},function(t){return i.bf(n,t)})}return Diag.a.a(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestination: {0}, CommandType: {1}, copyPasteTargetType="{2}"',n.expandDestination,n.commandType,n.copyPasteTargetType),Promise.resolve(!0)},Q:function(){var n=_Ewa.cl.a(this.q);return!n||!n.sourceItem||Object.getType(n.sourceItem)!==_Ewa.fV?!1:!!_Ewa.c.a(this.p).a().o()&&this.p.P(null,214)},a:function(){var n=_Ewa.cl.a(this.q);return!n||!n.commandParameters?0:n.commandParameters.copyPasteTargetType},l:function(){return!!_Ewa.cl.a(this.q)&&_Ewa.jF.a(_Ewa.cl.a(this.q),this.p)},c:function(n,t,i,r,u){var e,o,f,s,c,h;try{return(e=u,o=this.T(),!r&&o===2)?(Diag.a.a(36304158,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),Promise.reject(null)):(e||(e=o),f=this.p.o().a("UserAction","ClearCopyState"),s=f.c(),Diag.a.a(24150914,0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",t,i,r,u,o),this.s.b(),this.bm(),c=this,h=this,this.u.onCancelCopy(t).then(function(){return f.a(),c.O(n,s,!0,i,t,"","",f.b(),e),Promise.resolve(!0)},function(r){var o,c,u;return Diag.a.a(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",r?copyPasteInfra.getStringifiedError(r):"null"),f.a(),o="CancelError_",c="Unknown",h.t()&&(u=r,u&&(o+=_Ewa.cr.a(u),!u.message||(c=u.message))),h.O(n,s,!1,i,t,c,o,f.b(),e),Promise.reject(r)}))}catch(l){return Promise.reject(null)}},T:function(){var n=_Ewa.cl.a(this.q);return!n||!n.sourceItem?0:Object.getType(n.sourceItem)===_Ewa.fV?2:1},j:function(n,t,i,r){var s,e,u,f,o;return n.stopwatch=this.p.o().a("UserAction","DragDropClientSide"),s=this,this.c("DragDrop/before/"+Common.j.b.toString(n.ribbonCommandInfo.b),!1,!1,!1,n.copyPasteTargetType).catch(function(){}),e=r?256:128,u={},u.encounteredDeploymentErrors=!1,n.userHash=this.w,n.id=Common.O.a().a,f=this,o=this,this.s.h(n.ribbonCommandInfo,_Ewa.k.a(t,this.p),_Ewa.k.a(i,this.p),1,e,[n.stopwatch],u).then(function(){return Diag.a.a(36975680,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',n.copyPasteTargetType),f.r.a().t(-1),f.X(n,t,i,u),Promise.resolve(!0)},function(r){return Diag.a.a(36975681,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',r?copyPasteInfra.getStringifiedError(r):"null",n.copyPasteTargetType),o.bc(r,n,t,i,u)})},k:function(n,t){var r=_Ewa.cl.a(this.q),i,e,c,l,o;if(!r)return Diag.a.a(25518403,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!_Ewa.hF.a(r.sourceItem))return Diag.a.a(36824457,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),$$sc.a.a(Boolean,!1);if(i=r.sourceItem,!i)return Diag.a.b(25518404,0,!!i,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),$$sc.a.a(Boolean,!1);if(!i.c(this.p))return Diag.a.a(34981187,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),$$sc.a.a(Boolean,!1);var u=i.a,a=this.r.a().a(),f=this.I(a,n),s=this.m(),v=i.b,y=this.p.b().j().d(),h=_Ewa.k.a(u,this.p);return h.SheetName=v,e=_Ewa.k.a(f,this.p),e.SheetName=y,c=f.o()||u.o()?$$sc.a.a(_Ewa.kD,0):f.m()||u.m()?$$sc.a.a(_Ewa.kD,1):this.E.a(this.p,_Ewa.c.a(this.p).d()),l=this,o=this,c.CWR($$sc.a,function(n){return l.R(h,e,s,n.a(),t)}).CW(function(){s?o.s.b():o.c("InsertCopiedCutCells/success/"+Common.j.b.toString(t.b),!0,!1,!1,0)})},b:function(){var n=_Ewa.cl.a(this.q);return!!n&&_Ewa.hF.a(n.sourceItem)},m:function(){return this.N(-911352779)},e:function(){return this.N(-1985798686)},h:function(n,t){var i=new _Ewa.bz(this.p.e()),r=n===36,u=i.a(4),f=this.a()===2&&i.a(1),e=r&&u;return e||f||this.p.P(t,1)},d:function(n,t){return this.s.f(n,t)},dispose:function(){_Ewa.cv.prototype.dispose.call(this);this.bq();_Ewa.bA.c(this.p)&&this.q.removeMetadataChangeListener("EwaJsMetadataChangeListenerId")},f:function(n,t,i,r,u,f){var s,h,c,e,o,l;if(n.commandParameters.commandType!==516){if(i===u&&(s=t.l(this.r.n()),h=r.l(this.r.n()),s&&h)){c=_Ewa.k.a(s,this.p);c.SheetName=i;e=!0;o=!1;switch(n.commandParameters.ribbonCommandInfo.a){case 1804571062:e=!0;o=!1;break;case 237279923:case 808159687:e=!0;o=!0;break;case 1766348718:case-185374993:e=!1;o=!0}l=this.x.c(this.r,c,_Ewa.k.a(h,this.p),n.commandParameters.stopwatch,e,o);f&&this.x.f(s,!1);l&&(this.P(n.commandParameters.expandDestination),this.J("DoPasteClientEstimation/"+Common.j.b.toString(n.commandParameters.ribbonCommandInfo.b),n))}}else Diag.a.a(24417763,0,50,"RangeCopyPasteHandler.DoPasteClientEstimation: client estimation support only paste formatting.")},N:function(n){var t=_Ewa.cl.a(this.q),i;return t?(i=t.sourceItem,i&&!i.c(this.p))?(Diag.a.a(34981188,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):t.commandParameters.ribbonCommandInfo.a===n:!1},R:function(n,t,i,r,u){var f={};f.InsertDirection=r;f.SourceRange=n;f.DestRange=t;f.CopyCutOperation=i?0:1;var e=this.p.d().a(),s=this,o=function(n,t){return _Ewa.zr.a(e,f,n,t,null,null)},h=this;return _Ewa.T.a(this.p.g(),o,function(n){return new _Ewa.J(104,0,n,0)},u)},be:function(n){this.bp(n)&&(this.s.b(),Diag.a.a(38922268,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))},bp:function(n){var t=!n||!n.lastCopy;return t?!0:_Ewa.jF.a(n.lastCopy,this.p)},L:function(n,t,i,r){var u={};return u.a=this.p.f().UserSessionId,u.e=n.stopwatch.c(),u.c=_Ewa.y.a().c(n.ribbonCommandInfo.a),u.b=Common.j.b.toString(n.ribbonCommandInfo.b),u.d=n.id,u.f=t.toString(),u.g=i.toString(),u.l=n.stopwatch.b(),u.n=!1,u.o=n.copyPasteTargetType.toString(),u.p=r.encounteredDeploymentErrors,u},X:function(n,t,i,r){var u=this.L(n,t,i,r);u.h=!0;_Ewa.y.a().a(47,u,!0)},W:function(n,t,i,r,u,f,e,o){var s=this.L(n,t,i,o);s.h=!1;s.i=r;s.k=u;s.m=f;s.n=e;_Ewa.y.a().a(47,s,!0)},O:function(n,t,i,r,u,f,e,o,s){var h={};h.a=this.p.f().UserSessionId;h.b=t;h.c=n;h.f=i;h.e=r;h.d=u;h.g=f;h.h=e;h.i=o;h.j=s.toString();_Ewa.y.a().a(48,h,!0)},V:function(n,t){var i=this.K(n.commandParameters);i.g=n.isAsyncCopy;i.h=n.isFromCache;i.j=n.isSellectionAllowed;i.k=!0;i.i=t;i.d=n.sourceItem.toString();i.q=n.plainTextPayloadSize;i.s=n.shadowWorkbookPayloadSize;i.o=n.clientSideCopyTime;i.w=n.encounteredDeploymentErrors;_Ewa.y.a().a(45,i,!0)},U:function(n,t,i,r,u,f){var e=this.K(n);e.k=!1;e.l=t;e.n=i;e.u=r;e.t=u;e.v=f;_Ewa.y.a().a(45,e,!0)},K:function(n){var t={};return t.a=this.p.f().UserSessionId,t.e=n.stopwatch.c(),t.f=n.id,t.c=_Ewa.y.a().c(n.ribbonCommandInfo.a),t.b=Common.j.b.toString(n.ribbonCommandInfo.b),t.p=n.stopwatch.b(),t.r=n.copyPasteTargetType.toString(),t.v=!1,t},P:function(n){var t=this.r.a().a().bp(n)?this.r.a().b():n.g();this.r.a().e(n,t,0,!0)},M:function(n,t){var i={};return i.a=this.p.f().UserSessionId,i.g=n.stopwatch.c(),i.o=n.stopwatch.b(),i.r=n.copyPasteTargetType.toString(),i.i=n.expandDestination.toString(),i.h=n.originalDestination.toString(),i.e=n.id,i.d=n.commandType,i.c=_Ewa.y.a().c(n.ribbonCommandInfo.a),i.b=Common.j.b.toString(n.ribbonCommandInfo.b),i.z=!1,i.ba=!1,t&&(i.f=t.commandParameters.id,i.j=t.sourceItem.toString(),i.ba=t.commandParameters.commandType===1),i},Y:function(n,t,i,r,u,f,e,o){var s=this.M(n,o);s.k=!1;s.l=t;s.n=i;s.w=r;s.y=u;s.x=f;s.z=e;_Ewa.y.a().a(46,s,!0)},Z:function(n,t){var i=this.M(n.commandParameters,t);i.s=n.isExternalPaste;i.k=!0;i.p=n.plainTextPayloadSize;i.q=n.shadowWorkbookPayloadSize;i.t=n.isClipboardDataContainShadowWorkbook;i.u=n.isShadowWorkbookParsedSuccessfully;i.v=n.activeSelectionType;i.w=n.pasteResult;i.bb=n.encounteredDeploymentErrors;_Ewa.y.a().a(46,i,!0)},bn:function(){this.p.e().b(this.z);this.p.e().x(this.A);this.p.g().c(this.B);this.p.z(this.H);_Ewa.c.a(this.p).f().d(this.C)},bq:function(){this.p&&this.p.e()&&(this.p.e().d(this.z),this.p.e().A(this.A));this.p&&this.p.g()&&this.p.g().e(this.B);this.r&&this.r.f()&&this.r.f().c(this.C)},bf:function(n,t){var i=null,o=t,f=!1,r=null,e="UnknownFailure",h=-1,u="Unknown",c="PasteError_",l=!1,a=_Ewa.cl.a(this.q),v,s,y;return(n.clearStateOnFinish||n.clearSystemClipboard)&&(v=this,this.c("Paste/fail/"+Common.j.b.toString(n.ribbonCommandInfo.b),!0,!1,!1,n.copyPasteTargetType).catch(function(){})),o&&(h=o.reason,this.t()&&(c+=_Ewa.cr.a(o),!o.message||(u=o.message)),i=_Ewa.cr.g(o),i&&(i.pasteErrorName===1?(f=!0,e="CopyPasteLengthTooLongPopup",u=r="The pasted content is too long. Popup a dialog to the user.",Diag.a.a(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',r,n.copyPasteTargetType),alert(_Ewa.b.a().b(6))):i.pasteErrorName===6?(f=!0,_Ewa.bA.c(this.p)?(e="No-Op",u=r="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Diag.a.a(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',r,n.copyPasteTargetType)):(e="AsyncCopyFailurePopup",u=r="An async copy was unable to populate the clipboard. Popup a dialog to the user.",Diag.a.a(25216993,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',r,n.copyPasteTargetType),this.bk())):i.pasteErrorName===7?(f=!0,e="UseShortcutsPopup",u=r="Unable to paste content from the system clipboard. Popup dialog to the user.",Diag.a.a(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',r,n.copyPasteTargetType),this.bl()):i.pasteErrorName===5?(f=!0,e="No-Op",u=r="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",Diag.a.a(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',r,n.copyPasteTargetType)):this.p.c(352)&&i.pasteErrorName===14?(f=!0,e="No-Op",u=r="Unable to paste content from local storage. Failed to read the local storage property from window",Diag.a.a(38933722,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',r,n.copyPasteTargetType),s=_Ewa.l.b(_Ewa.cj,this.p.a(),4,3),y=this,_Ewa.f.cw(s,function(){s.a().a(34,null)},this.cT(),3)):i.pasteErrorName===16?(f=!0,e="No-Op",u=r="Paste has failed because the previous copy has failed",Diag.a.a(40147082,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',r,n.copyPasteTargetType,copyPasteInfra.getStringifiedError(i))):_Ewa.h.d(i.ewaErrors)&&(_Ewa.h.g(i.ewaErrors)||_Ewa.h.c(i.ewaErrors,_Ewa.h.m())?(f=!0,e="CommunicationError",r=_Ewa.h.a(i.ewaErrors,","),Diag.a.a(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):_Ewa.h.c(i.ewaErrors,_Ewa.cr.e)?(f=!0,e="SavingWorkbookError",r=_Ewa.h.a(i.ewaErrors,","),Diag.a.a(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)):_Ewa.h.c(i.ewaErrors,_Ewa.cr.b)&&(f=!0,l=!0,e="OperationSucceededWithAlert",r=_Ewa.h.a(i.ewaErrors,","),Diag.a.a(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',u,n.copyPasteTargetType)),this.t()&&(u=this.D(i.ewaErrors))))),f||Diag.a.a(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',o?copyPasteInfra.getStringifiedError(o):"null",n.copyPasteTargetType),this.Y(n,f,u,e,c,h,l,a),Promise.reject(t)},bg:function(n,t){Diag.a.a(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',t.copyPasteTargetType);t.copyPasteTargetType===1&&this.bo(n.isExternalPaste,t.originalDestination,t.expandDestination);var i=_Ewa.cl.a(this.q);return this.J("Paste/success/"+Common.j.b.toString(t.ribbonCommandInfo.b),n),this.Z(n,i),Promise.resolve(!0)},J:function(n,t){var i,r,u,f;(u=this.S(t,r={val:i}),i=r.val,u)&&(f=this,this.c(n,i,!1,!1,t.commandParameters.copyPasteTargetType).catch(function(){}))},ba:function(n,t){Diag.a.a(37364764,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",n,t);this.r.o()},bk:function(){var n=this.v.a();n.a(!1,!1,!1,this.y)},bl:function(){var n=this.v.a();n.a(!0,!1,!1,this.y)},bc:function(n,t,i,r,u){Diag.a.a(24150918,0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",n?copyPasteInfra.getStringifiedError(n):"null");var o=!1,f=!1,e="Unknown",s="DragAndDropError_";return n&&(this.t()?(s+=_Ewa.cr.a(n),_Ewa.h.d(n.ewaErrors)?(e=this.D(n.ewaErrors),_Ewa.h.c(n.ewaErrors,_Ewa.cr.b)&&(o=!0),_Ewa.h.c(n.ewaErrors,_Ewa.cr.c)&&(f=!0)):n.message&&(e=n.message)):_Ewa.h.d(n.ewaErrors)&&(_Ewa.h.c(n.ewaErrors,_Ewa.cr.b)&&(o=!0),_Ewa.h.c(n.ewaErrors,_Ewa.cr.c)&&(f=!0,e=_Ewa.h.a(n.ewaErrors,",")))),f?this.r.a().t(-1):this.s.d(r),this.W(t,i,r,f,e,s,o,u),Promise.reject(n)},I:function(n,t){var r=n,i=_Ewa.cl.a(this.q),u;return i&&_Ewa.hF.a(i.sourceItem)&&(u=i.sourceItem,r=this.s.e(t,u.a,n)),r},bm:function(){this.cS("cpiOSC",null,null)},bo:function(n,t,i){if(!n){var r=this.r.a().a()===t;r?(this.P(i),Diag.a.a(24150919,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",i)):Diag.a.a(24150920,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestination: {0}",t)}},S:function(n,t){var i,r;if(t.val=!0,n.isPlainTextPaste)return t.val=!1,!0;if(_Ewa.cl.c(n)||(i=n.copyContextSnapshot,n.commandParameters.clearStateOnFinish))return!0;if(i&&_Ewa.hF.a(i.sourceItem)){if(r=i.sourceItem,!r.c(this.p))return!1;var u=i.commandParameters.ribbonCommandInfo.a===-1985798686,f=r.a,e=n.commandParameters.expandDestination,o=this.p.b().j().d(),s=r.b,h=s===o&&!!e.l(f);return u||h}return!1},bj:function(n,t){if(!t.b&&!t.c){var i=this;this.c("OnWorkbookOpened",!1,!1,!1,0).catch(function(){})}},bb:function(n,t){var r=_Ewa.cl.a(this.q),i=this.s.a(r);i&&(t.a&&t.a.d()===i.b&&i.c(this.p)?this.s.c(i.a,r.commandParameters.commandType):this.s.b())},bd:function(n,t){var r=_Ewa.cl.a(this.q),i=this.s.a(r),u;i&&t.a&&t.a.d()===i.b&&i.c(this.p)&&(u=this,this.c("OnItemDeleting",!1,!1,!1,0).catch(function(){}))},bi:function(n,t){var r=_Ewa.cl.a(this.q),i=this.s.a(r),u;i&&i.c(this.p)&&t.a.a().h(i.a)&&!this.r.m().n()&&(u=this,this.c("OnStartEdit",!0,!1,!1,0).catch(function(){}))},bh:function(n,t){if(t.a===1&&t.b.a.b()&2){var i=this;this.c("OnQueueItemChanged/ItemRemoved",!1,!1,!1,0).catch(function(){})}},D:function(n){var t=_Ewa.h.N(n,"_");return this.F+Common.d.d(t).toString()},t:function(){return this.p.isChangeGateEnabled("OfficeVSO:2416599_CCPFullErrorName")}};_Ewa.dD=function(n,t){this.l=n;this.m=t};_Ewa.dD.d=function(n,t,i,r,u,f,e,o,s){var h=n.d().a().b(),c=function(t,c){return n.H(),_Ewa.id.a(n.d().a(),i,r,u,_Ewa.n.a(t,e),_Ewa.n.b(c,o),f,h,s)},l=new _Ewa.bj(506,0,c,1);n.g().a(l,t)};_Ewa.dD.b=function(n,t,i,r,u){_Ewa.h.b(n.Errors)?_Ewa.h.i(n.Errors)?(t&&(t.encounteredDeploymentErrors=!0),Diag.a.a(36538329,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",_Ewa.h.a(n.Errors,","))):r(new _Ewa.bX(4,n.Errors,null,"")):i(u?u:!0)};_Ewa.dD.e=function(n,t,i,r,u,f,e,o,s){var h=n.d().a().b(),c=function(t,c){n.H();var l=_Ewa.dD.c(i,r,s);return _Ewa.ij.b(n.d().a(),l,_Ewa.n.a(t,f),_Ewa.n.b(c,e),u,h,o)},l=new _Ewa.bj(503,0,c,1);n.g().a(l,t)};_Ewa.dD.c=function(n,t,i){var r={};return r.ShadowWorkbookBase64=n.shadowWorkbookBase64,r.SourceRange={},r.SourceRange.FirstRow=n.rangeRowStart,r.SourceRange.LastRow=n.rangeRowEnd,r.SourceRange.FirstColumn=n.rangeColumnStart,r.SourceRange.LastColumn=n.rangeColumnEnd,r.DestinationRange=t,r.CopyPasteTargetType=1,r.PasteType=i,r};_Ewa.dD.a=function(n,t,i){var r=i.f();return r.i()<t&&(r.d=Math.min(1048576,r.a+t-1)),r.j()<n&&(r.c=Math.min(16384,r.b+n-1)),r};_Ewa.dD.prototype={l:null,m:null,g:function(n,t,i,r,u){var f=_Ewa.k.a(n,this.l),e=this.l.d().a().b(),o=this,s=function(n,s){return _Ewa.id.c(o.l.d().a(),f,_Ewa.n.a(n,i),r?_Ewa.n.b(s,r):s,t,e,u)};this.l.g().a(new _Ewa.bj(504,0,s,16),t)},i:function(n,t,i,r,u){var f=_Ewa.k.a(n,this.l),e=this.l.d().a().b(),o=this,s=function(n,s){var h={};return h.CopyPasteTargetType=1,h.SourceRange=f,_Ewa.ij.a(o.l.d().a(),h,_Ewa.n.a(n,i),r?_Ewa.n.b(s,r):s,t,e,u)};this.l.g().a(new _Ewa.bj(505,0,s,16),t)},j:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var h=function(n){_Ewa.dD.b(n,u,e,o,null)},c=function(n){var t=_Ewa.X.a(n.b);o(new _Ewa.bX(4,t,null,""))},s=2;f.l.isChangeGateEnabled("OfficeVSO:2636843_PasteValuesOrFormattingCrossSession")&&(u.commandParameters.commandType===20&&(s=16),u.commandParameters.commandType===36&&(s=32));f.l.c(234)&&u.commandParameters.commandType===68&&(s=64);_Ewa.dD.e(f.l,n,i,t,null,h,c,r,s)})},h:function(n,t,i,r,u,f,e){var o=this;return new Promise(function(s,h){var c=function(n){_Ewa.dD.b(n,e,s,h,null)},l=function(n){var t=_Ewa.X.a(n.b);h(new _Ewa.bX(4,t,null,""))},a=r,v=-5&u,y=a|v;_Ewa.dD.d(o.l,n,t,i,y,null,c,l,f)})},k:function(n,t,i,r,u){var f=this;return new Promise(function(e,o){var a;if(!t||(t=_Ewa.j.h(t,"\n","\r")),!t)e("");else if(t.length>102400)Diag.a.a(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",t.length,102400),o(new _Ewa.bX(1,null,null,""));else{var s,h,c=_Ewa.k.a(n,f.l),v=!f.l.b().a()&&t.indexOf("\n")===-1&&t.indexOf("\t")===-1&&_Ewa.j.j(t),l=f.l.d().a().b();v?(h=526,s=function(i,u){var s=_Ewa.n.a(i,function(n){n.Errors&&n.Errors.length>0?o(new _Ewa.bX(2,n.Errors,null,"")):e(t)}),h=_Ewa.n.b(u,function(n){var t=_Ewa.X.a(n.b);o(new _Ewa.bX(2,t,null,""))});return f.l.H(),_Ewa.i.c(f.l.d().a(),c,t,_Ewa.bb.b(t,!0),!1,!1,63,s,h,n,l,r)}):(h=180,s=function(n,i){f.l.H();var s=_Ewa.n.a(n,function(n){_Ewa.dD.b(n,u,e,o,t)}),h=_Ewa.n.b(i,function(n){var t=_Ewa.X.a(n.b);o(new _Ewa.bX(3,t,null,""))});return _Ewa.id.b(f.l.d().a(),c,t,s,h,null,l,r)});a=new _Ewa.bj(h,0,s,1);f.l.g().a(a,i)}})},c:function(n,t){if(this.m.c().s()&16){var i=[t===1?5:6];this.m.e().b(i,null,null);this.m.e().c(n,i);this.m.e().h(!0,!0)}},b:function(){var n=[5,6];this.m.e().a(n);this.m.e().c(null,n);this.m.a().d()===1&&this.m.cH(!1)},e:function(n,t,i){var r;if(this.l.c(63)){if(36===n)return i.k()?_Ewa.dD.a(t.j(),t.i(),i):i.f();if(n===516){t=t.f();var u=t.i(),f=t.j(),e=t.a,o=t.b;t.d=Math.min(1048576,e+f-1);t.c=Math.min(16384,o+u-1)}var s=!(i.j()%t.j())&&!(i.i()%t.i()),h=i.G()&&!(i.j()%t.j()),c=i.D()&&!(i.i()%t.i());return h||c?r=_Ewa.dD.a(t.j(),t.i(),i):s?r=i.f():(r=i.f(),r.d=Math.min(1048576,r.a+t.i()-1),r.c=Math.min(16384,r.b+t.j()-1)),r}return 516===n?_Ewa.dD.a(t.i(),t.j(),i):36!==n||i.k()?_Ewa.dD.a(t.j(),t.i(),i):i.f()},d:function(n){var t=this.m.a();this.m.e().d();t.e(n,n.g(),0,!0);t.t(-1)},a:function(n){if(n&&n.sourceItem){if(!_Ewa.hF.a(n.sourceItem))return null;var t=n.sourceItem;if(t&&t.a)return t}return null},f:function(n,t){return(Diag.a.b(33863620,0,!!n,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null"),t&&"SourceControlId"in t)?!1:n.d?!1:n.b===1}};_Ewa.nX=function(n){this.a=new _Ewa.t(!0);this.b=n};_Ewa.nX.prototype={b:null,d:function(n){if(this.a.d(n.id)||this.a.c(n.id,!0),this.a.a.length>0){var t=_Ewa.l.b(_Ewa.cj,this.b.a(),4,3),i=this;_Ewa.f.cw(t,function(){t.a().a(29,null)},this.b.j(),3)}},c:function(n){var i=this.a.a.length>0,t,r;this.a.d(n.id)&&this.a.e(n.id);i&&!this.a.a.length&&(t=_Ewa.l.b(_Ewa.cj,this.b.a(),4,3),r=this,_Ewa.f.cw(t,function(){t.a().d(29)},this.b.j(),3))}};_Ewa.kU=function(){this.k={"SourceItemType.Range":0,"SourceItemType.Art":1};this.d={};this.h={"FloatingObjectType.Unknown":99,"FloatingObjectType.CardView":6,"FloatingObjectType.Chart":0,"FloatingObjectType.Group":7,"FloatingObjectType.Image":1,"FloatingObjectType.InteractiveReport":4,"FloatingObjectType.ModernOfficeExtension":3,"FloatingObjectType.Shape":5,"FloatingObjectType.Slicer":2,"FloatingObjectType.Unsupported":100};this.e={"99":"FloatingObjectType.Unknown","6":"FloatingObjectType.CardView","0":"FloatingObjectType.Chart","7":"FloatingObjectType.Group","1":"FloatingObjectType.Image","4":"FloatingObjectType.InteractiveReport","3":"FloatingObjectType.ModernOfficeExtension","5":"FloatingObjectType.Shape","2":"FloatingObjectType.Slicer","100":"FloatingObjectType.Unsupported"};this.j={"RibbonCommand.Copy":-911352779,"RibbonCommand.Cut":-1985798686};this.f={"-911352779":"RibbonCommand.Copy","-1985798686":"RibbonCommand.Cut"};this.i={"InputManager.InputMethod.NotDefined":-1,"InputManager.InputMethod.Unknown":0,"InputManager.InputMethod.Keyboard":1,"InputManager.InputMethod.Mouse":2,"InputManager.InputMethod.Touch":3,"InputManager.InputMethod.CrossSlide":9};this.b={};this.g={"FrameMode.None":0,"FrameMode.Reading":1,"FrameMode.Edit":2};this.c={};this.m={"UILocation.Unknown":0,"UILocation.UpperRibbon":1,"UILocation.Ribbon":2,"UILocation.QAT":3,"UILocation.Jewel":4,"UILocation.NavigationPane":5,"UILocation.KeyboardShortcut":6,"UILocation.StatusBar":7,"UILocation.Dialog":8,"UILocation.Floatie":9,"UILocation.NotificationBar":10,"UILocation.StandaloneCuiRoot":11,"UILocation.TaskPane":12,"UILocation.HeroDock":13,"UILocation.ContextMenu":19,"UILocation.DialogMenu":20,"UILocation.Toolbar":26,"UILocation.Canvas":30};this.a={};this.b[Common.j.b.toString(-1)]="InputManager.InputMethod.NotDefined";this.b[Common.j.b.toString(0)]="InputManager.InputMethod.Unknown";this.b[Common.j.b.toString(1)]="InputManager.InputMethod.Keyboard";this.b[Common.j.b.toString(2)]="InputManager.InputMethod.Mouse";this.b[Common.j.b.toString(3)]="InputManager.InputMethod.Touch";this.b[Common.j.b.toString(9)]="InputManager.InputMethod.CrossSlide";this.c[Common.bk.toString(0)]="FrameMode.None";this.c[Common.bk.toString(1)]="FrameMode.Reading";this.c[Common.bk.toString(2)]="FrameMode.Edit";this.a[Common.G.toString(0)]="UILocation.Unknown";this.a[Common.G.toString(1)]="UILocation.UpperRibbon";this.a[Common.G.toString(2)]="UILocation.Ribbon";this.a[Common.G.toString(3)]="UILocation.QAT";this.a[Common.G.toString(4)]="UILocation.Jewel";this.a[Common.G.toString(5)]="UILocation.NavigationPane";this.a[Common.G.toString(6)]="UILocation.KeyboardShortcut";this.a[Common.G.toString(7)]="UILocation.StatusBar";this.a[Common.G.toString(8)]="UILocation.Dialog";this.a[Common.G.toString(9)]="UILocation.Floatie";this.a[Common.G.toString(10)]="UILocation.NotificationBar";this.a[Common.G.toString(11)]="UILocation.StandaloneCuiRoot";this.a[Common.G.toString(12)]="UILocation.TaskPane";this.a[Common.G.toString(13)]="UILocation.HeroDock";this.a[Common.G.toString(19)]="UILocation.ContextMenu";this.a[Common.G.toString(20)]="UILocation.DialogMenu";this.a[Common.G.toString(26)]="UILocation.Toolbar";this.a[Common.G.toString(30)]="UILocation.Canvas";this.d[_Ewa.ev.toString(0)]="SourceItemType.Range";this.d[_Ewa.ev.toString(1)]="SourceItemType.Art"};_Ewa.kU.a=function(n){return new _Ewa.p(n.top,n.left,n.bottom,n.right,!1,!1)};_Ewa.kU.prototype={serializeSourceItem:function(n){var t={},i,r;if(n&&Object.getType(n)===_Ewa.iH)i=n,t.sheetName=i.b,t.top=i.a.a,t.left=i.a.b,t.bottom=i.a.d,t.right=i.a.c,t.sessionStateId=i.e,t.sessionId=i.d,t.sourceItemType=this.l(0);else if(n&&Object.getType(n)===_Ewa.fV)r=n,t.activeFloatingObjectControlId=r.a,t.sheetName=r.f,t.sessionStateId=r.e,t.sessionId=r.d,t.floatingObjectType=this.u(r.b),t.sourceItemType=this.l(1);else return Diag.a.b(25217025,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(t)},serializeCommandParameters:function(n){if(!n)return Diag.a.b(25217024,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var t={};return t.id=n.id,t.commandType=n.commandType,t.copyPasteTargetType=n.copyPasteTargetType,n.ribbonCommandInfo&&(t.ribbonCommandName=this.x(n.ribbonCommandInfo.a),t.inputMethodName=this.w(n.ribbonCommandInfo.b),t.frameModeName=this.v(n.ribbonCommandInfo.e),t.uiLocationName=this.y(n.ribbonCommandInfo.c),t.tabName=n.ribbonCommandInfo.d),JSON.stringify(t)},deserializeSourceItem:function(n){var t,i;if(!n)return null;try{if(t=JSON.parse(n),!t)return Diag.a.b(38847437,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;i=null;switch(this.s(t.sourceItemType)){case 0:i=new _Ewa.iH(_Ewa.kU.a(t),t.sheetName,t.sessionStateId,t.sessionId);break;case 1:i=new _Ewa.fV(t.activeFloatingObjectControlId,t.sheetName,t.sessionStateId,t.sessionId,this.n(t.floatingObjectType))}return i}catch(r){return Diag.a.a(38847438,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},deserializeCommandParameters:function(n){var t,i;if(!n)return null;try{return(t=JSON.parse(n),!t)?(Diag.a.b(38847439,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null):(i={},i.id=t.id,i.ribbonCommandInfo=this.r(t),i.commandType=t.commandType,i.copyPasteTargetType=t.copyPasteTargetType,i)}catch(r){return Diag.a.a(38847440,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",n?n.length:0,r),null}},r:function(n){return new _Ewa.bd(this.q(n.ribbonCommandName),this.p(n.inputMethodName),this.o(n.frameModeName),this.t(n.uiLocationName),n.tabName)},x:function(n){return isNullOrUndefined(n)||!(n.toString()in this.f)?(Diag.a.b(25217028,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),this.f["-911352779"]):this.f[n.toString()]},q:function(n){return!n||!(n in this.j)?(Diag.a.b(25217029,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,n),-911352779):this.j[n]},w:function(n){return isNullOrUndefined(n)||!(Common.j.b.toString(n)in this.b)?(Diag.a.b(25217030,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",n),this.b[Common.j.b.toString(0)]):this.b[Common.j.b.toString(n)]},p:function(n){return!n||!(n in this.i)?(Diag.a.b(25217031,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",n),0):this.i[n]},v:function(n){return isNullOrUndefined(n)||!(Common.bk.toString(n)in this.c)?(Diag.a.b(25217032,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",n),this.c[Common.bk.toString(2)]):this.c[Common.bk.toString(n)]},o:function(n){return!n||!(n in this.g)?(Diag.a.b(25217033,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",n),2):this.g[n]},l:function(n){return isNullOrUndefined(n)||!(_Ewa.ev.toString(n)in this.d)?(Diag.a.b(25217034,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",n),this.d[_Ewa.ev.toString(0)]):this.d[_Ewa.ev.toString(n)]},s:function(n){return!n||!(n in this.k)?(Diag.a.b(25217035,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",n),0):this.k[n]},u:function(n){return isNullOrUndefined(n)||!(n.toString()in this.e)?(Diag.a.b(36229127,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",n),this.e["99"]):this.e[n.toString()]},n:function(n){return!n||!(n in this.h)?(Diag.a.b(36229128,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",n),99):this.h[n]},y:function(n){return isNullOrUndefined(n)||!(Common.G.toString(n)in this.a)?(Diag.a.b(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",n),this.a[Common.G.toString(2)]):this.a[Common.G.toString(n)]},t:function(n){return!n||!(n in this.m)?(Diag.a.b(36229130,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",n),2):this.g[n]}};_Ewa.vg=function(n){this.a=n};_Ewa.vg.prototype={a:null,b:null,c:null,e:function(){var t,n;return this.b||(t=this.a.a().a(_Ewa.cq,250,!0),t&&(n=t,this.b=_Ewa.bA.c(this.a)?new _Ewa.jo(this.a,n,new _Ewa.jq,null):_Ewa.bA.e(this.a)?new _Ewa.vj(this.a,n,new _Ewa.jq,null):new _Ewa.vi(this.a,n,new _Ewa.jq,null))),this.b},d:function(){var t,n;return this.c||(t=this.a.a().a(_Ewa.cq,250,!0),t&&(n=new _Ewa.vf(this.a),this.c=new _Ewa.nS(this.a,new _Ewa.jq,new _Ewa.jp(this.a,n),n,null))),this.c},getCopyFlowHandler:function(){return this.f(_Ewa.c.a(this.a).cb())},getPasteFlowHandler:function(n){var t=_Ewa.bA.b(this.a)?n.copyContextSnapshot:null;return this.a.c(237)&&_Ewa.cl.c(n)?this.d():_Ewa.cl.b(n)?this.e():t&&t.sourceItem&&Object.getType(t.sourceItem)===_Ewa.fV?this.d():this.e()},initializePasteContext:function(n){var f;if(n&&n.copyContextSnapshot&&n.copyContextSnapshot.commandParameters){var t=n.copyContextSnapshot,r=t.commandParameters.ribbonCommandInfo.a===-1985798686,i=_Ewa.hF.a(t.sourceItem),u=!1;i&&(f=t.sourceItem,u=this.g(f,n));n.commandParameters.clearSystemClipboard=this.a.isChangeGateEnabled("OfficeVSO:2734868_ClearRunningAntsWhenClearSystemClipboard")?_Ewa.jF.b(t,this.a)&&r&&i&&!u:_Ewa.jF.b(t,this.a)&&r&&i}},getSessionId:function(){return this.a.f().UserSessionId},g:function(n,t){var i=n.a.o()&&t.commandParameters.originalDestination.a!==1,r=n.a.m()&&t.commandParameters.originalDestination.b!==1;return r||i},f:function(n){switch(n){case 1:return this.e();case 64:case 4:case 2:return this.d();default:throw Error.invalidOperation("Unsupported selection");}}};_Ewa.vi=function(n,t,i,r){_Ewa.vi.initializeBase(this,[n,t,i,r])};_Ewa.vi.prototype={serialize:function(n){var t=n.sourceItem,i={},r=this.d.b(t),u,e,f;if(r)i.synchronousResult=r,n.isFromCache=!0,n.clientSideCopyTime=n.commandParameters.stopwatch.b();else if(this.o(t.a)){Diag.a.a(24150922,0,50,"RangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");u=this.g.a(t.a);try{e=u.toString();r=this.a.a();r.setItem("text/plain",e);this.d.a(t,r);i.synchronousResult=r;n.clientSideCopyTime=n.commandParameters.stopwatch.b()}finally{u&&u.dispose()}}else n.isAsyncCopy=!0,i.synchronousResult=this.a.a(),i.synchronousResult.setItem("text/plain",this.m()),f=this,i.asynchronousResult=new Promise(function(i,r){var u=function(u){var e,o;if(_Ewa.h.b(u.Errors))Diag.a.a(24150924,0,10,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer failed. errors: {0}",_Ewa.h.a(u.Errors,",")),r(new _Ewa.fi(1,u.Errors));else{if(Diag.a.a(24150923,0,50,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer succeed."),n.markForCancellation){r(new _Ewa.fi(3,u.Errors));return}e=u.Result;isNullOrUndefined(e)||(n.plainTextPayloadSize=e.length);o=f.a.a();o.setItem("text/plain",e);f.d.a(t,o);i(o)}},e=function(n){var t=_Ewa.X.a(n.b);Diag.a.a(24150925,0,10,"RangeCopyPasteHandler.Serialize: LoadClipboardFromServer failed. errors: {0}",_Ewa.h.a(t,","));r(new _Ewa.fi(1,t))};Diag.a.a(24150926,0,50,"RangeCopyPasteHandler.Serialize: issue request to the server to get the copied data...");f.c.g(t.a,n.commandParameters.ribbonCommandInfo,u,e,[n.commandParameters.stopwatch])});return i},deserialize:function(n){var i,t,r;return _Ewa.ie.a(n,1),i=n.copyContextSnapshot,t=this.c.a(i),t&&(this.k(n,t),Diag.a.b(37003423,0,n.isSameSession,"RangeCopyPasteHandler.Deserialize: Should be same session operation when using RangeCopyPasteHandler")),t?(Diag.a.a(24150927,0,50,"RangeCopyPasteHandler.Deserialize: trigger PasteRange request..."),r=_Ewa.nT.a(n,t),this.p(n,i,t,r)):n.isClipboardInaccessible?Promise.reject(new _Ewa.bX(7,null,null,"")):n.commandParameters.commandType!==516&&n.commandParameters.commandType!==36?this.n(n):Promise.reject(new _Ewa.bX(5,null,null,""))}};_Ewa.nY=function(n){this.d=Function.createDelegate(this,this.S);_Ewa.nY.initializeBase(this,[n,null])};_Ewa.nY.a=function(){return{ShiftCellsRight:!1,ShiftCellsDown:!0}};_Ewa.nY.prototype={b:null,e:null,P:null,Q:function(n){this.o=_Ewa.kV.b(n);this.b=new($$sc.D.$$(_Ewa.kD));var t=_Ewa.b.a().a(15),i=_Ewa.nY.a();return this.p(t,this.d,i),this.R(),this.b.a},S:function(n,t){if(n===1){var i=1;t.ShiftCellsRight&&(i=0);Diag.a.a(25518408,0,50,"InsertCopiedCutDialog OK button pressed with valid input, shift direction = {0}",i?"Vertical":"Horizontal");this.b.b(i)}else Diag.a.a(25518409,0,50,"InsertCopiedCutDialog cancel button pressed"),this.h(),this.b.d()},R:function(){this.e=document.getElementById("ShiftCellsDown");this.P=document.getElementById("ShiftCellsRight")}};_Ewa.vh=function(){};_Ewa.vh.prototype={a:function(n,t){var i=new _Ewa.nY(n);return i.Q(t)}};_Ewa.vj=function(n,t,i,r){_Ewa.vj.initializeBase(this,[n,t,i,r])};_Ewa.vj.prototype={deserialize:function(n){_Ewa.ie.a(n,1);var i=n.copyContextSnapshot,t=this.c.a(i);return t&&(this.k(n,t),Diag.a.b(37003424,0,n.isSameSession,"SameSessionRangeCopyPasteHandler.Deserialize: Should be same session operation when using SameSessionRangeCopyPasteHandler")),_Ewa.cl.b(n)?this.i(n):_Ewa.vi.prototype.deserialize.call(this,n)}};_Ewa.zr=function(){};_Ewa.zr.a=function(n,t,i,r,u,f){var e=n.a(41,f);return e.insertCopiedCutCellsParameters=t,_Ewa.i.a(n,"InsertCopiedCutCells",e,i,r,u,4,null)};_Ewa.ij=function(){};_Ewa.ij.a=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.i.a(n,"Copy",o,i,r,u,0,e)};_Ewa.ij.c=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.copyParameters=t,_Ewa.i.a(n,"Cut",o,i,r,u,0,e)};_Ewa.ij.b=function(n,t,i,r,u,f,e){var o=n.a(1,f);return o.pasteParameters=t,_Ewa.i.a(n,"Paste",o,i,r,u,64,e)};_Ewa.jr.registerClass("_Ewa.jr",_Ewa.IR,_Ewa.hu,_Ewa.iB,Sys.IDisposable);_Ewa.jr.d.registerClass("_Ewa.jr.d");_Ewa.Hp.registerClass("_Ewa.Hp");_Ewa.nT.registerClass("_Ewa.nT",_Ewa.Hp);_Ewa.jo.registerClass("_Ewa.jo",_Ewa.nT);_Ewa.nS.registerClass("_Ewa.nS",_Ewa.Hp);_Ewa.nU.registerClass("_Ewa.nU",_Ewa.U);_Ewa.nW.registerClass("_Ewa.nW",_Ewa.mu.$$(_Ewa.cq));_Ewa.cr.registerClass("_Ewa.cr",_Ewa.cv,_Ewa.cq,_Ewa.Kz,Sys.IDisposable);_Ewa.vi.registerClass("_Ewa.vi",_Ewa.nT);_Ewa.nY.registerClass("_Ewa.nY",_Ewa.Ik);_Ewa.vj.registerClass("_Ewa.vj",_Ewa.vi);_Ewa.kV.a="<div class='WACDialogRow' id='labelRow'> <label id='labelId' class='WACDialogLabel' >{0}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='RightRow'> <input type='radio' id='ShiftCellsRight' name='ShiftOptions' class='WACDialogRadio' alt='{1}' title='{1}'><\/input> <label id='ShiftRight' class='WACDialogLabel' for='ShiftCellsRight' >{1}<\/label> <\/div> <div class='WACDialogRowNoBreak' id='DownRow'> <input type='radio' id='ShiftCellsDown' name='ShiftOptions' class='WACDialogRadio' alt='{2}' title='{2}'><\/input> <label id='ShiftDown' class='WACDialogLabel' for='ShiftCellsDown' >{2}<\/label> <\/div>";_Ewa.cr.e=[320];_Ewa.cr.b=[326];_Ewa.cr.d=[294];_Ewa.cr.c=[159];Type.registerNamespace("_Ewa");_Ewa.Hq=function(){};_Ewa.Hq.a=function(){_Ewa.g.a(function(n){_Ewa.bA.a(n)?_Ewa.nW.a(n):(n.a().b(_Ewa.iB,6,new _Ewa.jr(_Ewa.c.a(n),n.a().a(_Ewa.ob,7,!1),n.a().a(_Ewa.kY,165,!1),null)),n.F(),_Ewa.nU.a(n))})};_Ewa.Hq.a();Type.registerNamespace("_Ewa");_Ewa.wt=function(){};_Ewa.wt.prototype={a:function(n,t){var i;try{var r=_Ewa.a.W(n,!0),u=this.c(!1,!0),e=window.morphdom(t,r,u)}catch(f){Diag.a.a(40132949,0,10,"DomDiffApply.MorphElement: failed with exception {0}",f);i=_Ewa.jw.a();t=i.a(n,t)}return t},b:function(n,t){var i,r,u;try{i=_Ewa.a.W(n,!0);r=this.c(!0,!0);window.morphdom(t,i,r)}catch(f){Diag.a.a(40132950,0,10,"DomDiffApply.MorphChildren: failed with exception {0}",f);u=_Ewa.jw.a();t=u.b(n,t)}return t},c:function(n,t){var i,r=this;return i=new $d,i.childrenOnly=n,i.onBeforeElUpdated=function(n,i){return _Ewa.a.bx(n),t&&_Ewa.a.bf(n,i),!0},i}};_Ewa.oS=function(){_Ewa.oS.initializeBase(this);this.j()};_Ewa.oS.a=function(n){n.a().b(_Ewa.Lv.$$(_Ewa.ez),256,new _Ewa.oS)};_Ewa.oS.prototype={b:function(){var n=this;_Ewa.f.cw(_Ewa.r.c(41,4,!1),function(){n.i(new _Ewa.wt)},this.cT(),3)}};$d.prototype={getNodeKey:null,onBeforeNodeAdded:null,onNodeAdded:null,onBeforeElUpdated:null,onElUpdated:null,onBeforeNodeDiscarded:null,onNodeDiscarded:null,onBeforeElChildrenUpdated:null,childrenOnly:!1};_Ewa.oS.registerClass("_Ewa.oS",_Ewa.mu.$$(_Ewa.ez));Type.registerNamespace("_Ewa");_Ewa.Iq=function(){};_Ewa.Iq.a=function(){_Ewa.g.a(_Ewa.oS.a)};_Ewa.Iq.a();