var excelOnlineCalc=function(E){var v={};function A(N){if(v[N])return v[N].exports;var O=v[N]={i:N,l:!1,exports:{}};return E[N].call(O.exports,O,O.exports,A),O.l=!0,O.exports}return A.m=E,A.c=v,A.d=function(E,v,N){A.o(E,v)||Object.defineProperty(E,v,{enumerable:!0,get:N})},A.r=function(E){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})},A.t=function(E,v){if(1&v&&(E=A(E)),8&v)return E;if(4&v&&"object"==typeof E&&E&&E.__esModule)return E;var N=Object.create(null);if(A.r(N),Object.defineProperty(N,"default",{enumerable:!0,value:E}),2&v&&"string"!=typeof E)for(var O in E)A.d(N,O,function(v){return E[v]}.bind(null,O));return N},A.n=function(E){var v=E&&E.__esModule?function(){return E.default}:function(){return E};return A.d(v,"a",v),v},A.o=function(E,v){return Object.prototype.hasOwnProperty.call(E,v)},A.p="",A(A.s=8)}([function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var N=A(1);v.utils=N;var O=A(2);v.idbPromised=O;var C=A(3);v.ULS=C.ULS,v.TraceLevel=C.TraceLevel,v.LogCategory=C.LogCategory,v.NulLogger=C.NulLogger,v.ConsoleLogger=C.ConsoleLogger;var L=A(4);v.browserSupport=L;var F=A(5);v.perfWatch=F;var U=A(6);v.initEwaUtils=U.initEwaUtils,v.ewaUtils=U.ewaUtils;var y=A(7);v.initStopwatchFactory=y.initStopwatchFactory},function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0}),v.forEachPromise=function(E,v,A){return E.reduce(function(E,N){return E.then(function(){return A&&A.stop?Promise.resolve(void 0):v(N,A)})},Promise.resolve(void 0))},v.defaultToJSONResultWhenStringifyFails="...",v.getStringifiedError=function(E){if(0===E)return"0";if(!E)return"";try{return JSON.stringify(function E(v,A){if(void 0===A&&(A=0),A<0||A>N)return v;if(null==v||"object"!=typeof v)return v;var O={};Object.getOwnPropertyNames(v).forEach(function(E){"stack"!==E&&E.toUpperCase()!==E&&(O[E]=v[E])});var C=Object.getPrototypeOf(v);C&&"object"==typeof C&&Object.keys(C).forEach(function(E){"stack"!==E&&E.toUpperCase()!==E&&(O[E]=v[E])});var L={};return Object.keys(O).forEach(function(v){L[v]=E(O[v],A+1)}),L}(E))}catch(E){return v.defaultToJSONResultWhenStringifyFails}};var N=5;var O="_",C=new RegExp("\\W+","g");v.getPerfWatchMarkName=function(E){if(!E)return"";var v=E.trim().substring(0,200).trim().replace(C,O).substring(0,80);return v&&v.length>0&&v.substr(v.length-1,1)===O&&(v=v.substr(0,v.length-1)),v&&v.length>0&&v.substr(0,1)===O&&(v=v.substr(1)),v},v.retry=function(E,v){if(!E)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(v<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+v));for(var A=Promise.reject(void 0),N=function(v){A=A.catch(function(A){return E(v,A)})},O=1;O<=v;O+=1)N(O);return A},v.chainFallbackPromises=function(E,v){if(!E||0===E.length)return Promise.resolve();for(var A=v(E[0]),N=function(N){var O=E[N];A=A.catch(function(){return v(O)})},O=1;O<E.length;O+=1)N(O);return A},v.getQueryParameterByName=function(E,v){var A=new RegExp("[?&]"+v+"(=([^&#]*)|&|#|$)").exec(E);if(A)return A[2]?decodeURIComponent(A[2].replace(/\+/g," ")):""},v.calcHashCode=function(E){if(!E)return 0;for(var v=5381,A=v,N=E.length,O=0;O<N&&(v=4294967295&((v<<5)+v^E.charCodeAt(O)),O!==N-1);O+=2)A=4294967295&((A<<5)+A^E.charCodeAt(O+1));var C=v+35685*A+(23896*A<<16)&4294967295;return C<0&&(C+=4294967296),C}},function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var N,O=A(1);function C(E,v,A){return E?!(v&&!E.objectStoreNames.contains(v))||(A({name:"ValidationError",message:"The database doesn't contain store name: "+v}),!1):(A({name:"ValidationError",message:"The database should be initialized"}),!1)}var L=void 0;function F(E){void 0!==L&&L(E)}function U(E,v,A,N){return new Promise(function(O,L){if(C(E,v,L)){var F,U=E.transaction([v],A);U.oncomplete=function(){return O()},U.onerror=function(){return L(F||U.error)},U.onabort=function(){return L(F||U.error)};var y=U.objectStore(v),P=N(y);P.onerror=function(){F=P.error}}})}v.registerTraceSubscriber=function(E){L=E},v.clearTraceSubscriber=function(){L=void 0},v.setTestDbFactory=function(E){N=E},v.getDbFactory=function(){if(N)return N;try{if(window&&"indexedDB"in window&&void 0!==window.indexedDB)return window.indexedDB}catch(A){var E=O.getStringifiedError(A);E&&E!==O.defaultToJSONResultWhenStringifyFails||!A||!A.message||(E=A.message);var v=O.getPerfWatchMarkName(E);F("indexedDB_access_error"+(v&&v.length>0?"_":"")+v)}},v.getStoreReadinessPromise=function(E){return new Promise(function(v,A){E.transaction.oncomplete=function(){return v()},E.transaction.onerror=function(){return A(E.transaction.error)}})},v.initDb=function(E,v,A,N){return new Promise(function(O,C){F("idb_open");var L,U,y,P,V=A||0===A?E.open(v,A):E.open(v),G=(L=!1,U=!1,y=function(E){F("idb_open_"+E)},P=function(){return U?(y("already_resolved"),!1):!L||(y("already_rejected"),!1)},{rejectOnce:function(E){y("should_reject"),P()&&(y("rejecting"),L=!0,C(E))},resolveOnce:function(E){y("should_resolve"),P()&&(y("resolving"),U=!0,O(E))}});V.onupgradeneeded=function(E){F("idb_open_onupgradeneeded_start");var A=E.target.result;if(E.oldVersion>0&&function(E){F("idb_open_onupgradeneeded_deleteAllObjectStores");for(var v=[],A=E.objectStoreNames.length-1;A>=0;A-=1){var N=E.objectStoreNames.item(A);(N||""===N)&&v.push(N)}v.forEach(function(v){F("idb_open_onupgradeneeded_delete_store_"+v),E.deleteObjectStore(v)})}(A),N){F("idb_open_onupgradeneeded_create_stores");var O=N(A);O&&O.length>0&&Promise.all(O).then(function(){F("idb_open_onupgradeneeded_stores_ready"),G.resolveOnce({db:A,dbName:v})},function(E){F("idb_open_onupgradeneeded_stores_ready_error"),G.rejectOnce(E)})}F("idb_open_onupgradeneeded_end")},V.onsuccess=function(E){F("idb_open_onsuccess"),G.resolveOnce({db:E.target.result,dbName:v})},V.onerror=function(){F("idb_open_onerror"),G.rejectOnce(V.error)},V.onblocked=function(E){F("idb_open_onblocked"),G.rejectOnce(E)}})},v.deleteDb=function(E,v){return new Promise(function(A,N){var O=E.deleteDatabase(v);O.onsuccess=function(){return A()},O.onblocked=function(){return A()},O.onerror=function(){return N(O.error)}})},v.doTransactionAction=U,v.put=function(E,v,A,N){return U(E,v,"readwrite",function(E){return A?E.put(N,A):E.put(N)})},v.get=function(E,v,A){return new Promise(function(N,O){if(C(E,void 0,O)){var L;E.objectStoreNames.contains(v)||N(void 0);var F=void 0,U=E.transaction([v],"readonly");U.oncomplete=function(){return N(F)},U.onerror=function(){return O(L||U.error)},U.onabort=function(){return O(L||U.error)};var y=U.objectStore(v).get(A);y.onsuccess=function(E){F=E.target.result},y.onerror=function(){L=y.error}}})},v.getAllItems=function(E,v){return new Promise(function(A,N){if(C(E,v,N)){var O,L=[],F=E.transaction([v],"readonly");F.oncomplete=function(){return A(L)},F.onerror=function(){return N(O||F.error)},F.onabort=function(){return N(O||F.error)};var U=F.objectStore(v).openCursor();U.onsuccess=function(E){var v=E.target.result;v&&(L.push(v.value),v.continue())},U.onerror=function(){O=U.error}}})},v.getAllKeys=function(E,v){return new Promise(function(A,N){if(C(E,v,N)){var O,L=[],F=E.transaction([v],"readonly");F.oncomplete=function(){return A(L)},F.onerror=function(){return N(O||F.error)},F.onabort=function(){return N(O||F.error)};var U=F.objectStore(v).openCursor();U.onsuccess=function(E){var v=E.target.result;v&&(L.push(v.key),v.continue())},U.onerror=function(){O=U.error}}})},v.remove=function(E,v,A){return U(E,v,"readwrite",function(E){return E.delete(A)})},v.removeAll=function(E,v){return U(E,v,"readwrite",function(E){return E.clear()})}},function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0}),function(E){E[E.Error=10]="Error",E[E.Warning=15]="Warning",E[E.Info=50]="Info",E[E.Verbose=100]="Verbose",E[E.Spam=200]="Spam"}(v.TraceLevel||(v.TraceLevel={})),function(E){E[E.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(v.LogCategory||(v.LogCategory={})),v.ULS={getFromExternalLogger:function(E){var v=E;return{ULS:{trace:function(E,A,N){return v.traceTag(0,E,A,N)},traceTag:function(E,A,N,O){return v.traceTag(E,A,N,O)},debugTrace:function(E,A,N){return v.debugTraceTag(0,E,A,N)},debugTraceTag:function(E,A,N,O){return v.debugTraceTag(E,A,N,O)},assert:function(E,A,N){return v.assertTag(0,E,A,N)},assertTag:function(E,A,N,O){return v.assertTag(E,A,N,O)},shipAssert:function(E,A,N){return v.shipAssertTag(0,E,A,N)},shipAssertTag:function(E,A,N,O){return v.shipAssertTag(E,A,N,O)}}}}};var N=function(){function E(){}return E.prototype.shipAssertTag=function(E,v,A,N){console.assert(A,"shipAssertTag:",E,v,N)},E.prototype.assertTag=function(E,v,A,N){console.assert(A,"assertTag",E,v,N)},E.prototype.traceTag=function(E,v,A,N){console.log("traceTag",E,N,v,A)},E.prototype.debugTraceTag=function(E,v,A,N){console.log("debugTraceTag",E,N,v,A)},E}();v.ConsoleLogger=N;var O=function(){function E(){}return E.prototype.shipAssertTag=function(){},E.prototype.assertTag=function(){},E.prototype.traceTag=function(){},E.prototype.debugTraceTag=function(){},E}();v.NulLogger=O},function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var N={},O="promises";v.promises=function(){return void 0===N[O]&&(N[O]="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),N[O]}},function(E,v,A){"use strict";function N(){return window.performance&&window.performance.now?window.performance.now():Date.now()}function O(E,v,A){E[v]=N()-A}Object.defineProperty(v,"__esModule",{value:!0}),v.start=function(E){var v=N(),A=E,C=v,L={},F=function(E,v,N){return function(E,v,A,N,C,L){O(E,"end",A);var F={sessionName:v,result:N?"success":"failure",message:L,marks:E},U=JSON.stringify(F);C(U)}(L,A,C,E,v,N)};return L.start=0,{mark:function(E){return function(E){return O(L,E,C)}(E)},end:function(E){return F(!0,E)},success:function(E,v){return F(!0,E,v)},failure:function(E,v){return F(!1,E,v)}}},v.mark=function(E,v){void 0!==E&&E.mark(v)},v.end=function(E,v){void 0!==E&&E.end(v)},v.success=function(E,v,A){void 0!==E&&E.success(v,A)},v.failure=function(E,v,A){void 0!==E&&E.failure(v,A)}},function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var N={isChangeGateEnabled:function(E){return!1}};v.ewaUtils=function(){return N},v.initEwaUtils=function(E){if(!E)throw new Error("the 'ewaUtils' argument is missing");N=E}},function(E,v,A){"use strict";Object.defineProperty(v,"__esModule",{value:!0});var N=function(){return Date.now()};v.initStopwatchFactory=function(E,v){return void 0===v&&(v=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(N=function(){return self.performance.now()}),function(A){var O=N(),C=A;return{reset:function(E){null!=E&&(C=E),O=N()},stop:function(){var A=N()-O,L=JSON.stringify({Target:C,Duration:A.toFixed(v)});E(L)}}}}},function(E,v,A){"use strict";A.r(v);var N={};A.r(N),A.d(N,"ReasonKind",function(){return TA}),A.d(N,"notImplemented",function(){return sA}),A.d(N,"notFormulaString",function(){return MA}),A.d(N,"createParser",function(){return sL}),A.d(N,"parseResultHelper",function(){return tL});var O={};A.r(O),A.d(O,"createAnalyzer",function(){return cF});var C={};A.r(C),A.d(C,"fastMathpack",function(){return OU}),A.d(C,"createCompiler",function(){return zy}),A.d(C,"createEvaluator",function(){return XG}),A.d(C,"ReasonKind",function(){return IU}),A.d(C,"CellKind",function(){return SU}),A.d(C,"Interrupt",function(){return uU}),A.d(C,"notImplemented",function(){return mU}),A.d(C,"finalValue",function(){return DU}),A.d(C,"pendingValue",function(){return sU}),A.d(C,"cellFormula",function(){return TU}),A.d(C,"unavailable",function(){return rU}),A.d(C,"unevaluated",function(){return gU}),A.d(C,"stopped",function(){return MU}),A.d(C,"nameCycle",function(){return lU}),A.d(C,"cellCycle",function(){return pU}),A.d(C,"paused",function(){return tU}),A.d(C,"previousFailure",function(){return cU}),A.d(C,"javaScriptError",function(){return kU}),A.d(C,"evalGlobals",function(){return dU}),A.d(C,"getEvalFailureReason",function(){return aU}),A.d(C,"illFormedFormula",function(){return fU}),A.d(C,"extractResultValue",function(){return Uy}),A.d(C,"evalToCellValue",function(){return yy}),A.d(C,"getBasicFirstOrderFunc",function(){return ZH}),A.d(C,"extension",function(){return YH});var L={};A.r(L),A.d(L,"recalcMapper",function(){return lH}),A.d(L,"mapperContext",function(){return pH}),A.d(L,"formulaCacheGlobals",function(){return vb}),A.d(L,"formulaCache",function(){return Ab}),A.d(L,"createFormatInfo",function(){return Eb});var F={};A.r(F),A.d(F,"getBasicFirstOrderFunc",function(){return ZH});var U=A(0);function y(E){return"number"==typeof E&&isFinite(E)&&Math.floor(E)===E}function P(E){return E}function V(E){if("object"!=typeof E)return"<unexpected>";var v={};for(var A in E)E.hasOwnProperty(A)&&(v[A]=G(E[A],A));return v}function G(E,v){if("string"==typeof v&&null!=_[v])return E;var A=function(E){var v=typeof E;if("object"===v){if(null===E)return"null";if(E instanceof Array)return"Array";var A=E.kind;if("string"==typeof A)return A}return v}(E),N=K[A];return null!=N?N(E,v):"object"==typeof E?V(E):"<unexpected>"}function H(E){try{var v=function(E){if("object"==typeof E&&null!=E){if(E.hasOwnProperty("node")&&E.hasOwnProperty("spans"))return"Formula";if(E.hasOwnProperty("kind")&&("Literal"===(v=E.kind)||"Array"===v||"App"===v||"Paren"===v||"Name"===v||"CellRef"===v||"Bad"===v||"Operator"===v))return"FormulaNode"}var v}(E);if(void 0!==v){var A=W[v](E);return void 0!==A?A:JSON.stringify(G(E,void 0))}return JSON.stringify(G(E,void 0))}catch(E){return E instanceof Error?"<error "+E.name+": "+JSON.stringify(E.message)+">":"<error: "+JSON.stringify(E)+">"}}var b,_={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},K={boolean:P,symbol:P,undefined:P,null:P,number:function(E){return"number"!=typeof E?"<unexpected>":isFinite(E)?"<number>":E},string:function(E){return"string"!=typeof E?"<unexpected>":E.length>0?"<string>":E},function:function(E){if("function"!=typeof E)return"<unexpected>";var v=E.name;return"string"==typeof v&&v.length>0?"<function "+v+">":"<function>"},object:V,Array:function(E){return"object"==typeof E&&E instanceof Array?E.map(G):"<unexpected>"}},W={},X={ULS:new U.NulLogger};function Y(E){X.ULS=E}function J(E,v){var A=E+": code should be unreachable because a value has type 'never'; given "+H(v);return X.ULS.assertTag(595980872,U.LogCategory.msoulscat_ES_EWAJS,!1,A)}function j(E){return X.ULS.assertTag(595980873,U.LogCategory.msoulscat_ES_EWAJS,!1,E)}function Z(E,v){(!y(v)||v<0)&&j(E+": expected natural number; given "+H(v))}function $(E,v){(!y(v)||v<=0)&&j(E+": expected positive integer; given "+H(v))}function R(E,v,A){(!y(v)||v<0||v>=A)&&j(E+": expected natural number less than "+H(A)+"; given "+H(v))}!function(E){E[E.Cell=1]="Cell",E[E.Range=2]="Range",E[E.NameManager=3]="NameManager",E[E.CondFormatting=4]="CondFormatting",E[E.DataValidation=5]="DataValidation"}(b||(b={}));var h=B(void 0,"");function B(E,v){return{path:E,name:v}}function w(E,v,A){return{document:E,index:v,length:A}}function x(E,v,A){return Z("calc.lang.sheetRange",v),$("calc.lang.sheetRange",A),w(E,v,A)}function q(E,v){return Z("calc.lang.sheetIndex",v),w(E,v,1)}function z(E,v,A,N){return{row:E,col:v,rows:A,cols:N}}function Q(E,v,A,N){return Z("calc.lang.gridRange",E),Z("calc.lang.gridRange",v),$("calc.lang.gridRange",A),$("calc.lang.gridRange",N),z(E,v,A,N)}function m(E,v){return Z("calc.lang.gridCell",E),Z("calc.lang.gridCell",v),z(E,v,1,1)}function r(E,v){return{sheet:E,range:v}}var S,u,I,f,D,s,T=r,M=r,g=r;function d(E){return{document:E,index:void 0}}function l(E,v){return{scope:E,name:v}}function p(E,v,A,N,O,C){(Z("calc.lang.functionType",E),0===A.length&&v.length<E)&&j("calc.lang.functionType: expected headTypes.length >= "+E+"; given "+JSON.stringify(v));return{minArgs:E,headTypes:v,restTypes:A,returnType:N,staticPrecs:O,flags:C}}function c(E,v,A,N){return{cells:E,names:v,special:A,isExact:N}}function k(E){return{kind:S.Error,type:E}}!function(E){E[E.Number=1]="Number",E[E.String=2]="String",E[E.Boolean=4]="Boolean",E[E.Error=8]="Error",E[E.Range=16]="Range",E[E.Array=32]="Array",E[E.Missing=64]="Missing",E[E.Blank=128]="Blank",E[E.Rich=256]="Rich"}(S||(S={})),function(E){E[E.None=0]="None",E[E.Goto=512]="Goto",E[E.Ref3D=1024]="Ref3D",E[E.All=2047]="All"}(u||(u={})),function(E){E[E.None=0]="None",E[E.OwnDoc=1]="OwnDoc",E[E.OwnSheet=2]="OwnSheet",E[E.OwnRow=4]="OwnRow",E[E.OwnCol=8]="OwnCol",E[E.OwnRowCopy=16]="OwnRowCopy",E[E.OwnColCopy=32]="OwnColCopy",E[E.OwnDocSheets=64]="OwnDocSheets",E[E.CellProps=128]="CellProps",E[E.AllCells=256]="AllCells",E[E.AllNames=512]="AllNames",E[E.Time=1024]="Time",E[E.Calc=2048]="Calc",E[E.All=4095]="All"}(I||(I={})),function(E){E[E.None=0]="None",E[E.Dark=1]="Dark",E[E.Macro=2]="Macro"}(f||(f={})),function(E){E[E.NULL=1]="NULL",E[E.DIV0=2]="DIV0",E[E.VALUE=3]="VALUE",E[E.REF=4]="REF",E[E.NAME=5]="NAME",E[E.NUM=6]="NUM",E[E.NA=7]="NA",E[E.GETTING_DATA=8]="GETTING_DATA"}(D||(D={})),function(E){E[E.First=1]="First",E[E.Last=8]="Last"}(s||(s={}));var t=k(D.NULL),a=k(D.DIV0),i=k(D.VALUE),o=k(D.REF),e=k(D.NAME),n=k(D.NUM),EE=k(D.NA),vE=k(D.GETTING_DATA);function AE(E,v,A){return Z("calc.lang.arrayOper",E),Z("calc.lang.arrayOper",v),A.length!==E?j("calc.lang.arrayOper: Inconsistent row number"):{kind:S.Array,rows:E,cols:v,opers:A}}function NE(E,v){return $("calc.lang.rangeSeqOper",v.length),{kind:S.Range,sheets:E,ranges:v}}function OE(E,v){return{kind:S.Range,sheets:E,ranges:[v]}}var CE,LE,FE,UE,yE,PE,VE={kind:S.Missing},GE={kind:S.Blank};function HE(E){return void 0===E&&(E=0),{kind:LE.Error,isQuoted:!1,label:E}}function bE(E){return void 0===E&&(E=0),{kind:LE.Relative,isQuoted:!1,label:E}}!function(E){E[E.R1C1=1]="R1C1",E[E.A1=2]="A1"}(CE||(CE={})),function(E){E.Error="Error",E.Relative="Relative",E.Document="Document",E.Sheet="Sheet",E.Ident="Ident",E.SheetRange="SheetRange"}(LE||(LE={})),function(E){E.Error="Error",E.Single="Single",E.Range="Range",E.Row="Row",E.Col="Col"}(FE||(FE={})),function(E){E.Abs="Abs",E.Rel="Rel"}(UE||(UE={})),function(E){E.Literal="Literal",E.Array="Array",E.App="App",E.Paren="Paren",E.Name="Name",E.CellRef="CellRef",E.Bad="Bad",E.Operator="Operator"}(yE||(yE={})),function(E){E.Unexpected="Unexpected",E.CellRef="CellRef",E.Qualifier="Qualifier",E.Sequence="Sequence"}(PE||(PE={}));var _E=HE(),KE=bE();function WE(E,v,A,N){return void 0===A&&(A=!1),void 0===N&&(N=0),{kind:LE.Document,isQuoted:A,label:N,document:E,path:v}}function XE(E,v,A,N){return void 0===A&&(A=!1),void 0===N&&(N=0),{kind:LE.Sheet,isQuoted:A,label:N,sheet:E,document:v}}function YE(E,v,A){return void 0===v&&(v=!1),void 0===A&&(A=0),{kind:LE.Ident,isQuoted:v,label:A,name:E}}function JE(E,v,A,N){return void 0===A&&(A=!1),void 0===N&&(N=0),{kind:LE.SheetRange,isQuoted:A,label:N,sheet1:E,sheet2:v}}function jE(E,v){return{kind:E,index:v}}function ZE(E){return void 0===E&&(E=0),{kind:FE.Error,label:E}}var $E,RE=ZE();function hE(E,v,A){return void 0===A&&(A=0),{kind:FE.Single,label:A,row:E,col:v}}function BE(E,v,A){return void 0===A&&(A=0),{kind:FE.Range,label:A,ref1:E,ref2:v}}function wE(E,v,A){return void 0===A&&(A=0),{kind:FE.Row,label:A,row1:E,row2:v}}function xE(E,v,A){return void 0===A&&(A=0),{kind:FE.Col,label:A,col1:E,col2:v}}function qE(E,v){return{node:E,spans:v}}function zE(E,v,A,N){var O,C;return Z("calc.lang.formulaSpan",E),O="calc.lang.formulaSpan",y(C=v)||j(O+": expected integer; given "+H(C)),v<E&&j("calc.lang.formulaSpan: expected end >= "+E+"; given "+v),{start:E,end:v,pre:A,post:N}}function QE(E,v,A){return void 0===v&&(v=!0),void 0===A&&(A=0),{kind:yE.Literal,label:A,oper:E,isClosed:v}}function mE(E,v,A){return void 0===v&&(v=!0),void 0===A&&(A=0),{kind:yE.Array,label:A,nodes:E,isClosed:v}}function rE(E,v,A,N){return void 0===A&&(A=!0),void 0===N&&(N=0),{kind:yE.App,label:N,head:E,args:v,isClosed:A}}function SE(E,v){return void 0===v&&(v=0),{kind:yE.Operator,label:v,id:E}}function uE(E,v,A){return void 0===v&&(v=!0),void 0===A&&(A=0),{kind:yE.Paren,label:A,node:E,isClosed:v}}function IE(E,v,A){return void 0===A&&(A=0),{kind:yE.Name,label:A,whole:E,qualifier:v}}function fE(E,v,A){return void 0===A&&(A=0),{kind:yE.CellRef,label:A,ref:E,qualifier:v}}function DE(E,v,A){return void 0===A&&(A=0),{kind:yE.Bad,label:A,type:E,contents:v}}!function(E){E[E.COUNT=0]="COUNT",E[E.IF=1]="IF",E[E.ISNA=2]="ISNA",E[E.ISERROR=3]="ISERROR",E[E.SUM=4]="SUM",E[E.AVERAGE=5]="AVERAGE",E[E.MIN=6]="MIN",E[E.MAX=7]="MAX",E[E.ROW=8]="ROW",E[E.COLUMN=9]="COLUMN",E[E.NA=10]="NA",E[E.NPV=11]="NPV",E[E.STDEV=12]="STDEV",E[E.DOLLAR=13]="DOLLAR",E[E.FIXED=14]="FIXED",E[E.SIN=15]="SIN",E[E.COS=16]="COS",E[E.TAN=17]="TAN",E[E.ATAN=18]="ATAN",E[E.PI=19]="PI",E[E.SQRT=20]="SQRT",E[E.EXP=21]="EXP",E[E.LN=22]="LN",E[E.LOG10=23]="LOG10",E[E.ABS=24]="ABS",E[E.INT=25]="INT",E[E.SIGN=26]="SIGN",E[E.ROUND=27]="ROUND",E[E.LOOKUP=28]="LOOKUP",E[E.INDEX=29]="INDEX",E[E.REPT=30]="REPT",E[E.MID=31]="MID",E[E.LEN=32]="LEN",E[E.VALUE=33]="VALUE",E[E.TRUE=34]="TRUE",E[E.FALSE=35]="FALSE",E[E.AND=36]="AND",E[E.OR=37]="OR",E[E.NOT=38]="NOT",E[E.MOD=39]="MOD",E[E.DCOUNT=40]="DCOUNT",E[E.DSUM=41]="DSUM",E[E.DAVERAGE=42]="DAVERAGE",E[E.DMIN=43]="DMIN",E[E.DMAX=44]="DMAX",E[E.DSTDEV=45]="DSTDEV",E[E.VAR=46]="VAR",E[E.DVAR=47]="DVAR",E[E.TEXT=48]="TEXT",E[E.LINEST=49]="LINEST",E[E.TREND=50]="TREND",E[E.LOGEST=51]="LOGEST",E[E.GROWTH=52]="GROWTH",E[E.GOTO=53]="GOTO",E[E.HALT=54]="HALT",E[E.RETURN=55]="RETURN",E[E.PV=56]="PV",E[E.FV=57]="FV",E[E.NPER=58]="NPER",E[E.PMT=59]="PMT",E[E.RATE=60]="RATE",E[E.MIRR=61]="MIRR",E[E.IRR=62]="IRR",E[E.RAND=63]="RAND",E[E.MATCH=64]="MATCH",E[E.DATE=65]="DATE",E[E.TIME=66]="TIME",E[E.DAY=67]="DAY",E[E.MONTH=68]="MONTH",E[E.YEAR=69]="YEAR",E[E.WEEKDAY=70]="WEEKDAY",E[E.HOUR=71]="HOUR",E[E.MINUTE=72]="MINUTE",E[E.SECOND=73]="SECOND",E[E.NOW=74]="NOW",E[E.AREAS=75]="AREAS",E[E.ROWS=76]="ROWS",E[E.COLUMNS=77]="COLUMNS",E[E.OFFSET=78]="OFFSET",E[E.ABSREF=79]="ABSREF",E[E.RELREF=80]="RELREF",E[E.ARGUMENT=81]="ARGUMENT",E[E.SEARCH=82]="SEARCH",E[E.TRANSPOSE=83]="TRANSPOSE",E[E.ERROR=84]="ERROR",E[E.STEP=85]="STEP",E[E.TYPE=86]="TYPE",E[E.ECHO=87]="ECHO",E[E.SET_NAME=88]="SET_NAME",E[E.CALLER=89]="CALLER",E[E.DEREF=90]="DEREF",E[E.WINDOWS=91]="WINDOWS",E[E.SERIES=92]="SERIES",E[E.DOCUMENTS=93]="DOCUMENTS",E[E.ACTIVE_CELL=94]="ACTIVE_CELL",E[E.SELECTION=95]="SELECTION",E[E.RESULT=96]="RESULT",E[E.ATAN2=97]="ATAN2",E[E.ASIN=98]="ASIN",E[E.ACOS=99]="ACOS",E[E.CHOOSE=100]="CHOOSE",E[E.HLOOKUP=101]="HLOOKUP",E[E.VLOOKUP=102]="VLOOKUP",E[E.LINKS=103]="LINKS",E[E.INPUT=104]="INPUT",E[E.ISREF=105]="ISREF",E[E.GET_FORMULA=106]="GET_FORMULA",E[E.GET_NAME=107]="GET_NAME",E[E.SET_VALUE=108]="SET_VALUE",E[E.LOG=109]="LOG",E[E.EXEC=110]="EXEC",E[E.CHAR=111]="CHAR",E[E.LOWER=112]="LOWER",E[E.UPPER=113]="UPPER",E[E.PROPER=114]="PROPER",E[E.LEFT=115]="LEFT",E[E.RIGHT=116]="RIGHT",E[E.EXACT=117]="EXACT",E[E.TRIM=118]="TRIM",E[E.REPLACE=119]="REPLACE",E[E.SUBSTITUTE=120]="SUBSTITUTE",E[E.CODE=121]="CODE",E[E.NAMES=122]="NAMES",E[E.DIRECTORY=123]="DIRECTORY",E[E.FIND=124]="FIND",E[E.CELL=125]="CELL",E[E.ISERR=126]="ISERR",E[E.ISTEXT=127]="ISTEXT",E[E.ISNUMBER=128]="ISNUMBER",E[E.ISBLANK=129]="ISBLANK",E[E.T=130]="T",E[E.N=131]="N",E[E.FOPEN=132]="FOPEN",E[E.FCLOSE=133]="FCLOSE",E[E.FSIZE=134]="FSIZE",E[E.FREADLN=135]="FREADLN",E[E.FREAD=136]="FREAD",E[E.FWRITELN=137]="FWRITELN",E[E.FWRITE=138]="FWRITE",E[E.FPOS=139]="FPOS",E[E.DATEVALUE=140]="DATEVALUE",E[E.TIMEVALUE=141]="TIMEVALUE",E[E.SLN=142]="SLN",E[E.SYD=143]="SYD",E[E.DDB=144]="DDB",E[E.GET_DEF=145]="GET_DEF",E[E.REFTEXT=146]="REFTEXT",E[E.TEXTREF=147]="TEXTREF",E[E.INDIRECT=148]="INDIRECT",E[E.REGISTER=149]="REGISTER",E[E.CALL=150]="CALL",E[E.ADD_BAR=151]="ADD_BAR",E[E.ADD_MENU=152]="ADD_MENU",E[E.ADD_COMMAND=153]="ADD_COMMAND",E[E.ENABLE_COMMAND=154]="ENABLE_COMMAND",E[E.CHECK_COMMAND=155]="CHECK_COMMAND",E[E.RENAME_COMMAND=156]="RENAME_COMMAND",E[E.SHOW_BAR=157]="SHOW_BAR",E[E.DELETE_MENU=158]="DELETE_MENU",E[E.DELETE_COMMAND=159]="DELETE_COMMAND",E[E.GET_CHART_ITEM=160]="GET_CHART_ITEM",E[E.DIALOG_BOX=161]="DIALOG_BOX",E[E.CLEAN=162]="CLEAN",E[E.MDETERM=163]="MDETERM",E[E.MINVERSE=164]="MINVERSE",E[E.MMULT=165]="MMULT",E[E.FILES=166]="FILES",E[E.IPMT=167]="IPMT",E[E.PPMT=168]="PPMT",E[E.COUNTA=169]="COUNTA",E[E.CANCEL_KEY=170]="CANCEL_KEY",E[E.FOR=171]="FOR",E[E.WHILE=172]="WHILE",E[E.BREAK=173]="BREAK",E[E.NEXT=174]="NEXT",E[E.INITIATE=175]="INITIATE",E[E.REQUEST=176]="REQUEST",E[E.POKE=177]="POKE",E[E.EXECUTE=178]="EXECUTE",E[E.TERMINATE=179]="TERMINATE",E[E.RESTART=180]="RESTART",E[E.HELP=181]="HELP",E[E.GET_BAR=182]="GET_BAR",E[E.PRODUCT=183]="PRODUCT",E[E.FACT=184]="FACT",E[E.GET_CELL=185]="GET_CELL",E[E.GET_WORKSPACE=186]="GET_WORKSPACE",E[E.GET_WINDOW=187]="GET_WINDOW",E[E.GET_DOCUMENT=188]="GET_DOCUMENT",E[E.DPRODUCT=189]="DPRODUCT",E[E.ISNONTEXT=190]="ISNONTEXT",E[E.GET_NOTE=191]="GET_NOTE",E[E.NOTE=192]="NOTE",E[E.STDEVP=193]="STDEVP",E[E.VARP=194]="VARP",E[E.DSTDEVP=195]="DSTDEVP",E[E.DVARP=196]="DVARP",E[E.TRUNC=197]="TRUNC",E[E.ISLOGICAL=198]="ISLOGICAL",E[E.DCOUNTA=199]="DCOUNTA",E[E.DELETE_BAR=200]="DELETE_BAR",E[E.UNREGISTER=201]="UNREGISTER",E[E.USDOLLAR=204]="USDOLLAR",E[E.FINDB=205]="FINDB",E[E.SEARCHB=206]="SEARCHB",E[E.REPLACEB=207]="REPLACEB",E[E.LEFTB=208]="LEFTB",E[E.RIGHTB=209]="RIGHTB",E[E.MIDB=210]="MIDB",E[E.LENB=211]="LENB",E[E.ROUNDUP=212]="ROUNDUP",E[E.ROUNDDOWN=213]="ROUNDDOWN",E[E.ASC=214]="ASC",E[E.DBCS=215]="DBCS",E[E.RANK=216]="RANK",E[E.ADDRESS=219]="ADDRESS",E[E.DAYS360=220]="DAYS360",E[E.TODAY=221]="TODAY",E[E.VDB=222]="VDB",E[E.ELSE=223]="ELSE",E[E.ELSE_IF=224]="ELSE_IF",E[E.END_IF=225]="END_IF",E[E.FOR_CELL=226]="FOR_CELL",E[E.MEDIAN=227]="MEDIAN",E[E.SUMPRODUCT=228]="SUMPRODUCT",E[E.SINH=229]="SINH",E[E.COSH=230]="COSH",E[E.TANH=231]="TANH",E[E.ASINH=232]="ASINH",E[E.ACOSH=233]="ACOSH",E[E.ATANH=234]="ATANH",E[E.DGET=235]="DGET",E[E.CREATE_OBJECT=236]="CREATE_OBJECT",E[E.VOLATILE=237]="VOLATILE",E[E.LAST_ERROR=238]="LAST_ERROR",E[E.CUSTOM_UNDO=239]="CUSTOM_UNDO",E[E.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",E[E.FORMULA_CONVERT=241]="FORMULA_CONVERT",E[E.GET_LINK_INFO=242]="GET_LINK_INFO",E[E.TEXT_BOX=243]="TEXT_BOX",E[E.INFO=244]="INFO",E[E.GROUP=245]="GROUP",E[E.GET_OBJECT=246]="GET_OBJECT",E[E.DB=247]="DB",E[E.PAUSE=248]="PAUSE",E[E.ERROR_CODE=249]="ERROR_CODE",E[E.ALLOC_COUNT=250]="ALLOC_COUNT",E[E.RESUME=251]="RESUME",E[E.FREQUENCY=252]="FREQUENCY",E[E.ADD_TOOLBAR=253]="ADD_TOOLBAR",E[E.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",E[E._UDF=255]="_UDF",E[E.RESET_TOOLBAR=256]="RESET_TOOLBAR",E[E.EVALUATE=257]="EVALUATE",E[E.GET_TOOLBAR=258]="GET_TOOLBAR",E[E.GET_TOOL=259]="GET_TOOL",E[E.SPELLING_CHECK=260]="SPELLING_CHECK",E[E.ERROR_TYPE=261]="ERROR_TYPE",E[E.APP_TITLE=262]="APP_TITLE",E[E.WINDOW_TITLE=263]="WINDOW_TITLE",E[E.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",E[E.ENABLE_TOOL=265]="ENABLE_TOOL",E[E.PRESS_TOOL=266]="PRESS_TOOL",E[E.REGISTER_ID=267]="REGISTER_ID",E[E.GET_PROJECT=268]="GET_PROJECT",E[E.AVEDEV=269]="AVEDEV",E[E.BETADIST=270]="BETADIST",E[E.GAMMALN=271]="GAMMALN",E[E.BETAINV=272]="BETAINV",E[E.BINOMDIST=273]="BINOMDIST",E[E.CHIDIST=274]="CHIDIST",E[E.CHIINV=275]="CHIINV",E[E.COMBIN=276]="COMBIN",E[E.CONFIDENCE=277]="CONFIDENCE",E[E.CRITBINOM=278]="CRITBINOM",E[E.EVEN=279]="EVEN",E[E.EXPONDIST=280]="EXPONDIST",E[E.FDIST=281]="FDIST",E[E.FINV=282]="FINV",E[E.FISHER=283]="FISHER",E[E.FISHERINV=284]="FISHERINV",E[E.FLOOR=285]="FLOOR",E[E.GAMMADIST=286]="GAMMADIST",E[E.GAMMAINV=287]="GAMMAINV",E[E.CEILING=288]="CEILING",E[E.HYPGEOMDIST=289]="HYPGEOMDIST",E[E.LOGNORMDIST=290]="LOGNORMDIST",E[E.LOGINV=291]="LOGINV",E[E.NEGBINOMDIST=292]="NEGBINOMDIST",E[E.NORMDIST=293]="NORMDIST",E[E.NORMSDIST=294]="NORMSDIST",E[E.NORMINV=295]="NORMINV",E[E.NORMSINV=296]="NORMSINV",E[E.STANDARDIZE=297]="STANDARDIZE",E[E.ODD=298]="ODD",E[E.PERMUT=299]="PERMUT",E[E.POISSON=300]="POISSON",E[E.TDIST=301]="TDIST",E[E.WEIBULL=302]="WEIBULL",E[E.SUMXMY2=303]="SUMXMY2",E[E.SUMX2MY2=304]="SUMX2MY2",E[E.SUMX2PY2=305]="SUMX2PY2",E[E.CHITEST=306]="CHITEST",E[E.CORREL=307]="CORREL",E[E.COVAR=308]="COVAR",E[E.FORECAST=309]="FORECAST",E[E.FTEST=310]="FTEST",E[E.INTERCEPT=311]="INTERCEPT",E[E.PEARSON=312]="PEARSON",E[E.RSQ=313]="RSQ",E[E.STEYX=314]="STEYX",E[E.SLOPE=315]="SLOPE",E[E.TTEST=316]="TTEST",E[E.PROB=317]="PROB",E[E.DEVSQ=318]="DEVSQ",E[E.GEOMEAN=319]="GEOMEAN",E[E.HARMEAN=320]="HARMEAN",E[E.SUMSQ=321]="SUMSQ",E[E.KURT=322]="KURT",E[E.SKEW=323]="SKEW",E[E.ZTEST=324]="ZTEST",E[E.LARGE=325]="LARGE",E[E.SMALL=326]="SMALL",E[E.QUARTILE=327]="QUARTILE",E[E.PERCENTILE=328]="PERCENTILE",E[E.PERCENTRANK=329]="PERCENTRANK",E[E.MODE=330]="MODE",E[E.TRIMMEAN=331]="TRIMMEAN",E[E.TINV=332]="TINV",E[E.MOVIE_COMMAND=334]="MOVIE_COMMAND",E[E.GET_MOVIE=335]="GET_MOVIE",E[E.CONCATENATE=336]="CONCATENATE",E[E.POWER=337]="POWER",E[E.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",E[E.GET_VIEW=339]="GET_VIEW",E[E.GET_FIELD=340]="GET_FIELD",E[E.GET_ITEM=341]="GET_ITEM",E[E.RADIANS=342]="RADIANS",E[E.DEGREES=343]="DEGREES",E[E.SUBTOTAL=344]="SUBTOTAL",E[E.SUMIF=345]="SUMIF",E[E.COUNTIF=346]="COUNTIF",E[E.COUNTBLANK=347]="COUNTBLANK",E[E.SCENARIO_GET=348]="SCENARIO_GET",E[E.OPTIONS_LISTS=349]="OPTIONS_LISTS",E[E.ISPMT=350]="ISPMT",E[E.DATEDIF=351]="DATEDIF",E[E.DATESTRING=352]="DATESTRING",E[E.NUMBERSTRING=353]="NUMBERSTRING",E[E.ROMAN=354]="ROMAN",E[E.OPENDIALOG=355]="OPENDIALOG",E[E.SAVEDIALOG=356]="SAVEDIALOG",E[E.VIEW_GET=357]="VIEW_GET",E[E.GETPIVOTDATA=358]="GETPIVOTDATA",E[E.HYPERLINK=359]="HYPERLINK",E[E.FURIGANA=360]="FURIGANA",E[E.AVERAGEA=361]="AVERAGEA",E[E.MAXA=362]="MAXA",E[E.MINA=363]="MINA",E[E.STDEVPA=364]="STDEVPA",E[E.VARPA=365]="VARPA",E[E.STDEVA=366]="STDEVA",E[E.VARA=367]="VARA",E[E.BAHTTEXT=368]="BAHTTEXT",E[E.THAIDOW=369]="THAIDOW",E[E.THAIDIGIT=370]="THAIDIGIT",E[E.THAIMOY=371]="THAIMOY",E[E.THAINUMSOUND=372]="THAINUMSOUND",E[E.THAINUMSTRING=373]="THAINUMSTRING",E[E.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",E[E.ISTHAIDIGIT=375]="ISTHAIDIGIT",E[E.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",E[E.ROUNDBAHTUP=377]="ROUNDBAHTUP",E[E.THAIYEAR=378]="THAIYEAR",E[E.RTD=379]="RTD",E[E.CUBEVALUE=380]="CUBEVALUE",E[E.CUBEMEMBER=381]="CUBEMEMBER",E[E.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",E[E.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",E[E.HEX2BIN=384]="HEX2BIN",E[E.HEX2DEC=385]="HEX2DEC",E[E.HEX2OCT=386]="HEX2OCT",E[E.DEC2BIN=387]="DEC2BIN",E[E.DEC2HEX=388]="DEC2HEX",E[E.DEC2OCT=389]="DEC2OCT",E[E.OCT2BIN=390]="OCT2BIN",E[E.OCT2HEX=391]="OCT2HEX",E[E.OCT2DEC=392]="OCT2DEC",E[E.BIN2DEC=393]="BIN2DEC",E[E.BIN2OCT=394]="BIN2OCT",E[E.BIN2HEX=395]="BIN2HEX",E[E.IMSUB=396]="IMSUB",E[E.IMDIV=397]="IMDIV",E[E.IMPOWER=398]="IMPOWER",E[E.IMABS=399]="IMABS",E[E.IMSQRT=400]="IMSQRT",E[E.IMLN=401]="IMLN",E[E.IMLOG2=402]="IMLOG2",E[E.IMLOG10=403]="IMLOG10",E[E.IMSIN=404]="IMSIN",E[E.IMCOS=405]="IMCOS",E[E.IMEXP=406]="IMEXP",E[E.IMARGUMENT=407]="IMARGUMENT",E[E.IMCONJUGATE=408]="IMCONJUGATE",E[E.IMAGINARY=409]="IMAGINARY",E[E.IMREAL=410]="IMREAL",E[E.COMPLEX=411]="COMPLEX",E[E.IMSUM=412]="IMSUM",E[E.IMPRODUCT=413]="IMPRODUCT",E[E.SERIESSUM=414]="SERIESSUM",E[E.FACTDOUBLE=415]="FACTDOUBLE",E[E.SQRTPI=416]="SQRTPI",E[E.QUOTIENT=417]="QUOTIENT",E[E.DELTA=418]="DELTA",E[E.GESTEP=419]="GESTEP",E[E.ISEVEN=420]="ISEVEN",E[E.ISODD=421]="ISODD",E[E.MROUND=422]="MROUND",E[E.ERF=423]="ERF",E[E.ERFC=424]="ERFC",E[E.BESSELJ=425]="BESSELJ",E[E.BESSELK=426]="BESSELK",E[E.BESSELY=427]="BESSELY",E[E.BESSELI=428]="BESSELI",E[E.XIRR=429]="XIRR",E[E.XNPV=430]="XNPV",E[E.PRICEMAT=431]="PRICEMAT",E[E.YIELDMAT=432]="YIELDMAT",E[E.INTRATE=433]="INTRATE",E[E.RECEIVED=434]="RECEIVED",E[E.DISC=435]="DISC",E[E.PRICEDISC=436]="PRICEDISC",E[E.YIELDDISC=437]="YIELDDISC",E[E.TBILLEQ=438]="TBILLEQ",E[E.TBILLPRICE=439]="TBILLPRICE",E[E.TBILLYIELD=440]="TBILLYIELD",E[E.PRICE=441]="PRICE",E[E.YIELD=442]="YIELD",E[E.DOLLARDE=443]="DOLLARDE",E[E.DOLLARFR=444]="DOLLARFR",E[E.NOMINAL=445]="NOMINAL",E[E.EFFECT=446]="EFFECT",E[E.CUMPRINC=447]="CUMPRINC",E[E.CUMIPMT=448]="CUMIPMT",E[E.EDATE=449]="EDATE",E[E.EOMONTH=450]="EOMONTH",E[E.YEARFRAC=451]="YEARFRAC",E[E.COUPDAYBS=452]="COUPDAYBS",E[E.COUPDAYS=453]="COUPDAYS",E[E.COUPDAYSNC=454]="COUPDAYSNC",E[E.COUPNCD=455]="COUPNCD",E[E.COUPNUM=456]="COUPNUM",E[E.COUPPCD=457]="COUPPCD",E[E.DURATION=458]="DURATION",E[E.MDURATION=459]="MDURATION",E[E.ODDLPRICE=460]="ODDLPRICE",E[E.ODDLYIELD=461]="ODDLYIELD",E[E.ODDFPRICE=462]="ODDFPRICE",E[E.ODDFYIELD=463]="ODDFYIELD",E[E.RANDBETWEEN=464]="RANDBETWEEN",E[E.WEEKNUM=465]="WEEKNUM",E[E.AMORDEGRC=466]="AMORDEGRC",E[E.AMORLINC=467]="AMORLINC",E[E.CONVERT=468]="CONVERT",E[E.ACCRINT=469]="ACCRINT",E[E.ACCRINTM=470]="ACCRINTM",E[E.WORKDAY=471]="WORKDAY",E[E.NETWORKDAYS=472]="NETWORKDAYS",E[E.GCD=473]="GCD",E[E.MULTINOMIAL=474]="MULTINOMIAL",E[E.LCM=475]="LCM",E[E.FVSCHEDULE=476]="FVSCHEDULE",E[E.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",E[E.CUBESET=478]="CUBESET",E[E.CUBESETCOUNT=479]="CUBESETCOUNT",E[E.IFERROR=480]="IFERROR",E[E.COUNTIFS=481]="COUNTIFS",E[E.SUMIFS=482]="SUMIFS",E[E.AVERAGEIF=483]="AVERAGEIF",E[E.AVERAGEIFS=484]="AVERAGEIFS",E[E.AGGREGATE=485]="AGGREGATE",E[E.BINOM_DIST=486]="BINOM_DIST",E[E.BINOM_INV=487]="BINOM_INV",E[E.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",E[E.CONFIDENCE_T=489]="CONFIDENCE_T",E[E.CHISQ_TEST=490]="CHISQ_TEST",E[E.F_TEST=491]="F_TEST",E[E.COVARIANCE_P=492]="COVARIANCE_P",E[E.COVARIANCE_S=493]="COVARIANCE_S",E[E.EXPON_DIST=494]="EXPON_DIST",E[E.GAMMA_DIST=495]="GAMMA_DIST",E[E.GAMMA_INV=496]="GAMMA_INV",E[E.MODE_MULT=497]="MODE_MULT",E[E.MODE_SNGL=498]="MODE_SNGL",E[E.NORM_DIST=499]="NORM_DIST",E[E.NORM_INV=500]="NORM_INV",E[E.PERCENTILE_EXC=501]="PERCENTILE_EXC",E[E.PERCENTILE_INC=502]="PERCENTILE_INC",E[E.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",E[E.PERCENTRANK_INC=504]="PERCENTRANK_INC",E[E.POISSON_DIST=505]="POISSON_DIST",E[E.QUARTILE_EXC=506]="QUARTILE_EXC",E[E.QUARTILE_INC=507]="QUARTILE_INC",E[E.RANK_AVG=508]="RANK_AVG",E[E.RANK_EQ=509]="RANK_EQ",E[E.STDEV_S=510]="STDEV_S",E[E.STDEV_P=511]="STDEV_P",E[E.T_DIST=512]="T_DIST",E[E.T_DIST_2T=513]="T_DIST_2T",E[E.T_DIST_RT=514]="T_DIST_RT",E[E.T_INV=515]="T_INV",E[E.T_INV_2T=516]="T_INV_2T",E[E.VAR_S=517]="VAR_S",E[E.VAR_P=518]="VAR_P",E[E.WEIBULL_DIST=519]="WEIBULL_DIST",E[E.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",E[E.WORKDAY_INTL=521]="WORKDAY_INTL",E[E.ECMA_CEILING=522]="ECMA_CEILING",E[E.ISO_CEILING=523]="ISO_CEILING",E[E.DEBUG=524]="DEBUG",E[E.BETA_DIST=525]="BETA_DIST",E[E.BETA_INV=526]="BETA_INV",E[E.CHISQ_DIST=527]="CHISQ_DIST",E[E.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",E[E.CHISQ_INV=529]="CHISQ_INV",E[E.CHISQ_INV_RT=530]="CHISQ_INV_RT",E[E.F_DIST=531]="F_DIST",E[E.F_DIST_RT=532]="F_DIST_RT",E[E.F_INV=533]="F_INV",E[E.F_INV_RT=534]="F_INV_RT",E[E.HYPGEOM_DIST=535]="HYPGEOM_DIST",E[E.LOGNORM_DIST=536]="LOGNORM_DIST",E[E.LOGNORM_INV=537]="LOGNORM_INV",E[E.NEGBINOM_DIST=538]="NEGBINOM_DIST",E[E.NORM_S_DIST=539]="NORM_S_DIST",E[E.NORM_S_INV=540]="NORM_S_INV",E[E.T_TEST=541]="T_TEST",E[E.Z_TEST=542]="Z_TEST",E[E.ERF_PRECISE=543]="ERF_PRECISE",E[E.ERFC_PRECISE=544]="ERFC_PRECISE",E[E.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",E[E.CEILING_PRECISE=546]="CEILING_PRECISE",E[E.FLOOR_PRECISE=547]="FLOOR_PRECISE",E[E.ACOT=548]="ACOT",E[E.ACOTH=549]="ACOTH",E[E.COT=550]="COT",E[E.COTH=551]="COTH",E[E.CSC=552]="CSC",E[E.CSCH=553]="CSCH",E[E.SEC=554]="SEC",E[E.SECH=555]="SECH",E[E.IMTAN=556]="IMTAN",E[E.IMCOT=557]="IMCOT",E[E.IMCSC=558]="IMCSC",E[E.IMCSCH=559]="IMCSCH",E[E.IMSEC=560]="IMSEC",E[E.IMSECH=561]="IMSECH",E[E.BITAND=562]="BITAND",E[E.BITOR=563]="BITOR",E[E.BITXOR=564]="BITXOR",E[E.BITLSHIFT=565]="BITLSHIFT",E[E.BITRSHIFT=566]="BITRSHIFT",E[E.PERMUTATIONA=567]="PERMUTATIONA",E[E.COMBINA=568]="COMBINA",E[E.XOR=569]="XOR",E[E.PDURATION=570]="PDURATION",E[E.BASE=571]="BASE",E[E.DECIMAL=572]="DECIMAL",E[E.DAYS=573]="DAYS",E[E.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",E[E.GAMMA=575]="GAMMA",E[E.SKEW_P=576]="SKEW_P",E[E.GAUSS=577]="GAUSS",E[E.PHI=578]="PHI",E[E.RRI=579]="RRI",E[E.UNICHAR=580]="UNICHAR",E[E.UNICODE=581]="UNICODE",E[E.MUNIT=582]="MUNIT",E[E.ARABIC=583]="ARABIC",E[E.ISOWEEKNUM=584]="ISOWEEKNUM",E[E.NUMBERVALUE=585]="NUMBERVALUE",E[E.SHEET=586]="SHEET",E[E.SHEETS=587]="SHEETS",E[E.FORMULATEXT=588]="FORMULATEXT",E[E.ISFORMULA=589]="ISFORMULA",E[E.IFNA=590]="IFNA",E[E.CEILING_MATH=591]="CEILING_MATH",E[E.FLOOR_MATH=592]="FLOOR_MATH",E[E.IMSINH=593]="IMSINH",E[E.IMCOSH=594]="IMCOSH",E[E.FILTERXML=595]="FILTERXML",E[E.WEBSERVICE=596]="WEBSERVICE",E[E.ENCODEURL=597]="ENCODEURL",E[E.FORECAST_ETS=598]="FORECAST_ETS",E[E.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",E[E.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",E[E.FORECAST_LINEAR=601]="FORECAST_LINEAR",E[E.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",E[E.MAXIFS=603]="MAXIFS",E[E.MINIFS=604]="MINIFS",E[E.TEXTJOIN=605]="TEXTJOIN",E[E.CONCAT=606]="CONCAT",E[E.IFS=607]="IFS",E[E.SWITCH=608]="SWITCH",E[E.SINGLE=609]="SINGLE",E[E.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",E[E.ANCHORARRAY=611]="ANCHORARRAY",E[E.IMAGE=612]="IMAGE",E[E.RECORD=613]="RECORD",E[E.GRF=614]="GRF",E[E.UNIT=615]="UNIT",E[E.RICHERROR=616]="RICHERROR",E[E.FILTER=617]="FILTER",E[E.FUN=618]="FUN",E[E.LET=619]="LET",E[E.ARRAYMAKE=620]="ARRAYMAKE",E[E.APPLY=621]="APPLY",E[E.ISFUN=622]="ISFUN",E[E.ARITY=623]="ARITY",E[E.RECURSE=624]="RECURSE"}($E||($E={}));var sE=[];sE[$E.COUNT]=p(1,[],[57],1,0,0),sE[$E.IF]=p(1,[36,575,575],[],567,0,0),sE[$E.ISNA]=p(1,[15],[],4,0,0),sE[$E.ISERROR]=p(1,[15],[],4,0,0),sE[$E.SUM]=p(1,[],[49],1,0,0),sE[$E.AVERAGE]=p(1,[],[49],1,0,0),sE[$E.MIN]=p(1,[],[49],1,0,0),sE[$E.MAX]=p(1,[],[49],1,0,0),sE[$E.ROW]=p(0,[16],[],33,0,0),sE[$E.COLUMN]=p(0,[16],[],33,0,0),sE[$E.NA]=p(0,[],[],3,0,0),sE[$E.NPV]=p(2,[1],[49],1,0,0),sE[$E.STDEV]=p(1,[],[49],1,0,0),sE[$E.DOLLAR]=p(1,[1,1],[],2,0,0),sE[$E.FIXED]=p(1,[1,65,4],[],2,0,0),sE[$E.SIN]=p(1,[1],[],1,0,0),sE[$E.COS]=p(1,[1],[],1,0,0),sE[$E.TAN]=p(1,[1],[],1,0,0),sE[$E.ATAN]=p(1,[1],[],1,0,0),sE[$E.PI]=p(0,[],[],1,0,0),sE[$E.SQRT]=p(1,[1],[],1,0,0),sE[$E.EXP]=p(1,[1],[],1,0,0),sE[$E.LN]=p(1,[1],[],1,0,0),sE[$E.LOG10]=p(1,[1],[],1,0,0),sE[$E.ABS]=p(1,[1],[],1,0,0),sE[$E.INT]=p(1,[1],[],1,0,0),sE[$E.SIGN]=p(1,[1],[],1,0,0),sE[$E.ROUND]=p(2,[1,1],[],1,0,0),sE[$E.LOOKUP]=p(2,[7,48,48],[],7,0,0),sE[$E.INDEX]=p(2,[48,1,1,1],[],55,0,0),sE[$E.REPT]=p(2,[2,1],[],2,0,0),sE[$E.MID]=p(3,[2,1,1],[],2,0,0),sE[$E.LEN]=p(1,[2],[],1,0,0),sE[$E.VALUE]=p(1,[7],[],1,0,0),sE[$E.TRUE]=p(0,[],[],4,0,0),sE[$E.FALSE]=p(0,[],[],4,0,0),sE[$E.AND]=p(1,[],[52],4,0,0),sE[$E.OR]=p(1,[],[52],4,0,0),sE[$E.NOT]=p(1,[4],[],4,0,0),sE[$E.MOD]=p(2,[1,1],[],1,0,0),sE[$E.DCOUNT]=p(3,[16,83,18],[],1,0,0),sE[$E.DSUM]=p(3,[16,19,18],[],1,0,0),sE[$E.DAVERAGE]=p(3,[16,19,18],[],1,0,0),sE[$E.DMIN]=p(3,[16,19,18],[],1,0,0),sE[$E.DMAX]=p(3,[16,19,18],[],1,0,0),sE[$E.DSTDEV]=p(3,[16,19,18],[],1,0,0),sE[$E.VAR]=p(1,[],[49],1,0,0),sE[$E.DVAR]=p(3,[16,19,18],[],1,0,0),sE[$E.TEXT]=p(2,[7,2],[],2,0,0),sE[$E.LINEST]=p(1,[48,112,84,84],[],32,0,0),sE[$E.TREND]=p(1,[48,112,112,84],[],32,0,0),sE[$E.LOGEST]=p(1,[48,112,84,84],[],32,0,0),sE[$E.GROWTH]=p(1,[48,112,112,84],[],32,0,0),sE[$E.GOTO]=p(1,[16],[],512,0,2),sE[$E.HALT]=p(0,[4],[],512,0,2),sE[$E.RETURN]=p(0,[575],[],512,0,2),sE[$E.PV]=p(3,[1,1,1,1,1],[],1,0,0),sE[$E.FV]=p(3,[1,1,1,1,1],[],1,0,0),sE[$E.NPER]=p(3,[1,1,1,1,1],[],1,0,0),sE[$E.PMT]=p(3,[1,1,1,1,1],[],1,0,0),sE[$E.RATE]=p(3,[1,1,1,1,1,1],[],1,0,0),sE[$E.MIRR]=p(3,[48,1,1],[],1,0,0),sE[$E.IRR]=p(1,[48,1],[],1,0,0),sE[$E.RAND]=p(0,[],[],1,4095,0),sE[$E.MATCH]=p(2,[7,49,17],[],1,0,0),sE[$E.DATE]=p(3,[1,1,1],[],1,0,0),sE[$E.TIME]=p(3,[1,1,1],[],1,0,0),sE[$E.DAY]=p(1,[1],[],1,0,0),sE[$E.MONTH]=p(1,[1],[],1,0,0),sE[$E.YEAR]=p(1,[1],[],1,0,0),sE[$E.WEEKDAY]=p(1,[1,1],[],1,0,0),sE[$E.HOUR]=p(1,[1],[],1,0,0),sE[$E.MINUTE]=p(1,[1],[],1,0,0),sE[$E.SECOND]=p(1,[1],[],1,0,0),sE[$E.NOW]=p(0,[],[],1,4095,0),sE[$E.AREAS]=p(1,[16],[],1,0,0),sE[$E.ROWS]=p(1,[48],[],1,0,0),sE[$E.COLUMNS]=p(1,[48],[],1,0,0),sE[$E.OFFSET]=p(3,[16,65,65,65,65],[],16,4095,0),sE[$E.ABSREF]=p(2,[2,16],[],16,0,2),sE[$E.RELREF]=p(2,[16,16],[],2,0,2),sE[$E.ARGUMENT]=p(0,[66,81,16],[],4,0,2),sE[$E.SEARCH]=p(2,[2,2,1],[],1,0,0),sE[$E.TRANSPOSE]=p(1,[39],[],32,0,0),sE[$E.ERROR]=p(0,[1,24],[],4,0,2),sE[$E.STEP]=p(0,[],[],4,0,2),sE[$E.TYPE]=p(1,[47],[],1,0,0),sE[$E.ECHO]=p(0,[4],[],4,0,2),sE[$E.SET_NAME]=p(1,[2,63],[],4,0,2),sE[$E.CALLER]=p(0,[],[],50,0,2),sE[$E.DEREF]=p(1,[16],[],47,0,2),sE[$E.WINDOWS]=p(0,[65,66],[],32,0,2),sE[$E.SERIES]=p(4,[87,117,117,1,117],[],4,0,0),sE[$E.DOCUMENTS]=p(0,[1,66],[],32,0,2),sE[$E.ACTIVE_CELL]=p(0,[],[],16,0,2),sE[$E.SELECTION]=p(0,[],[],16,0,2),sE[$E.RESULT]=p(0,[1],[],4,0,2),sE[$E.ATAN2]=p(2,[1,1],[],1,0,0),sE[$E.ASIN]=p(1,[1],[],1,0,0),sE[$E.ACOS]=p(1,[1],[],1,0,0),sE[$E.CHOOSE]=p(2,[33],[575],567,0,0),sE[$E.HLOOKUP]=p(3,[7,49,49,4],[],39,0,0),sE[$E.VLOOKUP]=p(3,[7,49,49,4],[],39,0,0),sE[$E.LINKS]=p(0,[66,65],[],32,0,2),sE[$E.INPUT]=p(1,[2,65,66,67,65,65,2],[],575,0,2),sE[$E.ISREF]=p(1,[63],[],4,0,0),sE[$E.GET_FORMULA]=p(1,[18],[],2,0,2),sE[$E.GET_NAME]=p(1,[2,4],[],6,0,2),sE[$E.SET_VALUE]=p(2,[16,47],[],4,0,2),sE[$E.LOG]=p(1,[1,1],[],1,0,0),sE[$E.EXEC]=p(1,[2,1,4,4],[],7,0,2),sE[$E.CHAR]=p(1,[1],[],2,0,0),sE[$E.LOWER]=p(1,[2],[],2,0,0),sE[$E.UPPER]=p(1,[2],[],2,0,0),sE[$E.PROPER]=p(1,[2],[],2,0,0),sE[$E.LEFT]=p(1,[2,9],[],2,0,0),sE[$E.RIGHT]=p(1,[2,9],[],2,0,0),sE[$E.EXACT]=p(2,[2,2],[],4,0,0),sE[$E.TRIM]=p(1,[2],[],2,0,0),sE[$E.REPLACE]=p(4,[2,1,1,2],[],2,0,0),sE[$E.SUBSTITUTE]=p(3,[2,2,2,2],[],2,0,0),sE[$E.CODE]=p(1,[2],[],1,0,0),sE[$E.NAMES]=p(0,[66,65,66],[],32,0,2),sE[$E.DIRECTORY]=p(0,[2],[],2,0,2),sE[$E.FIND]=p(2,[2,2,1],[],1,0,0),sE[$E.CELL]=p(1,[2,16],[],47,4095,0),sE[$E.ISERR]=p(1,[15],[],4,0,0),sE[$E.ISTEXT]=p(1,[143],[],4,0,0),sE[$E.ISNUMBER]=p(1,[143],[],4,0,0),sE[$E.ISBLANK]=p(1,[143],[],4,0,0),sE[$E.T]=p(1,[23],[],2,0,0),sE[$E.N]=p(1,[23],[],1,0,0),sE[$E.FOPEN]=p(1,[2,1],[],1,0,2),sE[$E.FCLOSE]=p(1,[1],[],1,0,2),sE[$E.FSIZE]=p(1,[1],[],1,0,2),sE[$E.FREADLN]=p(1,[1],[],2,0,2),sE[$E.FREAD]=p(2,[1,1],[],2,0,2),sE[$E.FWRITELN]=p(2,[1,2],[],1,0,2),sE[$E.FWRITE]=p(2,[1,2],[],1,0,2),sE[$E.FPOS]=p(1,[1,1],[],1,0,2),sE[$E.DATEVALUE]=p(1,[3],[],1,0,0),sE[$E.TIMEVALUE]=p(1,[3],[],1,0,0),sE[$E.SLN]=p(3,[1,1,1],[],1,0,0),sE[$E.SYD]=p(4,[1,1,1,1],[],1,0,0),sE[$E.DDB]=p(4,[1,1,1,1,1],[],1,0,0),sE[$E.GET_DEF]=p(1,[2,66,65],[],2,0,2),sE[$E.REFTEXT]=p(1,[16,4],[],2,0,2),sE[$E.TEXTREF]=p(1,[2,4],[],16,0,2),sE[$E.INDIRECT]=p(1,[2,4],[],16,4095,0),sE[$E.REGISTER]=p(1,[2,3,66,66,66,65,67,66,67],[66],3,0,2),sE[$E.CALL]=p(1,[3],[127],575,0,2),sE[$E.ADD_BAR]=p(0,[3],[],1,0,2),sE[$E.ADD_MENU]=p(2,[3,115,83,3],[],1,0,2),sE[$E.ADD_COMMAND]=p(3,[3,83,115,83,3],[],1,0,2),sE[$E.ENABLE_COMMAND]=p(4,[3,3,3,4,3],[],4,0,2),sE[$E.CHECK_COMMAND]=p(4,[3,3,3,4,3],[],4,0,2),sE[$E.RENAME_COMMAND]=p(4,[3,3,3,3,3],[],4,0,2),sE[$E.SHOW_BAR]=p(0,[3],[],4,0,2),sE[$E.DELETE_MENU]=p(2,[3,3,3],[],4,0,2),sE[$E.DELETE_COMMAND]=p(3,[3,3,3,3],[],4,0,2),sE[$E.GET_CHART_ITEM]=p(1,[1,67,66],[],1,0,2),sE[$E.DIALOG_BOX]=p(1,[52],[],36,0,2),sE[$E.CLEAN]=p(1,[2],[],2,0,0),sE[$E.MDETERM]=p(1,[32],[],1,0,0),sE[$E.MINVERSE]=p(1,[32],[],32,0,0),sE[$E.MMULT]=p(2,[32,32],[],32,0,0),sE[$E.FILES]=p(0,[2,2],[],32,0,2),sE[$E.IPMT]=p(4,[1,1,1,1,1,1],[],1,0,0),sE[$E.PPMT]=p(4,[1,1,1,1,1,1],[],1,0,0),sE[$E.COUNTA]=p(1,[],[121],1,0,0),sE[$E.CANCEL_KEY]=p(0,[1,16],[],4,0,2),sE[$E.FOR]=p(3,[2,1,1,1],[],512,0,2),sE[$E.WHILE]=p(1,[4],[],512,0,2),sE[$E.BREAK]=p(0,[],[],512,0,2),sE[$E.NEXT]=p(0,[],[],512,0,2),sE[$E.INITIATE]=p(2,[2,2],[],1,0,2),sE[$E.REQUEST]=p(2,[1,2],[],32,0,2),sE[$E.POKE]=p(3,[1,18,18],[],4,0,2),sE[$E.EXECUTE]=p(2,[1,2],[],4,0,2),sE[$E.TERMINATE]=p(1,[1],[],4,0,2),sE[$E.RESTART]=p(0,[1],[],512,0,2),sE[$E.HELP]=p(0,[2],[],4,0,2),sE[$E.GET_BAR]=p(0,[3,3,3,3],[],3,0,2),sE[$E.PRODUCT]=p(1,[],[113],1,0,0),sE[$E.FACT]=p(1,[1],[],1,0,0),sE[$E.GET_CELL]=p(1,[1,16],[],47,0,2),sE[$E.GET_WORKSPACE]=p(1,[1],[],47,0,2),sE[$E.GET_WINDOW]=p(1,[1,2],[],47,0,2),sE[$E.GET_DOCUMENT]=p(1,[1,2],[],63,0,2),sE[$E.DPRODUCT]=p(3,[16,19,18],[],1,0,0),sE[$E.ISNONTEXT]=p(1,[143],[],4,0,0),sE[$E.GET_NOTE]=p(0,[82,65,65],[],2,0,2),sE[$E.NOTE]=p(0,[66,82,17,17],[],1,0,2),sE[$E.STDEVP]=p(1,[],[49],1,0,0),sE[$E.VARP]=p(1,[],[49],1,0,0),sE[$E.DSTDEVP]=p(3,[16,19,18],[],1,0,0),sE[$E.DVARP]=p(3,[16,19,18],[],1,0,0),sE[$E.TRUNC]=p(1,[1,1],[],1,0,0),sE[$E.ISLOGICAL]=p(1,[143],[],4,0,0),sE[$E.DCOUNTA]=p(3,[16,83,18],[],1,0,0),sE[$E.DELETE_BAR]=p(1,[3],[],4,0,2),sE[$E.UNREGISTER]=p(1,[3],[],4,0,2),sE[$E.USDOLLAR]=p(1,[1,1],[],2,0,0),sE[$E.FINDB]=p(2,[2,2,1],[],1,0,0),sE[$E.SEARCHB]=p(2,[2,2,1],[],1,0,0),sE[$E.REPLACEB]=p(4,[2,1,1,2],[],2,0,0),sE[$E.LEFTB]=p(1,[2,9],[],2,0,0),sE[$E.RIGHTB]=p(1,[2,9],[],2,0,0),sE[$E.MIDB]=p(3,[2,1,1],[],2,0,0),sE[$E.LENB]=p(1,[2],[],1,0,0),sE[$E.ROUNDUP]=p(2,[1,1],[],1,0,0),sE[$E.ROUNDDOWN]=p(2,[1,1],[],1,0,0),sE[$E.ASC]=p(1,[2],[],2,0,0),sE[$E.DBCS]=p(1,[2],[],2,0,0),sE[$E.RANK]=p(2,[1,16,4],[],1,0,0),sE[$E.ADDRESS]=p(2,[1,65,65,68,66],[],2,0,0),sE[$E.DAYS360]=p(2,[1,1,4],[],1,0,0),sE[$E.TODAY]=p(0,[],[],1,4095,0),sE[$E.VDB]=p(5,[1,1,1,1,1,1,4],[],1,0,0),sE[$E.ELSE]=p(0,[],[],512,0,2),sE[$E.ELSE_IF]=p(1,[12],[],512,0,2),sE[$E.END_IF]=p(0,[],[],512,0,2),sE[$E.FOR_CELL]=p(1,[2,82,84],[],512,0,2),sE[$E.MEDIAN]=p(1,[],[49],1,0,0),sE[$E.SUMPRODUCT]=p(1,[],[32],1,0,0),sE[$E.SINH]=p(1,[1],[],1,0,0),sE[$E.COSH]=p(1,[1],[],1,0,0),sE[$E.TANH]=p(1,[1],[],1,0,0),sE[$E.ASINH]=p(1,[1],[],1,0,0),sE[$E.ACOSH]=p(1,[1],[],1,0,0),sE[$E.ATANH]=p(1,[1],[],1,0,0),sE[$E.DGET]=p(3,[16,19,18],[],7,0,0),sE[$E.CREATE_OBJECT]=p(2,[1,18,17,17,18,17,17,115,84,21,17],[],2,0,2),sE[$E.VOLATILE]=p(0,[4],[],4,0,2),sE[$E.LAST_ERROR]=p(0,[],[],16,0,2),sE[$E.CUSTOM_UNDO]=p(0,[2,2],[],4,0,2),sE[$E.CUSTOM_REPEAT]=p(0,[2,2,2],[],4,0,2),sE[$E.FORMULA_CONVERT]=p(2,[2,23,23,23,23],[],2,0,2),sE[$E.GET_LINK_INFO]=p(2,[2,1,1,2],[],1,0,2),sE[$E.TEXT_BOX]=p(1,[2,66,65,65],[],1,0,2),sE[$E.INFO]=p(1,[2],[],3,4095,0),sE[$E.GROUP]=p(0,[],[],2,0,2),sE[$E.GET_OBJECT]=p(1,[1,2,1,1,1],[],47,0,2),sE[$E.DB]=p(4,[1,1,1,1,1],[],1,0,0),sE[$E.PAUSE]=p(0,[4],[],512,0,2),sE[$E.ERROR_CODE]=p(0,[],[],2,0,2),sE[$E.ALLOC_COUNT]=p(0,[],[],1,0,2),sE[$E.RESUME]=p(0,[1],[],512,0,2),sE[$E.FREQUENCY]=p(2,[48,48],[],32,0,0),sE[$E.ADD_TOOLBAR]=p(0,[66,96],[],2,0,2),sE[$E.DELETE_TOOLBAR]=p(1,[2],[],4,0,2),sE[$E._UDF]=p(1,[17],[127],575,0,0),sE[$E.RESET_TOOLBAR]=p(1,[3],[],4,0,2),sE[$E.EVALUATE]=p(1,[2],[],63,0,2),sE[$E.GET_TOOLBAR]=p(1,[1,3],[],47,0,2),sE[$E.GET_TOOL]=p(1,[1,3,1],[],47,0,2),sE[$E.SPELLING_CHECK]=p(1,[2,66,4],[],4,0,2),sE[$E.ERROR_TYPE]=p(1,[15],[],1,0,0),sE[$E.APP_TITLE]=p(0,[2],[],4,0,2),sE[$E.WINDOW_TITLE]=p(0,[2],[],4,0,2),sE[$E.SAVE_TOOLBAR]=p(0,[99,66],[],4,0,2),sE[$E.ENABLE_TOOL]=p(3,[3,1,4],[],4,0,2),sE[$E.PRESS_TOOL]=p(3,[3,1,4],[],4,0,2),sE[$E.REGISTER_ID]=p(2,[2,3,66],[],1,0,2),sE[$E.GET_PROJECT]=p(1,[1,2],[],35,0,2),sE[$E.AVEDEV]=p(1,[],[49],1,0,0),sE[$E.BETADIST]=p(3,[1,1,1,65,65],[],1,0,0),sE[$E.GAMMALN]=p(1,[1],[],1,0,0),sE[$E.BETAINV]=p(3,[1,1,1,65,65],[],1,0,0),sE[$E.BINOMDIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.CHIDIST]=p(2,[1,1],[],1,0,0),sE[$E.CHIINV]=p(2,[1,1],[],1,0,0),sE[$E.COMBIN]=p(2,[1,1],[],1,0,0),sE[$E.CONFIDENCE]=p(3,[1,1,1],[],1,0,0),sE[$E.CRITBINOM]=p(3,[1,1,1],[],1,0,0),sE[$E.EVEN]=p(1,[1],[],1,0,0),sE[$E.EXPONDIST]=p(3,[1,1,4],[],1,0,0),sE[$E.FDIST]=p(3,[1,1,1],[],1,0,0),sE[$E.FINV]=p(3,[1,1,1],[],1,0,0),sE[$E.FISHER]=p(1,[1],[],1,0,0),sE[$E.FISHERINV]=p(1,[1],[],1,0,0),sE[$E.FLOOR]=p(2,[1,1],[],1,0,0),sE[$E.GAMMADIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.GAMMAINV]=p(3,[1,1,1],[],1,0,0),sE[$E.CEILING]=p(2,[1,1],[],1,0,0),sE[$E.HYPGEOMDIST]=p(4,[1,1,1,1],[],1,0,0),sE[$E.LOGNORMDIST]=p(3,[1,1,1],[],1,0,0),sE[$E.LOGINV]=p(3,[1,1,1],[],1,0,0),sE[$E.NEGBINOMDIST]=p(3,[1,1,1],[],1,0,0),sE[$E.NORMDIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.NORMSDIST]=p(1,[1],[],1,0,0),sE[$E.NORMINV]=p(3,[1,1,1],[],1,0,0),sE[$E.NORMSINV]=p(1,[1],[],1,0,0),sE[$E.STANDARDIZE]=p(3,[1,1,1],[],1,0,0),sE[$E.ODD]=p(1,[1],[],1,0,0),sE[$E.PERMUT]=p(2,[1,1],[],1,0,0),sE[$E.POISSON]=p(3,[1,1,4],[],1,0,0),sE[$E.TDIST]=p(3,[1,1,1],[],1,0,0),sE[$E.WEIBULL]=p(4,[1,1,1,4],[],1,0,0),sE[$E.SUMXMY2]=p(2,[32,32],[],1,0,0),sE[$E.SUMX2MY2]=p(2,[32,32],[],1,0,0),sE[$E.SUMX2PY2]=p(2,[32,32],[],1,0,0),sE[$E.CHITEST]=p(2,[32,32],[],1,0,0),sE[$E.CORREL]=p(2,[32,32],[],1,0,0),sE[$E.COVAR]=p(2,[32,32],[],1,0,0),sE[$E.FORECAST]=p(3,[1,32,32],[],1,0,0),sE[$E.FTEST]=p(2,[32,32],[],1,0,0),sE[$E.INTERCEPT]=p(2,[32,32],[],1,0,0),sE[$E.PEARSON]=p(2,[32,32],[],1,0,0),sE[$E.RSQ]=p(2,[32,32],[],1,0,0),sE[$E.STEYX]=p(2,[32,32],[],1,0,0),sE[$E.SLOPE]=p(2,[32,32],[],1,0,0),sE[$E.TTEST]=p(4,[32,32,1,1],[],1,0,0),sE[$E.PROB]=p(3,[32,32,1,65],[],1,0,0),sE[$E.DEVSQ]=p(1,[],[49],1,0,0),sE[$E.GEOMEAN]=p(1,[],[49],1,0,0),sE[$E.HARMEAN]=p(1,[],[49],1,0,0),sE[$E.SUMSQ]=p(1,[],[49],1,0,0),sE[$E.KURT]=p(1,[],[49],1,0,0),sE[$E.SKEW]=p(1,[],[49],1,0,0),sE[$E.ZTEST]=p(2,[49,1,1],[],1,0,0),sE[$E.LARGE]=p(2,[49,1],[],1,0,0),sE[$E.SMALL]=p(2,[49,1],[],1,0,0),sE[$E.QUARTILE]=p(2,[49,1],[],1,0,0),sE[$E.PERCENTILE]=p(2,[49,1],[],1,0,0),sE[$E.PERCENTRANK]=p(2,[49,1,65],[],1,0,0),sE[$E.MODE]=p(1,[],[32],1,0,0),sE[$E.TRIMMEAN]=p(2,[49,1],[],1,0,0),sE[$E.TINV]=p(2,[1,1],[],1,0,0),sE[$E.MOVIE_COMMAND]=p(3,[2,1,1,1],[],1,0,2),sE[$E.GET_MOVIE]=p(2,[2,1,1],[],1,0,2),sE[$E.CONCATENATE]=p(1,[],[2],2,0,0),sE[$E.POWER]=p(2,[1,1],[],1,0,0),sE[$E.SPREADBASE_DATA_FIELD]=p(2,[66,2,66,65,65,65,66,66,66],[],2,0,2),sE[$E.GET_VIEW]=p(1,[1,2],[],35,0,2),sE[$E.GET_FIELD]=p(1,[1,66,2],[],35,0,2),sE[$E.GET_ITEM]=p(1,[1,66,66,2],[],7,0,2),sE[$E.RADIANS]=p(1,[1],[],1,0,0),sE[$E.DEGREES]=p(1,[1],[],1,0,0),sE[$E.SUBTOTAL]=p(2,[1],[16],1,0,0),sE[$E.SUMIF]=p(2,[16,15,16],[],1,0,0),sE[$E.COUNTIF]=p(2,[16,15],[],1,0,0),sE[$E.COUNTBLANK]=p(1,[16],[],1,0,0),sE[$E.SCENARIO_GET]=p(1,[1,2],[],19,0,2),sE[$E.OPTIONS_LISTS]=p(1,[33],[],33,0,2),sE[$E.ISPMT]=p(4,[1,1,1,1],[],1,0,0),sE[$E.DATEDIF]=p(3,[1,1,2],[],1,0,0),sE[$E.DATESTRING]=p(1,[1],[],2,0,0),sE[$E.NUMBERSTRING]=p(2,[1,1],[],2,0,0),sE[$E.ROMAN]=p(1,[1,5],[],2,0,0),sE[$E.OPENDIALOG]=p(0,[66,66,66,65],[],6,0,2),sE[$E.SAVEDIALOG]=p(0,[66,66,66,66,65],[],6,0,2),sE[$E.VIEW_GET]=p(1,[1,2],[],19,0,2),sE[$E.GETPIVOTDATA]=p(2,[18,18],[2,79],15,0,0),sE[$E.HYPERLINK]=p(1,[2,39],[],39,0,0),sE[$E.FURIGANA]=p(1,[16],[],2,0,0),sE[$E.AVERAGEA]=p(1,[],[49],1,0,0),sE[$E.MAXA]=p(1,[],[49],1,0,0),sE[$E.MINA]=p(1,[],[49],1,0,0),sE[$E.STDEVPA]=p(1,[],[49],1,0,0),sE[$E.VARPA]=p(1,[],[49],1,0,0),sE[$E.STDEVA]=p(1,[],[49],1,0,0),sE[$E.VARA]=p(1,[],[49],1,0,0),sE[$E.BAHTTEXT]=p(1,[1],[],2,0,0),sE[$E.THAIDOW]=p(1,[1],[],2,0,0),sE[$E.THAIDIGIT]=p(1,[3],[],2,0,0),sE[$E.THAIMOY]=p(1,[1],[],2,0,0),sE[$E.THAINUMSOUND]=p(1,[1],[],2,0,0),sE[$E.THAINUMSTRING]=p(1,[1],[],2,0,0),sE[$E.THAISTRINGLENGTH]=p(1,[2],[],1,0,0),sE[$E.ISTHAIDIGIT]=p(1,[2],[],4,0,0),sE[$E.ROUNDBAHTDOWN]=p(1,[1],[],1,0,0),sE[$E.ROUNDBAHTUP]=p(1,[1],[],1,0,0),sE[$E.THAIYEAR]=p(1,[1],[],1,0,0),sE[$E.RTD]=p(3,[],[2],2,0,0),sE[$E.CUBEVALUE]=p(1,[2],[50],15,0,0),sE[$E.CUBEMEMBER]=p(2,[2,50,2],[],10,0,0),sE[$E.CUBEMEMBERPROPERTY]=p(3,[2,2,2],[],15,0,0),sE[$E.CUBERANKEDMEMBER]=p(3,[2,2,1,2],[],10,0,0),sE[$E.HEX2BIN]=p(1,[95,95],[],9,0,0),sE[$E.HEX2DEC]=p(1,[95],[],9,0,0),sE[$E.HEX2OCT]=p(1,[95,95],[],9,0,0),sE[$E.DEC2BIN]=p(1,[95,95],[],9,0,0),sE[$E.DEC2HEX]=p(1,[95,95],[],9,0,0),sE[$E.DEC2OCT]=p(1,[95,95],[],9,0,0),sE[$E.OCT2BIN]=p(1,[95,95],[],9,0,0),sE[$E.OCT2HEX]=p(1,[95,95],[],9,0,0),sE[$E.OCT2DEC]=p(1,[95],[],9,0,0),sE[$E.BIN2DEC]=p(1,[95],[],9,0,0),sE[$E.BIN2OCT]=p(1,[95,95],[],9,0,0),sE[$E.BIN2HEX]=p(1,[95,95],[],9,0,0),sE[$E.IMSUB]=p(2,[95,95],[],9,0,0),sE[$E.IMDIV]=p(2,[95,95],[],9,0,0),sE[$E.IMPOWER]=p(2,[95,95],[],9,0,0),sE[$E.IMABS]=p(1,[95],[],9,0,0),sE[$E.IMSQRT]=p(1,[95],[],9,0,0),sE[$E.IMLN]=p(1,[95],[],9,0,0),sE[$E.IMLOG2]=p(1,[95],[],9,0,0),sE[$E.IMLOG10]=p(1,[95],[],9,0,0),sE[$E.IMSIN]=p(1,[95],[],9,0,0),sE[$E.IMCOS]=p(1,[95],[],9,0,0),sE[$E.IMEXP]=p(1,[95],[],9,0,0),sE[$E.IMARGUMENT]=p(1,[95],[],9,0,0),sE[$E.IMCONJUGATE]=p(1,[95],[],9,0,0),sE[$E.IMAGINARY]=p(1,[95],[],9,0,0),sE[$E.IMREAL]=p(1,[95],[],9,0,0),sE[$E.COMPLEX]=p(2,[95,95,95],[],9,0,0),sE[$E.IMSUM]=p(1,[],[127],9,0,0),sE[$E.IMPRODUCT]=p(1,[],[127],9,0,0),sE[$E.SERIESSUM]=p(4,[95,95,95,127],[],9,0,0),sE[$E.FACTDOUBLE]=p(1,[95],[],9,0,0),sE[$E.SQRTPI]=p(1,[95],[],9,0,0),sE[$E.QUOTIENT]=p(2,[95,95],[],9,0,0),sE[$E.DELTA]=p(1,[95,95],[],9,0,0),sE[$E.GESTEP]=p(1,[95,95],[],9,0,0),sE[$E.ISEVEN]=p(1,[95],[],9,0,0),sE[$E.ISODD]=p(1,[95],[],9,0,0),sE[$E.MROUND]=p(2,[95,95],[],9,0,0),sE[$E.ERF]=p(1,[95,95],[],9,0,0),sE[$E.ERFC]=p(1,[95],[],9,0,0),sE[$E.BESSELJ]=p(2,[95,95],[],9,0,0),sE[$E.BESSELK]=p(2,[95,95],[],9,0,0),sE[$E.BESSELY]=p(2,[95,95],[],9,0,0),sE[$E.BESSELI]=p(2,[95,95],[],9,0,0),sE[$E.XIRR]=p(2,[127,127,95],[],9,0,0),sE[$E.XNPV]=p(3,[95,127,127],[],9,0,0),sE[$E.PRICEMAT]=p(5,[95,95,95,95,95,95],[],9,0,0),sE[$E.YIELDMAT]=p(5,[95,95,95,95,95,95],[],9,0,0),sE[$E.INTRATE]=p(4,[95,95,95,95,95],[],9,0,0),sE[$E.RECEIVED]=p(4,[95,95,95,95,95],[],9,0,0),sE[$E.DISC]=p(4,[95,95,95,95,95],[],9,0,0),sE[$E.PRICEDISC]=p(4,[95,95,95,95,95],[],9,0,0),sE[$E.YIELDDISC]=p(4,[95,95,95,95,95],[],9,0,0),sE[$E.TBILLEQ]=p(3,[95,95,95],[],9,0,0),sE[$E.TBILLPRICE]=p(3,[95,95,95],[],9,0,0),sE[$E.TBILLYIELD]=p(3,[95,95,95],[],9,0,0),sE[$E.PRICE]=p(6,[95,95,95,95,95,95,95],[],9,0,0),sE[$E.YIELD]=p(6,[95,95,95,95,95,95,95],[],9,0,0),sE[$E.DOLLARDE]=p(2,[95,95],[],9,0,0),sE[$E.DOLLARFR]=p(2,[95,95],[],9,0,0),sE[$E.NOMINAL]=p(2,[95,95],[],9,0,0),sE[$E.EFFECT]=p(2,[95,95],[],9,0,0),sE[$E.CUMPRINC]=p(6,[95,95,95,95,95,95],[],9,0,0),sE[$E.CUMIPMT]=p(6,[95,95,95,95,95,95],[],9,0,0),sE[$E.EDATE]=p(2,[95,95],[],9,0,0),sE[$E.EOMONTH]=p(2,[95,95],[],9,0,0),sE[$E.YEARFRAC]=p(2,[95,95,95],[],9,0,0),sE[$E.COUPDAYBS]=p(3,[95,95,95,95],[],9,0,0),sE[$E.COUPDAYS]=p(3,[95,95,95,95],[],9,0,0),sE[$E.COUPDAYSNC]=p(3,[95,95,95,95],[],9,0,0),sE[$E.COUPNCD]=p(3,[95,95,95,95],[],9,0,0),sE[$E.COUPNUM]=p(3,[95,95,95,95],[],9,0,0),sE[$E.COUPPCD]=p(3,[95,95,95,95],[],9,0,0),sE[$E.DURATION]=p(5,[95,95,95,95,95,95],[],9,0,0),sE[$E.MDURATION]=p(5,[95,95,95,95,95,95],[],9,0,0),sE[$E.ODDLPRICE]=p(7,[95,95,95,95,95,95,95,95],[],9,0,0),sE[$E.ODDLYIELD]=p(7,[95,95,95,95,95,95,95,95],[],9,0,0),sE[$E.ODDFPRICE]=p(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),sE[$E.ODDFYIELD]=p(8,[95,95,95,95,95,95,95,95,95],[],9,0,0),sE[$E.RANDBETWEEN]=p(2,[95,95],[],9,4095,0),sE[$E.WEEKNUM]=p(1,[95,95],[],9,0,0),sE[$E.AMORDEGRC]=p(6,[95,95,95,95,95,95,95],[],9,0,0),sE[$E.AMORLINC]=p(6,[95,95,95,95,95,95,95],[],9,0,0),sE[$E.CONVERT]=p(3,[95,95,95],[],9,0,0),sE[$E.ACCRINT]=p(6,[95,95,95,95,95,95,95,95],[],9,0,0),sE[$E.ACCRINTM]=p(4,[95,95,95,95,95],[],9,0,0),sE[$E.WORKDAY]=p(2,[95,95,127],[],9,0,0),sE[$E.NETWORKDAYS]=p(2,[95,95,127],[],9,0,0),sE[$E.GCD]=p(1,[],[127],9,0,0),sE[$E.MULTINOMIAL]=p(1,[],[127],9,0,0),sE[$E.LCM]=p(1,[],[127],9,0,0),sE[$E.FVSCHEDULE]=p(2,[95,127],[],9,0,0),sE[$E.CUBEKPIMEMBER]=p(3,[2,2,1,2],[],10,0,0),sE[$E.CUBESET]=p(2,[2,50,2,1,2],[],10,0,0),sE[$E.CUBESETCOUNT]=p(1,[2],[],9,0,0),sE[$E.IFERROR]=p(2,[47,575],[],47,0,0),sE[$E.COUNTIFS]=p(2,[],[16,15],1,0,0),sE[$E.SUMIFS]=p(3,[16],[16,15],1,0,0),sE[$E.AVERAGEIF]=p(2,[16,15,16],[],1,0,0),sE[$E.AVERAGEIFS]=p(3,[16],[16,15],1,0,0),sE[$E.AGGREGATE]=p(3,[1,1,48,17],[16],1,0,0),sE[$E.BINOM_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.BINOM_INV]=p(3,[1,1,1],[],1,0,0),sE[$E.CONFIDENCE_NORM]=p(3,[1,1,1],[],1,0,0),sE[$E.CONFIDENCE_T]=p(3,[1,1,1],[],1,0,0),sE[$E.CHISQ_TEST]=p(2,[32,32],[],1,0,0),sE[$E.F_TEST]=p(2,[32,32],[],1,0,0),sE[$E.COVARIANCE_P]=p(2,[32,32],[],1,0,0),sE[$E.COVARIANCE_S]=p(2,[32,32],[],1,0,0),sE[$E.EXPON_DIST]=p(3,[1,1,4],[],1,0,0),sE[$E.GAMMA_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.GAMMA_INV]=p(3,[1,1,1],[],1,0,0),sE[$E.MODE_MULT]=p(1,[],[32],32,0,0),sE[$E.MODE_SNGL]=p(1,[],[32],1,0,0),sE[$E.NORM_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.NORM_INV]=p(3,[1,1,1],[],1,0,0),sE[$E.PERCENTILE_EXC]=p(2,[49,1],[],1,0,0),sE[$E.PERCENTILE_INC]=p(2,[49,1],[],1,0,0),sE[$E.PERCENTRANK_EXC]=p(2,[49,1,65],[],1,0,0),sE[$E.PERCENTRANK_INC]=p(2,[49,1,65],[],1,0,0),sE[$E.POISSON_DIST]=p(3,[1,1,4],[],1,0,0),sE[$E.QUARTILE_EXC]=p(2,[49,1],[],1,0,0),sE[$E.QUARTILE_INC]=p(2,[49,1],[],1,0,0),sE[$E.RANK_AVG]=p(2,[1,16,4],[],1,0,0),sE[$E.RANK_EQ]=p(2,[1,16,4],[],1,0,0),sE[$E.STDEV_S]=p(1,[],[49],1,0,0),sE[$E.STDEV_P]=p(1,[],[49],1,0,0),sE[$E.T_DIST]=p(3,[1,1,4],[],1,0,0),sE[$E.T_DIST_2T]=p(2,[1,1],[],1,0,0),sE[$E.T_DIST_RT]=p(2,[1,1],[],1,0,0),sE[$E.T_INV]=p(2,[1,1],[],1,0,0),sE[$E.T_INV_2T]=p(2,[1,1],[],1,0,0),sE[$E.VAR_S]=p(1,[],[49],1,0,0),sE[$E.VAR_P]=p(1,[],[49],1,0,0),sE[$E.WEIBULL_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.NETWORKDAYS_INTL]=p(2,[95,95,75,127],[],9,0,0),sE[$E.WORKDAY_INTL]=p(2,[95,95,75,127],[],9,0,0),sE[$E.ECMA_CEILING]=p(2,[1,1],[],1,0,0),sE[$E.ISO_CEILING]=p(1,[1,65],[],1,0,0),sE[$E.DEBUG]=p(1,[2],[1151],1087,0,0),sE[$E.BETA_DIST]=p(4,[1,1,1,4,65,65],[],1,0,0),sE[$E.BETA_INV]=p(3,[1,1,1,65,65],[],1,0,0),sE[$E.CHISQ_DIST]=p(3,[1,1,4],[],1,0,0),sE[$E.CHISQ_DIST_RT]=p(2,[1,1],[],1,0,0),sE[$E.CHISQ_INV]=p(2,[1,1],[],1,0,0),sE[$E.CHISQ_INV_RT]=p(2,[1,1],[],1,0,0),sE[$E.F_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.F_DIST_RT]=p(3,[1,1,1],[],1,0,0),sE[$E.F_INV]=p(3,[1,1,1],[],1,0,0),sE[$E.F_INV_RT]=p(3,[1,1,1],[],1,0,0),sE[$E.HYPGEOM_DIST]=p(5,[1,1,1,1,4],[],1,0,0),sE[$E.LOGNORM_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.LOGNORM_INV]=p(3,[1,1,1],[],1,0,0),sE[$E.NEGBINOM_DIST]=p(4,[1,1,1,4],[],1,0,0),sE[$E.NORM_S_DIST]=p(2,[1,4],[],1,0,0),sE[$E.NORM_S_INV]=p(1,[1],[],1,0,0),sE[$E.T_TEST]=p(4,[32,32,1,1],[],1,0,0),sE[$E.Z_TEST]=p(2,[49,1,1],[],1,0,0),sE[$E.ERF_PRECISE]=p(1,[95],[],9,0,0),sE[$E.ERFC_PRECISE]=p(1,[95],[],9,0,0),sE[$E.GAMMALN_PRECISE]=p(1,[1],[],1,0,0),sE[$E.CEILING_PRECISE]=p(1,[1,65],[],1,0,0),sE[$E.FLOOR_PRECISE]=p(1,[1,65],[],1,0,0),sE[$E.ACOT]=p(1,[1],[],1,0,0),sE[$E.ACOTH]=p(1,[1],[],1,0,0),sE[$E.COT]=p(1,[1],[],1,0,0),sE[$E.COTH]=p(1,[1],[],1,0,0),sE[$E.CSC]=p(1,[1],[],1,0,0),sE[$E.CSCH]=p(1,[1],[],1,0,0),sE[$E.SEC]=p(1,[1],[],1,0,0),sE[$E.SECH]=p(1,[1],[],1,0,0),sE[$E.IMTAN]=p(1,[95],[],9,0,0),sE[$E.IMCOT]=p(1,[95],[],9,0,0),sE[$E.IMCSC]=p(1,[95],[],9,0,0),sE[$E.IMCSCH]=p(1,[95],[],9,0,0),sE[$E.IMSEC]=p(1,[95],[],9,0,0),sE[$E.IMSECH]=p(1,[95],[],9,0,0),sE[$E.BITAND]=p(2,[1,1],[],1,0,0),sE[$E.BITOR]=p(2,[1,1],[],1,0,0),sE[$E.BITXOR]=p(2,[1,1],[],1,0,0),sE[$E.BITLSHIFT]=p(2,[1,1],[],1,0,0),sE[$E.BITRSHIFT]=p(2,[1,1],[],1,0,0),sE[$E.PERMUTATIONA]=p(2,[1,1],[],1,0,0),sE[$E.COMBINA]=p(2,[1,1],[],1,0,0),sE[$E.XOR]=p(1,[],[52],4,0,0),sE[$E.PDURATION]=p(3,[1,1,1],[],1,0,0),sE[$E.BASE]=p(2,[1,1,65],[],2,0,0),sE[$E.DECIMAL]=p(2,[2,1],[],1,0,0),sE[$E.DAYS]=p(2,[3,3],[],1,0,0),sE[$E.BINOM_DIST_RANGE]=p(3,[1,1,1,65],[],1,0,0),sE[$E.GAMMA]=p(1,[1],[],1,0,0),sE[$E.SKEW_P]=p(1,[],[49],1,0,0),sE[$E.GAUSS]=p(1,[1],[],1,0,0),sE[$E.PHI]=p(1,[1],[],1,0,0),sE[$E.RRI]=p(3,[1,1,1],[],1,0,0),sE[$E.UNICHAR]=p(1,[1],[],2,0,0),sE[$E.UNICODE]=p(1,[2],[],1,0,0),sE[$E.MUNIT]=p(1,[1],[],32,0,0),sE[$E.ARABIC]=p(1,[2],[],1,0,0),sE[$E.ISOWEEKNUM]=p(1,[1],[],1,0,0),sE[$E.NUMBERVALUE]=p(1,[2,66,66],[],1,0,0),sE[$E.SHEET]=p(0,[50],[],1,4095,0),sE[$E.SHEETS]=p(0,[48],[],1,4095,0),sE[$E.FORMULATEXT]=p(1,[16],[],2,4095,0),sE[$E.ISFORMULA]=p(1,[16],[],4,0,0),sE[$E.IFNA]=p(2,[47,575],[],47,0,0),sE[$E.CEILING_MATH]=p(1,[1,65,65],[],1,0,0),sE[$E.FLOOR_MATH]=p(1,[1,65,65],[],1,0,0),sE[$E.IMSINH]=p(1,[95],[],9,0,0),sE[$E.IMCOSH]=p(1,[95],[],9,0,0),sE[$E.FILTERXML]=p(2,[2,2],[],47,0,0),sE[$E.WEBSERVICE]=p(1,[2],[],10,0,0),sE[$E.ENCODEURL]=p(1,[2],[],10,0,0),sE[$E.FORECAST_ETS]=p(3,[1,48,48,65,65,65],[],1,0,0),sE[$E.FORECAST_ETS_CONFINT]=p(3,[1,48,48,65,65,65,65],[],1,0,0),sE[$E.FORECAST_ETS_SEASONALITY]=p(2,[48,48,65,65],[],1,0,0),sE[$E.FORECAST_LINEAR]=p(3,[1,32,32],[],1,0,0),sE[$E.FORECAST_ETS_STAT]=p(3,[48,48,1,65,65,65],[],1,0,0),sE[$E.MAXIFS]=p(3,[16],[16,15],1,0,0),sE[$E.MINIFS]=p(3,[16],[16,15],1,0,0),sE[$E.TEXTJOIN]=p(3,[114,68],[114],2,0,0),sE[$E.CONCAT]=p(1,[],[114],2,0,0),sE[$E.IFS]=p(2,[],[44,575],575,0,0),sE[$E.SWITCH]=p(3,[47,575],[575,575],575,0,0),sE[$E.SINGLE]=p(1,[1079,4],[],1055,0,1),sE[$E.AVERAGE_WEIGHTED]=p(2,[],[113,113],1,0,1),sE[$E.ANCHORARRAY]=p(1,[16],[],48,0,1),sE[$E.IMAGE]=p(1,[2],[],2,0,1),sE[$E.RECORD]=p(3,[47],[2,47],47,0,1),sE[$E.GRF]=p(1,[15,2],[],15,0,1),sE[$E.UNIT]=p(2,[15,2],[],15,0,1),sE[$E.RICHERROR]=p(1,[1],[],10,0,1),sE[$E.FILTER]=p(2,[48,48],[],32,0,1),sE[$E.FUN]=p(1,[],[63],63,0,1),sE[$E.LET]=p(3,[63,63,63],[],63,0,1),sE[$E.ARRAYMAKE]=p(3,[1,1,63],[],32,0,1),sE[$E.APPLY]=p(1,[],[63],63,0,1),sE[$E.ISFUN]=p(1,[63],[],4,0,1),sE[$E.ARITY]=p(1,[63],[],9,0,1),sE[$E.RECURSE]=p(0,[],[],63,0,1);var TE,ME=p(0,[],[u.All],u.All,I.All,f.None);!function(E){E[E.Add=1]="Add",E[E.Sub=2]="Sub",E[E.Mul=3]="Mul",E[E.Div=4]="Div",E[E.Pow=5]="Pow",E[E.Percent=6]="Percent",E[E.Neg=7]="Neg",E[E.Pos=8]="Pos",E[E.Concat=9]="Concat",E[E.Eq=10]="Eq",E[E.Ne=11]="Ne",E[E.Lt=12]="Lt",E[E.Le=13]="Le",E[E.Gt=14]="Gt",E[E.Ge=15]="Ge",E[E.Range=16]="Range",E[E.Isect=17]="Isect",E[E.Union=18]="Union",E[E.And=19]="And",E[E.Or=20]="Or",E[E.Xor=21]="Xor",E[E.Min=22]="Min",E[E.Max=23]="Max",E[E.Dot=24]="Dot"}(TE||(TE={}));var gE,dE,lE=S.Number|S.String|S.Boolean,pE=S.Number|S.String|S.Boolean|S.Blank,cE=p(2,[S.Number,S.Number],[],S.Number,I.None,f.None),kE=p(1,[S.Number],[],S.Number,I.None,f.None),tE=p(1,[lE],[],lE,I.None,f.None),aE=p(2,[S.String,S.String],[],S.String,I.None,f.None),iE=p(2,[pE,pE],[],S.Boolean,I.None,f.None),oE=p(2,[S.Range,S.Range],[],S.Range,I.AllCells,f.None),eE=p(2,[S.Range,S.Range],[],S.Range,I.None,f.None),nE=p(2,[S.Boolean,S.Boolean],[],S.Boolean,I.None,f.None),Ev=[];function vv(E){var v=Ev[E];return null!=v?v:ME}function Av(E){var v=sE[E];return null!=v?v:ME}function Nv(E,v){var A=sE[E];null!=A&&(A.staticPrecs=v)}function Ov(E){return 1===E.length}function Cv(E){return 1===E.rows&&1===E.cols}function Lv(E){return Ov(E.sheet)}function Fv(E){return Cv(E.range)}function Uv(E){return Cv(E)?E:z(E.row,E.col,1,1)}function yv(E){return Fv(E)?E:g(E.sheet,Uv(E.range))}function Pv(E,v){var A=E.row,N=E.col,O=v.row,C=v.col;return z(Math.min(A,O),Math.min(N,C),Math.abs(O-A)+1,Math.abs(C-N)+1)}function Vv(E){return 0===function(E){if(1===E.args.length){var v=E.args[0];if(v.kind===yE.Literal&&bv(v.oper)===S.Missing)return 0}return E.args.length}(E)?[]:E.args}function Gv(E,v){Z("calc.runtime.getArgType",v);var A=E.headTypes,N=A.length;if(v<N)return A[v];var O=E.restTypes,C=O.length;return C>0?O[(v-N)%C]:u.None}function Hv(E,v){return!(v<E.minArgs)&&(v<=E.headTypes.length||E.restTypes.length>0)}function bv(E){switch(typeof E){case"number":return S.Number;case"string":return S.String;case"boolean":return S.Boolean;default:return E.kind}}function _v(E){return"number"==typeof E&&isFinite(E)}function Kv(E){return{kind:gE.Success,value:E}}function Wv(E){return{kind:gE.Failure,reason:E}}function Xv(E){return null!=E&&E.kind===gE.Success}function Yv(E){return{kind:dE.NotImplemented,features:E}}function Jv(E){return 0===E.length&&j("calc.lang.unavailable: expected nonempty array"),{kind:dE.Unavailable,objects:E}}function jv(E){if(null!=E){var v=E.path,A=E.name;return null!=v&&"string"!=typeof v?(X.ULS.traceTag(595969803,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"Illegal document path: type is "+typeof v),h):"string"!=typeof A?(X.ULS.traceTag(595969804,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"Illegal document name: type is "+typeof A),h):E}}Ev[TE.Add]=cE,Ev[TE.Sub]=cE,Ev[TE.Mul]=cE,Ev[TE.Div]=cE,Ev[TE.Pow]=cE,Ev[TE.Percent]=kE,Ev[TE.Neg]=kE,Ev[TE.Pos]=tE,Ev[TE.Concat]=aE,Ev[TE.Eq]=iE,Ev[TE.Ne]=iE,Ev[TE.Lt]=iE,Ev[TE.Le]=iE,Ev[TE.Gt]=iE,Ev[TE.Ge]=iE,Ev[TE.Range]=oE,Ev[TE.Isect]=eE,Ev[TE.Union]=eE,Ev[TE.And]=nE,Ev[TE.Or]=nE,Ev[TE.Xor]=nE,Ev[TE.Min]=cE,Ev[TE.Max]=cE,Nv($E.ROW,I.OwnRow),Nv($E.COLUMN,I.OwnCol),Nv($E.SHEET,I.OwnDocSheets),Nv($E.SHEETS,I.OwnDocSheets),Nv($E.OFFSET,I.AllCells),Nv($E.INDIRECT,I.AllCells),Nv($E.SUMIF,I.AllCells),Nv($E.NOW,I.Time),Nv($E.TODAY,I.Time),Nv($E.RAND,I.Calc),Nv($E.RANDBETWEEN,I.Calc),Nv($E.SUBTOTAL,I.CellProps),Nv($E.CELL,I.CellProps|I.AllCells),Nv($E.INFO,I.Calc),Nv($E.FORMULATEXT,I.None),function(E){E.Success="Success",E.Failure="Failure",E.Paused="Paused"}(gE||(gE={})),function(E){E.NotImplemented="NotImplemented",E.Unavailable="Unavailable"}(dE||(dE={}));var Zv=65;function $v(E){for(var v=E+1,A="";v>0;){var N=(v-1)%26;A=String.fromCharCode(Zv+N)+A,v=Math.floor((v-N)/26)}return A}function Rv(E,v,A){var N=A.kind,O=A.index;return N===UE.Abs?v+E.formatNumber(O+1):0===O?v:v+E.leftBracket+E.formatNumber(O)+E.rightBracket}function hv(E,v,A,N){if(v===CE.A1){if(null==A){return X.ULS.assertTag(595935437,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatRow: in A1 style, expected origin to be defined")}return function(E,v,A){var N=A.kind===UE.Abs,O=E.formatNumber(A.index+(N?0:v)+1);return N?"$"+O:O}(E,A,N)}return Rv(E,E.rowLetter,N)}function Bv(E,v,A,N){if(v===CE.A1){if(null==A){return X.ULS.assertTag(595935438,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.lang.util.formatCol: in A1 style, expected origin to be defined")}return function(E,v){var A=v.kind===UE.Abs,N=$v(v.index+(A?0:E));return A?"$"+N:N}(A,N)}return Rv(E,E.columnLetter,N)}function wv(E){return function(v,A,N,O,C){var L=E(v,A,N,O);return A===CE.R1C1&&O.kind===C.kind&&O.index===C.index?L:L+":"+E(v,A,N,C)}}var xv=wv(hv),qv=wv(Bv);function zv(E,v,A,N,O){var C=hv(E,v,null!=A?A.row:void 0,N),L=Bv(E,v,null!=A?A.col:void 0,O);return v===CE.A1?L+C:C+L}var Qv,mv={ULS:new U.NulLogger};Object(U.initStopwatchFactory)(function(E){return mv.ULS.traceTag(595948114,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,E)});!function(E){E.FeatureCheckingEnabled="FeatureCheckingEnabled",E.CalcNewFunctions="CalcNewFunctions",E.CalcContractChecks="CalcContractChecks",E.CalcSupportDynamicArrays="CalcSupportDynamicArrays",E.CalcFormatCalculations="CalcFormatCalculations",E.CalcFormulaCacheAPIChanges="CalcFormulaCacheAPIChanges",E.CalcStrictFormulaChecking="CalcStrictFormulaChecking",E.CalcUnifyRangeResolutionCode="CalcUnifyRangeResolutionCode",E.CalcSupportRowReference="CalcSupportRowReference",E.CalcHashSet="CalcHashSet",E.CalcWorksheetFunctions="CalcWorksheetFunctions"}(Qv||(Qv={}));var rv=function(E){return!1},Sv={};function uv(E){return void 0===Sv[E]&&(Sv[E]=rv(E)),Sv[E]}function Iv(E,v){return{wrap:E,unwrap:v}}function fv(E){return E}function Dv(){var E=Object.create(null);return E.___=void 0,delete E.___,E}function sv(E){var v=Dv();for(var A in E)v[A]=E[A];return v}function Tv(E){return null!=E}function Mv(E){return null==E}function gv(E,v){return void 0!==E?E:v}var dv=100;function lv(E,v,A){return void 0===A&&(A=dv),v.maxDepth=A,v.level=0,pv(E,v)}function pv(E,v){if(v.level===v.maxDepth)throw"AST is too deep to continue the visit. Currently as level "+v.level;var A;switch(v.level+=1,E.kind){case yE.Literal:A=function(E,v){if("boolean"==typeof E)return v.visitBoolean(E);if("number"==typeof E)return v.visitNumber(E);if("string"==typeof E)return v.visitString(E);if(E.kind===S.Missing)return v.visitMissing(E);if(E.kind===S.Error)switch(E.type){case D.NULL:return v.visitNullError(E);case D.DIV0:return v.visitDiv0Error(E);case D.VALUE:return v.visitValueError(E);case D.REF:return v.visitRefError(E);case D.NAME:return v.visitNameError(E);case D.NUM:return v.visitNumError(E);case D.NA:return v.visitNAError(E);case D.GETTING_DATA:return v.visitDataError(E)}throw"Tried to visit unrecognized AST node: "+E.kind+"."}(E.oper,v.operVisitor);break;case yE.Array:A=v.visitArray(E);break;case yE.App:A=v.visitApp(E);break;case yE.Paren:A=v.visitParen(E);break;case yE.Name:A=v.visitName(E);break;case yE.CellRef:A=v.visitCellRef(E);break;case yE.Bad:A=v.visitBad(E);break;case yE.Operator:A=v.visitOperator(E);break;case FE.Error:A=v.visitRefError(E);break;case FE.Single:A=v.visitSingle(E);break;case FE.Range:A=v.visitRange(E);break;case FE.Row:A=v.visitRow(E);break;case FE.Col:A=v.visitCol(E);break;case LE.Error:A=v.visitNameError(E);break;case LE.Relative:A=v.visitRelative(E);break;case LE.Document:A=v.visitDocument(E);break;case LE.Sheet:A=v.visitSheet(E);break;case LE.Ident:A=v.visitIdent(E);break;case LE.SheetRange:A=v.visitSheetRange(E);break;default:throw"Tried to visit unrecognized AST node: "+E.kind+"."}return v.level-=1,A}function cv(E){return{visitString:E,visitBoolean:E,visitNumber:E,visitMissing:E,visitNullError:E,visitDiv0Error:E,visitValueError:E,visitRefError:E,visitNameError:E,visitNumError:E,visitNAError:E,visitDataError:E}}function kv(E,v,A){return{level:0,operVisitor:E,visitArray:gv(A.vArray,v),visitApp:gv(A.vApp,v),visitParen:gv(A.vParen,v),visitName:gv(A.vName,v),visitCellRef:gv(A.vCellRef,v),visitBad:gv(A.vBad,v),visitOperator:gv(A.vOperator,v),visitRefError:gv(A.vRefError,v),visitSingle:gv(A.vSingle,v),visitRange:gv(A.vRange,v),visitRow:gv(A.vRow,v),visitCol:gv(A.vCol,v),visitNameError:gv(A.vNameError,v),visitRelative:gv(A.vRelative,v),visitDocument:gv(A.vDocument,v),visitSheet:gv(A.vSheet,v),visitIdent:gv(A.vIdent,v),visitSheetRange:gv(A.vSheetRange,v)}}var tv=["+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":"," ",","];var av={level:0,operVisitor:{visitString:function(E){return'"'+E+'"'},visitBoolean:function(E){return E.toString().toLocaleUpperCase()},visitNumber:function(E){return E.toString()},visitMissing:function(E){return""},visitNullError:function(E){return"#NULL!"},visitDiv0Error:function(E){return"#DIV/0!"},visitValueError:function(E){return"#VALUE!"},visitRefError:function(E){return"#REF!"},visitNameError:function(E){return"#NAME?"},visitNumError:function(E){return"#NUM!"},visitNAError:function(E){return"#N/A"},visitDataError:function(E){return"#GETTING_DATA!"}},visitArray:function(E){var v=[];return E.nodes.forEach(function(E){var A=[];E.forEach(function(E){A.push(pv(E,av))}),v.push(A.join(","))}),"{"+v.join(";")+"}"},visitApp:function(E){var v=[];E.args.forEach(function(E){v.push(pv(E,av))});var A=pv(E.head,av);if(E.head.kind===yE.Operator){if(E.head.id===TE.Percent)return v[0]+"%";if(1===v.length)return A+v[0];if(2===v.length)return v[0]+A+v[1];throw"Tried to pretty print operator with 0 or more than 2 operators"}return A+"("+v.join(",")+")"},visitParen:function(E){return"("+pv(E.node,av)+")"},visitName:function(E){return E.whole},visitCellRef:function(E){var v="";return void 0!==E.qualifier&&(v=pv(E.qualifier,this)+"!"),v+pv(E.ref,this)},visitBad:function(E){if(E.type===PE.Sequence){var v=[];return E.contents.forEach(function(E){v.push(pv(E,av))}),v.join("")}return E.contents},visitOperator:function(E){return tv[E.id-1]},visitRefError:function(E){return"#REF!"},visitSingle:function(E){return v=E.row.index,A=E.row.kind===UE.Abs,N=E.col.index,(E.col.kind===UE.Abs?"$":"")+$v(N)+(A?"$":"")+(v+1);var v,A,N},visitRange:function(E){return pv(E.ref1,av)+":"+pv(E.ref2,av)},visitRow:function(E){var v=E.row1.index+1,A=E.row1.kind===UE.Abs,N=E.row2.index+1;return(A?"$":"")+v+":"+(E.row2.kind===UE.Abs?"$":"")+N},visitCol:function(E){var v=E.col1.index,A=E.col1.kind===UE.Abs,N=E.col2.index,O=E.col2.kind===UE.Abs;return(A?"$":"")+$v(v)+":"+(O?"$":"")+$v(N)},visitNameError:function(E){return"#REF"},visitRelative:function(E){return""},visitDocument:function(E){return void 0!==E.path?E.path+"/"+E.document:E.document},visitSheet:function(E){return(void 0!==E.document?pv(E.document,av):"")+E.sheet},visitIdent:function(E){return E.name},visitSheetRange:function(E){return E.sheet1+":"+E.sheet2}};function iv(E){var v=function(E){try{return Kv("="+lv(E,av))}catch(E){return X.ULS.traceTag(595964180,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"PrettyPrinter failed: "+E),av.level=0,Wv(E)}}(E);if(v.kind===gE.Success){return v.value.toLowerCase().replace(/d/g,"w").replace(/[0-9]/g,"d").replace(new RegExp('[^/=\\[\\]\\.\\\\\\/%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*/g/\\u0024\\u0080\\u00a2\\u00a3\\u00a4\\u00a5\\u20a0\\u20a1\\u20a2\\u20a3\\u20a4\\u20a5\\u20a6\\u20a7\\u20a8\\u20a9\\u20aa\\u20ab\\u20ac\\u20ad\\u20ae\\u20af\\u20b0\\u20b1\\u20b2\\u20b3\\u20b4\\u20b5\\u20b6\\u20b7\\u20b8\\u20b9/g/\\s\\ua0c2/gd]',"g"),"w")}}function ov(E){return iv(E.node)}function ev(E){return W.FormulaNode=iv,W.Formula=ov,{localeInfo:E}}function nv(E,v){var A;Y(E),function(E){mv.ULS=E}(E),"function"==typeof(A=v)&&(rv=A)}function EA(E,v,A,N,O,C,L,F,U,y,P,V,G,H,b,_,K,W,X,Y,J,j){return{parseNumber:E,formatNumber:v,getWorksheetFuncId:A,getWorksheetFuncName:N,isNumeral:O,getOrdinal:C,getNumeral:L,isLetter:F,stringCompareCI:U,errorNames:y,trueName:P,falseName:V,rowLetter:G,columnLetter:H,leftBrace:b,rightBrace:_,leftBracket:K,rightBracket:W,decimalSeparator:X,listSeparator:Y,columnSeparator:J,rowSeparator:j}}var vA,AA,NA,OA,CA,LA,FA,UA,yA,PA,VA,GA,HA=FE,bA=UE,_A=LE,KA=WE,WA=m,XA=q,YA=x,JA=T,jA=d,ZA=l,$A=Pv,RA=Xv,hA=dE,BA=Yv;function wA(E){if(void 0===E)return!0;if(null===E||"object"!=typeof E)return!1;switch(E.kind){case hA.NotImplemented:case hA.Unavailable:return!0}return!1}function xA(E,v,A){return function(N,O){return void 0===O?v(N):wA(O)?A(O,N):E(O)}}function qA(E,v){return function(A){if(Array.isArray(A)){for(var N=void 0,O=0;O<A.length;O+=1){var C=A[O];if(void 0!==(N=E(C)))return[C,N]}return v}var L=E(A);return void 0===L?v:[A,L]}}function zA(E,v){return v.kind===bA.Abs?v.index:E+v.index}function QA(E,v){var A=zA(E.row,v.row),N=zA(E.col,v.col);return WA(A,N)}function mA(E,v){switch(v.kind){case HA.Error:return;case HA.Single:var A=QA(E,v);return WA(A.row,A.col);case HA.Range:var N=QA(E,v.ref1),O=QA(E,v.ref2);return $A(N,O);case HA.Row:return BA(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]);case HA.Col:return BA(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]);default:return J("calc.runtime.resolverService.resolveGridRef",v)}}function rA(E){function v(v){var A=E.getDocumentLoc(v.path,v.document);return Tv(A)?A:void 0}function A(A,N){var O=Tv(N.document)?v(N.document):A;if(!Mv(O)){var C=E.getSheetIndex(O,N.sheet);return RA(C)?Tv(C.value)?XA(O,C.value):void 0:C.reason}}return{resolveName:function(N,O,C){if(Mv(O)||O.kind===_A.Relative)return[ZA(N.sheet,C),ZA(jA(N.sheet.document),C)];var L=function(N,O){switch(O.kind){case _A.Document:var C=v(O);return Tv(C)?jA(C):C;case _A.Sheet:return A(N.sheet.document,O);case _A.Ident:var L=N.sheet.document,F=E.getSheetIndex(L,O.name);if(RA(F)){if(Tv(F.value))return XA(L,F.value);var U=v(KA(O.name));return Tv(U)?jA(U):void 0}return F.reason;default:return J("calc.runtime.resolverService.resolveNameQualifier",O)}}(N,O);return wA(L)?L:ZA(L,C)},resolveGridRef:mA,resolveCellRef:function(v,N,O){var C=mA(v.range,O);if(wA(C))return C;var L=Mv(N)?v.sheet:function(v,N){switch(N.kind){case _A.Error:return;case _A.Sheet:return A(v.document,N);case _A.SheetRange:var O=v.document,C=E.getSheetIndex(O,N.sheet1);if(!RA(C))return C.reason;var L=E.getSheetIndex(O,N.sheet2);if(!RA(L))return L.reason;var F=C.value,U=L.value;if(Mv(F)||Mv(U))return;return F===U?XA(O,F):YA(O,Math.min(F,U),Math.abs(U-F)+1);case _A.Relative:return v;default:return J("calc.runtime.resolverService.resolveCellRefQualifier",N)}}(v.sheet,N);return wA(L)?L:JA(L,C)}}}(AA=vA||(vA={})).FormulaSource=b,AA.documentLoc=B,AA.sheetIndex=q,AA.sheetRange=x,AA.gridCell=m,AA.gridRange=Q,AA.sheetGridCell=g,AA.sheetGridRange=M,AA.sheetGridCube=T,AA.documentScope=d,AA.nameLoc=l,(OA=NA||(NA={})).SpecialPrecs=I,OA.OperKind=S,OA.ErrorType=D,OA.ErrorTypeBounds=s,OA.precedents=c,OA.errorOper=k,OA.nullErrorOper=t,OA.div0ErrorOper=a,OA.valueErrorOper=i,OA.refErrorOper=o,OA.nameErrorOper=e,OA.numErrorOper=n,OA.naErrorOper=EE,OA.gettingDataErrorOper=vE,OA.arrayOper=AE,OA.rangeSeqOper=NE,OA.range3DOper=OE,OA.missingOper=VE,OA.blankOper=GE,(LA=CA||(CA={})).RefStyle=CE,LA.QualifierKind=LE,LA.CellRefKind=FE,LA.PosKind=UE,LA.NodeKind=yE,LA.BadType=PE,LA.errorQualifierLabeled=HE,LA.relativeQualifierLabeled=bE,LA.errorQualifier=_E,LA.relativeQualifier=KE,LA.documentQualifier=WE,LA.sheetQualifier=XE,LA.identQualifier=YE,LA.sheetRangeQualifier=JE,LA.pos=jE,LA.cellRefErrorLabeled=ZE,LA.cellRefError=RE,LA.cellRefSingle=hE,LA.cellRefRange=BE,LA.cellRefRow=wE,LA.cellRefCol=xE,LA.formula=qE,LA.formulaSpan=zE,LA.literalNode=QE,LA.arrayNode=mE,LA.appNode=rE,LA.operatorNode=SE,LA.parenNode=uE,LA.nameNode=IE,LA.cellRefNode=fE,LA.badNode=DE,(UA=FA||(FA={})).SignatureType=u,UA.FunctionFlags=f,UA.OperatorId=TE,UA.WorksheetFuncId=$E,UA.SpecialPrecs=I,UA.functionType=p,UA.unknownFunctionType=ME,UA.getOperatorType=vv,UA.getWorksheetFuncType=Av,(PA=yA||(yA={})).isSheetIndex=Ov,PA.isSheetGridRange=Lv,PA.isGridCell=Cv,PA.isSheetGridCell=Fv,PA.gridRangeAnchor=Uv,PA.sheetGridRangeAnchor=yv,PA.gridCellRange=Pv,PA.getArguments=Vv,PA.getArgType=Gv,PA.isValidArgsLength=Hv,PA.operKind=bv,PA.ResultKind=gE,PA.success=Kv,PA.failure=Wv,PA.isSuccess=Xv,PA.ReasonKind=dE,PA.notImplemented=Yv,PA.unavailable=Jv,PA.columnName=$v,PA.formatRow=hv,PA.formatCol=Bv,PA.formatRowRange=xv,PA.formatColRange=qv,PA.formatCellPos=zv,PA.createResolver=rA,PA.createResolutionHandler=xA,PA.createNameFinder=qA,PA.defaultLiteralVisitor=cv,PA.defaultFormulaVisitor=kv,PA.dispatch=pv,PA.startVisit=lv,(GA=VA||(VA={})).localeInfo=EA,GA.calcConfig=ev,GA.initCalc=nv;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var SA=function(E,v){return(SA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,v){E.__proto__=v}||function(E,v){for(var A in v)v.hasOwnProperty(A)&&(E[A]=v[A])})(E,v)};function uA(E,v){function A(){this.constructor=E}SA(E,v),E.prototype=null===v?Object.create(v):(A.prototype=v.prototype,new A)}var IA=function(){return(IA=Object.assign||function(E){for(var v,A=1,N=arguments.length;A<N;A++)for(var O in v=arguments[A])Object.prototype.hasOwnProperty.call(v,O)&&(E[O]=v[O]);return E}).apply(this,arguments)};var fA,DA=yA.ReasonKind,sA=yA.notImplemented;!function(E){E.BadFormulaString="BadFormulaString"}(fA||(fA={}));var TA=IA({},DA,fA);function MA(E){return{kind:TA.BadFormulaString,message:E}}var gA=" \t\n\r";function dA(E){return gA.indexOf(E)>=0}function lA(E,v){return"\\"===v||"_"===v||E.isLetter(v)}function pA(E,v){return"."===v||lA(E,v)||E.isNumeral(v)}function cA(E,v){var A=v-1;return function(v){if(v<=A){var N=E+": internal error: no progress made at index "+v;return X.ULS.assertTag(595980821,U.LogCategory.msoulscat_ES_EWAJS,!1,N)}A=v}}function kA(E,v,A){for(var N=v;N<E.length&&A(E[N]);N+=1);return[E.substring(v,N),N]}function tA(E,v,A,N,O){var C=E[v];return A(C)?1:C===N&&O(E[v+1])?2:0}function aA(E,v,A,N,O){for(var C=[],L=v,F=v;F<E.length;){var U=tA(E,F,A,N,O);if(0===U)break;2===U&&(L!==F&&C.push(E.substring(L,F)),L=F+1),F+=U}return L!==F&&C.push(E.substring(L,F)),[C.join(""),F]}var iA,oA,eA,nA,EN=NA.nullErrorOper,vN=NA.div0ErrorOper,AN=NA.valueErrorOper,NN=NA.refErrorOper,ON=NA.nameErrorOper,CN=NA.numErrorOper,LN=NA.naErrorOper,FN=NA.gettingDataErrorOper,UN=FA.OperatorId;function yN(E,v,A){return{kind:E,start:v,chars:A}}!function(E){E[E.End=1]="End",E[E.Left=2]="Left",E[E.Right=3]="Right",E[E.Sep=4]="Sep",E[E.Operator=5]="Operator",E[E.Spaces=6]="Spaces",E[E.Ident=7]="Ident",E[E.CellRef=8]="CellRef",E[E.Literal=9]="Literal",E[E.SpecialRef=10]="SpecialRef",E[E.Unexpected=11]="Unexpected"}(iA||(iA={})),function(E){E[E.Paren=1]="Paren",E[E.Bracket=2]="Bracket",E[E.Brace=3]="Brace",E[E.SQuote=4]="SQuote"}(oA||(oA={})),function(E){E[E.List=1]="List",E[E.Row=2]="Row",E[E.Col=3]="Col",E[E.Qual=4]="Qual"}(eA||(eA={})),function(E){E[E.All=1]="All",E[E.Data=2]="Data",E[E.Headers=3]="Headers",E[E.Totals=4]="Totals",E[E.ThisRow=5]="ThisRow"}(nA||(nA={}));var PN=function(E){return yN(iA.End,E,"")},VN=function(E,v){return yN(iA.Spaces,E,v)},GN=function(E,v){return yN(iA.Unexpected,E,v)},HN=function(E,v){return yN(iA.Ident,E,v)};function bN(E,v,A,N){return{kind:E,start:v,chars:A,value:N}}var _N=function(E){return bN(iA.Left,E,"(",oA.Paren)},KN=function(E,v){return bN(iA.Left,E,v,oA.Bracket)},WN=function(E,v){return bN(iA.Left,E,v,oA.Brace)},XN=function(E){return bN(iA.Left,E,"'",oA.SQuote)},YN=function(E){return bN(iA.Right,E,")",oA.Paren)},JN=function(E,v){return bN(iA.Right,E,v,oA.Bracket)},jN=function(E,v){return bN(iA.Right,E,v,oA.Brace)},ZN=function(E){return bN(iA.Right,E,"'",oA.SQuote)},$N=function(E,v){return bN(iA.Sep,E,v,eA.List)},RN=function(E,v){return bN(iA.Sep,E,v,eA.Col)},hN=function(E,v){return bN(iA.Sep,E,v,eA.Row)},BN=function(E){return bN(iA.Sep,E,"!",eA.Qual)},wN={"#ALL":function(E,v){return bN(iA.SpecialRef,E,v,nA.All)},"#DATA":function(E,v){return bN(iA.SpecialRef,E,v,nA.Data)},"#HEADERS":function(E,v){return bN(iA.SpecialRef,E,v,nA.Headers)},"#TOTALS":function(E,v){return bN(iA.SpecialRef,E,v,nA.Totals)},"#THIS ROW":function(E,v){return bN(iA.SpecialRef,E,v,nA.ThisRow)}};function xN(E,v,A,N,O,C,L,F){return{kind:iA.CellRef,start:E,chars:v,row:A,col:N,refStyle:O,isName:C,isNumber:L,isQualPart:F}}function qN(E,v,A,N){void 0===N&&(N=!0);var O="number"==typeof A&&function(E){for(var v=0;v<E.length;v+=1)if("+"===E[v]||"-"===E[v])return!1;return!0}(v);return{kind:iA.Literal,start:E,chars:v,oper:A,hasRight:N,isQualPart:O}}var zN=[function(E,v){throw new Error("errorToken[0]: no error type 0")},function(E,v){return qN(E,v,EN)},function(E,v){return qN(E,v,vN)},function(E,v){return qN(E,v,AN)},function(E,v){return qN(E,v,NN)},function(E,v){return qN(E,v,ON)},function(E,v){return qN(E,v,CN)},function(E,v){return qN(E,v,LN)},function(E,v){return qN(E,v,FN)}];function QN(E,v,A){return 0===E.stringCompareCI(E.falseName,A)?qN(v,A,!1):0===E.stringCompareCI(E.trueName,A)?qN(v,A,!0):HN(v,A)}var mN=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"."];function rN(E){var v=mN[E];if(null==v)throw new Error("operatorTokenMaker: invalid operator "+E);return function(A){return{kind:iA.Operator,start:A,chars:v,value:E}}}var SN=rN(UN.Add),uN=rN(UN.Sub),IN=rN(UN.Mul),fN=rN(UN.Div),DN=rN(UN.Pow),sN=rN(UN.Percent),TN=rN(UN.Concat),MN=rN(UN.Eq),gN=rN(UN.Lt),dN=rN(UN.Gt),lN=rN(UN.Ne),pN=rN(UN.Le),cN=rN(UN.Ge),kN=rN(UN.Range);rN(UN.And),rN(UN.Or),rN(UN.Xor),rN(UN.Dot);function tN(E,v,A){return A.push(v),v.start+E}var aN=CA.PosKind,iN=CA.pos,oN=CA.RefStyle;function eN(E){return E>="a"&&E<="z"||E>="A"&&E<="Z"}function nN(E){return E.toUpperCase().charCodeAt(0)-65+1}function EO(E,v,A,N){for(var O=0,C=N,L=Math.min(A.length,N+v);C<L;C+=1){var F=A[C];if(!E.isNumeral(F))break;O=10*O+E.getOrdinal(F)}return C===L&&E.isNumeral(A[C])?[0,N]:[O,C]}function vO(E,v,A){return function(N,O,C,L){var F=function(E,v){return"$"===E[v]?[aN.Abs,v+1]:[aN.Rel,v]}(C,L),U=F[0],y=F[1],P=E(N,A,C,y),V=P[0],G=P[1];if(G>y){if(V<1||V>v)return;var H=U===aN.Rel?V-O:V;return[iN(U,H-1),!1,G]}return[void 0,!1,L]}}function AO(E,v,A){return function(N,O,C,L){var F=E?N.rowLetter:N.columnLetter;if(L>=C.length||0!==N.stringCompareCI(F,C[L]))return[void 0,!1,L];var U=L+1,y=EO(N,A,C,U),P=y[0],V=y[1];if(V>U){if(P<1||P>v)return;return[iN(aN.Abs,P-1),!1,V]}if(C[U]===N.leftBracket){var G=1;"+"===C[U+=1]?U+=1:"-"===C[U]&&(G=-1,U+=1);var H=EO(N,A,C,U),b=H[0],_=H[1];if(_>U&&b<v&&C[_]===N.rightBracket)return[iN(aN.Rel,b*G),!0,_+1]}return[!1,!1,V]}}function NO(E,v,A,N,O,C,L){var F=N(E,v,C,L);if(null==F)return[void 0,void 0,!1,L];var U=F[0],y=F[1],P=F[2];if(P>L){var V=O(E,A,C,P);if(null==V)return y?[U,void 0,!0,P]:[void 0,void 0,!1,L];var G=V[0],H=V[1],b=V[2];return b>P?[U,G,H,b]:[U,void 0,y,P]}var _=O(E,A,C,L);if(null==_)return[void 0,void 0,!1,L];var K=_[0],W=_[1],X=_[2];return X>L?[void 0,K,W,X]:[void 0,void 0,!1,L]}var OO=vO(EO,1048576,7),CO=vO(function(E,v,A,N){return function(E,v,A){for(var N=0,O=A,C=Math.min(v.length,A+E);O<C;O+=1){var L=v[O];if(!eN(L))break;N=26*N+nN(L)}return O===C&&eN(v[O])?[0,A]:[N,O]}(v,A,N)},16384,3),LO=AO(!0,1048576,7),FO=AO(!1,16384,5);function UO(E,v,A,N,O,C){var L,F,U,y,P,V=function(E,v,A,N,O){if(v===oN.A1&&null!=A){var C=A.range,L=NO(E,C.col,C.row,CO,OO,N,O),F=L[0],U=L[1],y=L[2],P=L[3];if((null!=U&&null!=F||null!=U&&U.kind===aN.Abs||null!=F&&F.kind===aN.Abs||(null!=U||null!=F)&&(":"===N[O-1]||":"===N[P]))&&(y||P>=N.length||!pA(E,N[P])))return[oN.A1,U,F,P]}var V=NO(E,void 0,void 0,LO,FO,N,O),G=V[0],H=V[1],b=V[2],_=V[3];if((null!=G||null!=H)&&(b||_>=N.length||!pA(E,N[_])))return[oN.R1C1,G,H,_]}(E,v,A,N,O);if(null!=V){var G=V[0],H=V[1],b=V[2],_=V[3],K=N.substring(_,O);return tN(_-O,G===oN.A1?function(E,v,A,N){var O=null==A&&null!=N&&N.kind===CA.PosKind.Rel,C=null==N&&null!=A&&A.kind===CA.PosKind.Rel,L=!(null!=A&&A.kind!==CA.PosKind.Rel||null!=N&&N.kind!==CA.PosKind.Rel);return xN(E,v,A,N,CA.RefStyle.A1,O,C,L)}(O,K,H,b):(L=O,F=K,y=b,P=!(!1!==(U=H)&&null!=U&&U.kind!==CA.PosKind.Abs||!1!==y&&null!=y&&y.kind!==CA.PosKind.Abs),xN(L,F,!1===U?CA.pos(CA.PosKind.Rel,0):U,!1===y?CA.pos(CA.PosKind.Rel,0):y,CA.RefStyle.R1C1,!1,!1,P)),C)}}var yO=NA.numErrorOper,PO=NA.ErrorTypeBounds,VO="+-*/^%&=<>:";function GO(E){return VO.indexOf(E)>=0}var HO={"+":SN,"-":uN,"*":IN,"/":fN,"^":DN,"%":sN,"&":TN,"=":MN,"<":gN,">":dN,":":kN},bO={"<>":lN,"<=":pN,">=":cN};function _O(E,v,A){if(v<E.length-1){var N=bO[E.substr(v,2)];if(null!=N)return tN(2,N(v),A)}var O=HO[E[v]];if(null!=O)return tN(1,O(v),A);return X.ULS.assertTag(595980822,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function KO(E,v,A,N){function O(A){var N=A,O=v[N];if("e"!==O&&"E"!==O)return A;if((N+=1)>=v.length)return A;if("+"===(O=v[N])||"-"===O){if((N+=1)>=v.length)return A;O=v[N]}if(!E.isNumeral(O))return A;for(N+=1;N<v.length&&E.isNumeral(v[N]);N+=1);return N}function C(A,N){var C=A,L=v[C];if(L===E.decimalSeparator){if((C+=1)>=v.length)return N?A:C;L=v[C]}if(!E.isNumeral(L))return N?A:O(C);for(C+=1;C<v.length;C+=1)if(!E.isNumeral(v[C]))return O(C);return C}for(var L=A;L<v.length;L+=1)if(!E.isNumeral(v[L])){L=C(L,L===A);break}if(L>A){var F=v.substring(A,L),U=E.parseNumber(F);return tN(L-A,qN(A,F,_v(U)?U:yO,!0),N),L}}function WO(E,v,A){var N=aA(E,v+1,function(E){return'"'!==E},'"',function(E){return'"'===E}),O=N[0],C=N[1],L=E.substring(v,C+1);return C<E.length?tN(C+1-v,qN(v,L,O,!0),A):tN(C-v,qN(v,L,O,!1),A)}function XO(E,v,A,N){for(var O=PO.First;O<=PO.Last;O+=1){var C=E.errorNames[O],L=v.substr(A,C.length),F=zN[O];if(0===E.stringCompareCI(C,L)&&null!=F)return tN(C.length,F(A,L),N)}}var YO=Object.getOwnPropertyNames(wN);function JO(E,v,A,N){for(var O=0;O<YO.length;O+=1){var C=YO[O],L=v.substr(A,C.length);if(L.toUpperCase()===C)return tN(C.length,wN[C](A,L),N)}}function jO(E,v){return"'"!==v&&"#"!==v&&v!==E.leftBracket&&v!==E.rightBracket}function ZO(E,v,A,N){var O=tN(1,KN(A,v[A]),N);"#"===v[O]&&(null!=(y=JO(0,v,O,N))&&(O=y));for(var C=function(v){return jO(E,v)},L=function(v){return!jO(E,v)},F=cA("calc.parse.tokenizeBracketedColRef",O);O<v.length;){F(O);var U=v[O];if(U===E.rightBracket)return tN(1,JN(O,U),N);if(tA(v,O,C,"'",L)>0){var y,P=aA(v,O,C,"'",L),V=P[0];O=tN((y=P[1])-O,HN(O,V),N)}else O=tN(1,GN(O,U),N)}return O}function $O(E,v){return!dA(v)&&"'"!==v&&"#"!==v&&":"!==v&&v!==E.listSeparator&&v!==E.leftBracket&&v!==E.rightBracket}function RO(E,v,A,N){var O=tN(1,KN(A,v[A]),N);"#"===v[O]&&(null!=(V=JO(0,v,O,N))&&(O=V));for(var C=function(v){return $O(E,v)},L=function(v){return!$O(E,v)},F=cA("calc.parse.tokenizeBracketedRef",O);O<v.length;){F(O);var U=v[O];if(U===E.rightBracket)return tN(1,JN(O,U),N);if(tA(v,O,C,"'",L)>0){var y=aA(v,O,C,"'",L),P=y[0];O=tN((V=y[1])-O,HN(O,P),N)}else if(dA(U)){var V,G=kA(v,O,dA);P=G[0];O=tN((V=G[1])-O,VN(O,P),N)}else O=":"!==U?U!==E.listSeparator?U!==E.leftBracket?tN(1,GN(O,U),N):ZO(E,v,O,N):tN(1,$N(O,U),N):tN(1,kN(O),N)}return O}var hO,BO="':*?";function wO(E,v,A,N){for(var O=tN(1,XN(A),N),C=function(v){return function(E,v){return BO.indexOf(v)<0&&v!==E.leftBracket&&v!==E.rightBracket}(E,v)},L=function(E){return"'"===E},F=cA("calc.parse.tokenizeQuotedQualifier",O);O<v.length;){F(O);var U=v[O];if("'"===U&&"'"!==v[O+1])return tN(1,ZN(O),N);if(":"!==U)if(U!==E.leftBracket)if(tA(v,O,C,"'",L)>0){var y=aA(v,O,C,"'",L),P=y[0];O=tN(y[1]-O,HN(O,P),N)}else O=tN(1,GN(O,U),N);else O=RO(E,v,O,N);else O=tN(1,kN(O),N)}return O}function xO(E,v,A,N){for(var O=E[v],C=v+1;C<E.length;C+=1){var L=E[C];if(L.kind!==A)break;O=N(O,L)}return[O,C]}function qO(E,v){return GN(E.start,E.chars+v.chars)}function zO(E,v,A,N,O){for(var C=function(E,v,A,N,O){for(var C=[],L=[],F=hO.Decimal,y=O,P=cA("calc.parse.tokenize",y);y<N.length;){P(y);var V=UO(E,v,A,N,y,C);if(null==V){var G=N[y];if(F===hO.Decimal&&G===E.decimalSeparator||E.isNumeral(G)){var H=KO(E,N,y,C);if(null!=H){y=H,F=hO.FieldAccess;continue}if(G!==E.decimalSeparator){var b="calc.parse.tokenize: failed to tokenize numeral at "+y;return X.ULS.assertTag(595980823,U.LogCategory.msoulscat_ES_EWAJS,!1,b)}}if('"'!==G)if(lA(E,G)){var _=kA(N,y,function(v){return pA(E,v)}),K=_[0];y=tN(_[1]-y,QN(E,y,K),C),F=hO.FieldAccess}else if("#"!==G)if(GO(G))y=_O(N,y,C),F=hO.Decimal;else if(dA(G)){var W=kA(N,y,dA);K=W[0],y=tN(W[1]-y,VN(y,K),C),F=hO.Decimal}else if("("!==G)if(")"!==G)if(G!==E.leftBrace)if(G!==E.rightBrace)if(G!==E.leftBracket)if(G!==E.rightBracket){if(L.length>0&&L[L.length-1]===oA.Brace){if(G===E.columnSeparator){y=tN(1,RN(y,G),C),F=hO.Decimal;continue}if(G===E.rowSeparator){y=tN(1,hN(y,G),C),F=hO.Decimal;continue}}G!==E.listSeparator?"!"!==G?"'"!==G?(y=tN(1,GN(y,G),C),F=hO.Decimal):(y=wO(E,N,y,C),F=hO.Decimal):(y=tN(1,BN(y),C),F=hO.Decimal):(y=tN(1,$N(y,G),C),F=hO.Decimal)}else y=tN(1,JN(y,G),C),F=hO.FieldAccess;else y=RO(E,N,y,C),F=hO.FieldAccess;else L.length>0&&L[L.length-1]===oA.Brace&&L.pop(),y=tN(1,jN(y,G),C),F=hO.FieldAccess;else L.push(oA.Brace),y=tN(1,WN(y,G),C),F=hO.Decimal;else L.length>0&&L[L.length-1]===oA.Paren&&L.pop(),y=tN(1,YN(y),C),F=hO.FieldAccess;else L.push(oA.Paren),y=tN(1,_N(y),C),F=hO.Decimal;else{var Y=XO(E,N,y,C);if(null!=Y){y=Y,F=hO.FieldAccess;continue}y=tN(1,GN(y,G),C),F=hO.Decimal}else y=WO(N,y,C),F=hO.FieldAccess}else y=V,F=hO.FieldAccess}return C}(E.config.localeInfo,v,A,N,O),L=[],F=0;F<C.length;){var y=C[F];if(y.kind!==iA.Unexpected)L.push(y),F+=1;else{var P=xO(C,F,iA.Unexpected,qO),V=P[0],G=P[1];L.push(V),F=G}}return L.push(PN(N.length)),L}function QO(E,v,A,N){var O=void 0;if(function(E){for(var v=E;null!=v;)v=v()}(E(v,A,N,function(E,v){O=[E,v]},function(){O=!1})),null==O){var C="calc.parse.runParser: internal error: parser did not call resolve or reject on "+H(v);return X.ULS.assertTag(595980827,U.LogCategory.msoulscat_ES_EWAJS,!1,C)}return O}function mO(E){return function(v,A,N,O,C){return O(E,A)}}!function(E){E[E.Decimal=1]="Decimal",E[E.FieldAccess=2]="FieldAccess"}(hO||(hO={}));var rO,SO=function(E,v,A,N,O){return O};function uO(E,v){return function(A,N,O,C,L){return E(A,N,O,function(E,N){return v(O,E)(A,N,O,C,L)},L)}}function IO(E,v){return function(A,N,O,C,L){return E(A,N,O,C,function(){return v(A,N,O,C,L)})}}function fO(E){return 0===E.length?SO:E.reduce(IO)}function DO(E,v){return function(A,N,O,C,L){return E(A,N,O,C,function(){return C(v,N)})}}function sO(E,v){return function(A,N,O,C,L){var F=A[N];if(null==F)return L;var U=E(O,F);return null==U?L:C(U,N+v)}}function TO(E){return sO(E,1)}function MO(E){return sO(E,0)}function gO(E){return function(v,A,N,O,C){var L=v[A],F=v[A+1];if(null==L||null==F)return C;var U=E(N,L,F);return null==U?C:O(U,A+1)}}function dO(E,v,A){return function(N,O,C,L,F){var y=A,P=O;function V(){return E(N,P,C,G,b)}function G(E,A){if(A<=P){var O=H(N),L="calc.parse.reduce: internal error: no progress made at index "+P+" on "+O;return X.ULS.assertTag(595980829,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}return y=v(C,E,y),P=A,V}function b(){return L(y,P)}return V}}function lO(E,v){return dO(E,function(E,v,A){return A.push(v),A},v)}function pO(E){return function(v,A,N,O,C){return lO(E,[])(v,A,N,O,C)}}function cO(E,v){return uO(E,function(E,A){return lO(v,[A])})}function kO(E){var v=E.length;return function(A,N,O,C,L){var F=N,U=[];function y(){return E[U.length](A,F,O,P,L)}function P(E,A){return F=A,U.push(E),U.length<v?y:C(U,F)}return y}}function tO(E,v){return kO([E,v])}function aO(E,v,A,N,O){return kO([E,v,A,N,O])}function iO(E,v){return function(A,N,O,C,L){return E(A,N,O,function(E,A){return C(v(O,E),A)},L)}}function oO(E,v,A){return iO(kO([E,v]),function(E,v){return A(E,v[0],v[1])})}function eO(E,v,A,N){return iO(kO([E,v,A]),function(E,v){return N(E,v[0],v[1],v[2])})}function nO(E,v,A,N,O){return iO(kO([E,v,A,N]),function(E,v){return O(E,v[0],v[1],v[2],v[3])})}function EC(E,v,A,N,O,C){return iO(kO([E,v,A,N,O]),function(E,v){return C(E,v[0],v[1],v[2],v[3],v[4])})}function vC(E,v){return oO(E,v,function(E,v,A){return v})}function AC(E,v){return oO(E,v,function(E,v,A){return A})}function NC(E,v){var A=E.spans[v.label];if(null==A){var N="calc.parse.getNodeSpan: internal error: expected node to have a span; given "+H(v);return X.ULS.assertTag(595980824,U.LogCategory.msoulscat_ES_EWAJS,!1,N)}return A}function OC(E,v,A,N,O){var C=E.label;return E.label+=1,E.spans[C]=CA.formulaSpan(v,A,N,O),C}function CC(E,v,A,N){var O=NC(E,A);return O.pre=v,O.post=N,A}function LC(E,v,A){return function(N,O,C,L,F){var U=C.leftDelim,y=C.listSep;return C.leftDelim=E,C.listSep=v,A(N,O,C,function(E,v){return C.leftDelim=U,C.listSep=y,L(E,v)},function(){return C.leftDelim=U,C.listSep=y,F})}}function FC(E,v){return v.kind===iA.Spaces||v.kind===iA.End?v.start:NC(E,v).start}!function(E){E[E.Union=1]="Union",E[E.Arg=2]="Arg"}(rO||(rO={}));var UC=DO(TO(function(E,v){return v.kind===iA.Spaces?v.chars:void 0}),"");function yC(E){return eO(UC,TO(E),UC,CC)}var PC=yC(function(E,v){return v.kind!==CA.NodeKind.Operator||v.id!==FA.OperatorId.Add&&v.id!==FA.OperatorId.Sub?void 0:v}),VC=oO(TO(function(E,v){if(v.kind===CA.NodeKind.Operator){if(v.id===FA.OperatorId.Add)return CA.operatorNode(FA.OperatorId.Pos,v.label);if(v.id===FA.OperatorId.Sub)return CA.operatorNode(FA.OperatorId.Neg,v.label)}}),UC,function(E,v,A){return CC(E,"",v,A)}),GC=yC(function(E,v){return v.kind!==CA.NodeKind.Operator||v.id!==FA.OperatorId.Mul&&v.id!==FA.OperatorId.Div?void 0:v}),HC=yC(function(E,v){return v.kind===CA.NodeKind.Operator&&v.id===FA.OperatorId.Pow?v:void 0}),bC=function(E){return oO(UC,TO(E),function(E,v,A){return CC(E,v,A,"")})}(function(E,v){return v.kind===CA.NodeKind.Operator&&v.id===FA.OperatorId.Percent?v:void 0}),_C=yC(function(E,v){return v.kind===CA.NodeKind.Operator&&v.id===FA.OperatorId.Concat?v:void 0}),KC=yC(function(E,v){return v.kind===CA.NodeKind.Operator&&v.id>=FA.OperatorId.Eq&&v.id<=FA.OperatorId.Ge?v:void 0}),WC=yC(function(E,v){return v.kind===CA.NodeKind.Operator&&v.id===FA.OperatorId.Range?v:void 0}),XC=yC(function(E,v){return v.kind===CA.NodeKind.Operator&&v.id===FA.OperatorId.Union?v:void 0}),YC=gO(function(E,v,A){if(v.kind===iA.Spaces&&A.kind!==iA.End&&A.kind!==CA.NodeKind.Operator){var N=OC(E,v.start,FC(E,A),v.chars,"");return CA.operatorNode(FA.OperatorId.Isect,N)}});function JC(E,v,A){return oO(E,pO(tO(v,E)),function(E,v,N){return 0===N.length?v:N.reduce(A(E),v)})}function jC(E){return function(v,A){var N=A[0],O=A[1],C=NC(E,v).start,L=NC(E,O).end,F=OC(E,C,L,"","");return CA.appNode(N,[v,O],!0,F)}}function ZC(E,v){var A=OC(E,NC(E,v[0]).start,NC(E,v[v.length-1]).end,"","");return CA.badNode(CA.BadType.Sequence,v,A)}var $C,RC,hC=JC(oO(function(E,v,A,N,O){var C=E[v];if(null==C){var L="calc.parse.pStart: internal error: expected term at "+v+" in "+H(E);return X.ULS.assertTag(595980864,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}return N(FC(A,C),v)},pO(TO(function(E,v){return v.kind!==CA.NodeKind.Operator&&v.kind!==iA.Spaces&&v.kind!==iA.End?v:void 0})),function(E,v,A){return 0===A.length?CA.literalNode(NA.missingOper,!0,OC(E,v,v,"","")):1===A.length?A[0]:ZC(E,A)}),WC,jC),BC=JC(hC,YC,jC),wC=JC(BC,XC,jC),xC=JC(($C=wC,RC=function(E){var v=!0;return function(A,N){var O=NC(E,N).start,C=NC(E,A).end,L=OC(E,O,C,"","");if(v&&(v=!1,A.kind===CA.NodeKind.Literal&&"number"==typeof A.oper)){var F=N.id===FA.OperatorId.Pos?A.oper:-A.oper;return CA.literalNode(F,!0,L)}return CA.appNode(N,[A],!0,L)}},oO(pO(VC),$C,function(E,v,A){return 0===v.length?A:v.reduceRight(RC(E),A)})),bC,function(E){return function(v,A){var N=A[0],O=A[1],C=NC(E,v).start,L=NC(E,N).end,F=OC(E,C,L,"",""),U=CA.appNode(N,[v],!0,F);return O.kind===CA.NodeKind.Literal&&yA.operKind(O.oper)===NA.OperKind.Missing?U:ZC(E,[U,O])}}),qC=JC(xC,HC,jC),zC=JC(qC,GC,jC),QC=JC(zC,PC,jC),mC=JC(QC,_C,jC),rC=JC(mC,KC,jC);var SC=DO(TO(function(E,v){return v.kind===iA.Spaces?v.chars:void 0}),""),uC=function(E,v,A,N,O){var C=E[v];if(null==C){var L="calc.parse.pStart: internal error: expected token at "+v+" in "+H(E);return X.ULS.assertTag(595980830,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}return N(C.start,v)};function IC(E){return TO(function(v,A){return A.kind===iA.Sep&&A.value===E||void 0})}function fC(E){return TO(function(v,A){return A.kind===iA.Left&&A.value===E?A.start:void 0})}function DC(E){return TO(function(v,A){return A.kind===iA.Right&&A.value===E||void 0})}var sC,TC=IC(eA.List),MC=IC(eA.Row),gC=IC(eA.Col),dC=IC(eA.Qual),lC=fC(oA.Paren),pC=DC(oA.Paren),cC=fC(oA.Brace),kC=DC(oA.Brace),tC=fC(oA.SQuote),aC=DC(oA.SQuote),iC=TO(function(E,v){return v.kind===iA.Operator&&v.value===FA.OperatorId.Range||void 0}),oC=sC={impl:function(E,v,A,N,O){return X.ULS.assertTag(595980828,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.delayed: internal error: unassigned DelayedParser")},parser:function(E,v,A,N,O){return function(){return sC.impl(E,v,A,N,O)}}},eC=eO(SC,oC.parser,SC,CC),nC=nO(lC,LC(oA.Paren,rO.Union,eC),DO(pC,!1),uC,function(E,v,A,N,O){var C=OC(E,v,O,"","");return CA.parenNode(A,N,C)}),EL=cO(eC,AC(gC,eC)),vL=cO(EL,AC(MC,EL)),AL=nO(cC,LC(oA.Brace,rO.Union,vL),DO(kC,!1),uC,function(E,v,A,N,O){var C=OC(E,v,O,"","");return CA.arrayNode(A,N,C)}),NL=TO(function(E,v){if(v.kind===iA.Ident||v.kind===iA.CellRef&&v.isQualPart||v.kind===iA.Literal&&v.isQualPart||v.kind===iA.Operator&&v.value===FA.OperatorId.Dot)return v.chars}),OL=cO(NL,NL),CL=TO(function(E,v){return v.kind===iA.Ident?v.chars:void 0});function LL(E){return E.kind===iA.Literal&&"object"==typeof E.oper&&E.oper.kind===NA.OperKind.Error&&E.oper.type===NA.ErrorType.REF}function FL(E,v,A,N){return null==v?[CA.identQualifier(E,A,N),A?"'"+E+"'":E]:[CA.sheetRangeQualifier(E,v,A,N),A?"'"+E+":"+v+"'":E+":"+v]}var UL=nO(uC,OL,DO(AC(iC,OL),void 0),uC,function(E,v,A,N,O){var C=OC(E,v,O,"","");return FL(A.join(""),null!=N?N.join(""):void 0,!1,C)}),yL=EC(tC,CL,DO(AC(iC,CL),void 0),aC,uC,function(E,v,A,N,O,C){return FL(A,N,!0,OC(E,v,C,"",""))}),PL=nO(tC,pO(TO(function(E,v){return v.kind===iA.End||v.kind===iA.Right&&v.value===oA.SQuote?void 0:v.chars})),DO(tO(aC,DO(vC(dC,SC),!1)),[!1,!1]),uC,function(E,v,A,N,O){var C=N[0],L=N[1],F="'"+A.join("")+(C?"'":"")+(L?"!":""),U=OC(E,v,O,"","");return[CA.badNode(CA.BadType.Qualifier,F,U),F]}),VL=gO(function(E,v,A){if(LL(v)){var N=OC(E,v.start,A.start,"","");return[CA.errorQualifierLabeled(N),v.chars]}}),GL=oO(fO([UL,yL,MO(function(E,v){var A=OC(E,v.start,v.start,"","");return[CA.relativeQualifierLabeled(A),""]})]),vC(dC,SC),function(E,v,A){return[v[0],v[1]+"!"]}),HL=fO([VL,GL,PL]);function bL(E,v){return v.kind===iA.CellRef&&E.refStyle===v.refStyle}var _L=gO(function(E,v,A){return bL(E,v)?[v,A.start]:void 0});function KL(E,v){if(null!=E.row&&null!=E.col)return CA.cellRefSingle(E.row,E.col,v);if(null!=E.row)return CA.cellRefRow(E.row,E.row,v);if(null!=E.col)return CA.cellRefCol(E.col,E.col,v);var A="calc.parse.cellRefToken2cellRef: bad token "+H(E);return X.ULS.assertTag(595980831,U.LogCategory.msoulscat_ES_EWAJS,!1,A)}var WL=gO(function(E,v,A){if(bL(E,v)&&(v.refStyle!==CA.RefStyle.A1||null!=v.row&&null!=v.col))return KL(v,N=OC(E,v.start,A.start,"",""));if(LL(v)){var N=OC(E,v.start,A.start,"","");return CA.cellRefErrorLabeled(N)}}),XL=IO(uO(aO(_L,SC,iC,SC,_L),function(E,v){var A=v[0],N=A[0],O=A[1],C=v[1],L=(v[2],v[3]),F=v[4],U=F[0],y=F[1],P=OC(E,N.start,O,"",C),V=OC(E,U.start,y,L,""),G=KL(N,P),H=KL(U,V),b=void 0;if(G.kind===CA.CellRefKind.Single&&H.kind===CA.CellRefKind.Single){var _=OC(E,N.start,y,"","");b=CA.cellRefRange(G,H,_)}else if(0===C.length&&0===L.length)if(G.kind===CA.CellRefKind.Row&&H.kind===CA.CellRefKind.Row){_=OC(E,N.start,y,"","");b=CA.cellRefRow(G.row1,H.row1,_)}else if(G.kind===CA.CellRefKind.Col&&H.kind===CA.CellRefKind.Col){_=OC(E,N.start,y,"","");b=CA.cellRefCol(G.col1,H.col1,_)}return null==b?SO:N.isQualPart&&U.isQualPart?MO(function(E,v){return v.kind===iA.Sep&&v.value===eA.Qual?void 0:b}):mO(b)}),WL),YL=TO(function(E,v){return v.kind===iA.Ident||v.kind===iA.CellRef&&v.isName?v.chars:void 0}),JL=uO(aO(uC,HL,uC,DO(IO(XL,YL),void 0),uC),function(E,v){var A=v[0],N=v[1],O=N[0],C=N[1],L=v[2],F=v[3],U=v[4];if(null==F)return O.kind!==CA.QualifierKind.SheetRange||O.isQuoted?O.kind===CA.QualifierKind.Error?mO(CA.literalNode(NA.refErrorOper,!0,O.label)):mO(O.kind===CA.NodeKind.Bad?O:CA.badNode(CA.BadType.Qualifier,C,O.label)):SO;if("string"==typeof F){if(O.kind===CA.QualifierKind.SheetRange&&!O.isQuoted)return SO;var y=OC(E,A,U,"","");if(O.kind===CA.NodeKind.Bad||O.kind===CA.QualifierKind.Error||O.kind===CA.QualifierKind.SheetRange){var P=O.kind===CA.NodeKind.Bad?O:CA.badNode(CA.BadType.Qualifier,C,O.label),V=CA.nameNode(F,void 0,OC(E,L,U,"",""));return mO(CA.badNode(CA.BadType.Sequence,[P,V],y))}return mO(CA.nameNode(F,O,y))}var G=OC(E,A,U,"","");if(O.kind===CA.NodeKind.Bad||O.kind===CA.QualifierKind.Document){var H=O.kind===CA.NodeKind.Bad?O:CA.badNode(CA.BadType.Qualifier,C,O.label);V=CA.cellRefNode(F,void 0,OC(E,L,U,"",""));return mO(CA.badNode(CA.BadType.Sequence,[H,V],G))}var b=O.kind===CA.QualifierKind.Ident?CA.sheetQualifier(O.name,void 0,O.isQuoted,O.label):O;return mO(CA.cellRefNode(F,b,G))}),jL=eO(uC,IO(XL,YL),uC,function(E,v,A,N){var O=OC(E,v,N,"","");return"string"==typeof A?CA.nameNode(A,void 0,O):A.kind===CA.CellRefKind.Error?CA.literalNode(NA.refErrorOper,!0,O):CA.cellRefNode(A,void 0,O)}),ZL=gO(function(E,v,A){if(v.kind===iA.Literal)return CA.literalNode(v.oper,v.hasRight,OC(E,v.start,A.start,"",""));if(v.kind===iA.CellRef&&v.isNumber&&"object"==typeof v.row&&null!=E.range){var N=v.row.index+E.range.range.row+1;return CA.literalNode(N,!0,OC(E,v.start,A.start,"",""))}});function $L(E){return gO(function(v,A,N){if(E(A)){var O=OC(v,A.start,N.start,"","");return CA.badNode(CA.BadType.Unexpected,A.chars,O)}})}var RL=$L(function(E){return E.kind===iA.Left&&E.value===oA.Bracket}),hL=$L(function(E){return E.kind===iA.Right&&E.value===oA.Bracket}),BL=EC(uC,RL,LC(oA.Bracket,rO.Union,eC),DO(hL,void 0),uC,function(E,v,A,N,O,C){var L=[A,N];null!=O&&L.push(O);var F=OC(E,v,C,"","");return CA.badNode(CA.BadType.Sequence,L,F)}),wL=gO(function(E,v,A){switch(v.kind){case iA.End:case iA.Operator:case iA.Spaces:return;case iA.Sep:if(v.value!==eA.Qual&&(E.leftDelim===oA.Brace||v.value!==eA.Col&&v.value!==eA.Row))return;break;case iA.Right:if(v.value===E.leftDelim)return}var N=v.kind===iA.CellRef?CA.BadType.CellRef:CA.BadType.Unexpected,O=OC(E,v.start,A.start,"","");return CA.badNode(N,v.chars,O)}),xL=gO(function(E,v,A){if((v.kind===iA.Ident||v.kind===iA.CellRef)&&A.kind===iA.Left&&A.value===oA.Paren&&null!=E.localeInfo.getWorksheetFuncId(v.chars)){var N=OC(E,v.start,A.start,"","");return CA.nameNode(v.chars,void 0,N)}}),qL=nO(lC,LC(oA.Paren,rO.Arg,cO(eC,AC(TC,eC))),DO(pC,!1),uC,function(E,v,A,N,O){return[A,N,O]}),zL=oO(xL,qL,function(E,v,A){var N=A[0],O=A[1],C=A[2],L=OC(E,NC(E,v).start,C,"","");return CA.appNode(v,N,O,L)}),QL=oO(fO([zL,JL,jL,ZL,nC,AL,BL,wL]),pO(qL),function(E,v,A){var N=NC(E,v).start;return A.reduce(function(v,A){var O=A[0],C=A[1],L=A[2],F=OC(E,N,L,"","");return CA.appNode(v,O,C,F)},v)}),mL=gO(function(E,v,A){var N=void 0;if(v.kind===iA.Operator&&(N=v.value),v.kind===iA.Sep&&v.value===eA.List&&E.listSep===rO.Union&&(N=FA.OperatorId.Union),null!=N){var O=OC(E,v.start,A.start,"","");return CA.operatorNode(N,O)}}),rL=TO(function(E,v){return v.kind===iA.Spaces?v:void 0}),SL=IO(QL,mL),uL=uO(SL,function(E,v){return dO(tO(DO(rL,void 0),SL),function(E,v,A){var N=v[0],O=v[1];return null!=N&&A.push(N),A.push(O),A},[v])}),IL=oO(DO(uL,void 0),uC,function(E,v,A){if(null==v){var N=OC(E,A,A,"","");return CA.literalNode(NA.missingOper,!0,N)}if(1===v.length){var O=v[0];if(O.kind!==CA.NodeKind.Operator&&O.kind!==iA.Spaces)return O}return v.push(PN(A)),function(E,v){var A=E.length-1;if(A<0){var N="calc.parse.parseTerms: internal error: expected at least 1 term";return X.ULS.assertTag(595980865,U.LogCategory.msoulscat_ES_EWAJS,!1,N)}if(E[0].kind===iA.Spaces)return N="calc.parse.parseTerms: internal error: array[0].kind === Spaces in "+H(E),X.ULS.assertTag(595980866,U.LogCategory.msoulscat_ES_EWAJS,!1,N);if(A-1>=0&&E[A-1].kind===iA.Spaces)return N="calc.parse.parseTerms: internal error: array[n-1].kind === Spaces in "+H(E),X.ULS.assertTag(595980867,U.LogCategory.msoulscat_ES_EWAJS,!1,N);if(E[A].kind!==iA.End)return N="calc.parse.parseTerms: internal error: array[n].kind !== End in "+H(E),X.ULS.assertTag(595980868,U.LogCategory.msoulscat_ES_EWAJS,!1,N);var O=QO(rC,E,0,v);if(!1===O)return N="calc.parse.parseTerms: internal error: failed to parse "+H(E),X.ULS.assertTag(595980869,U.LogCategory.msoulscat_ES_EWAJS,!1,N);var C=O[0],L=O[1];if(L<A)return N="calc.parse.parseTerms: internal error: consumed "+L+" out of "+A+" in "+H(E),X.ULS.assertTag(595980870,U.LogCategory.msoulscat_ES_EWAJS,!1,N);return C}(v,E)});function fL(E,v,A,N,O){var C=O.length-1;if(C<0){var L="calc.parse.parseTokens: internal error: expected at least 1 token";return X.ULS.assertTag(595980832,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}if(O[C].kind!==iA.End){L="calc.parse.parseTokens: internal error: array[n] !== End in "+H(O);return X.ULS.assertTag(595980833,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}var F=function(E,v,A,N){return{localeInfo:E,refStyle:v,range:A,source:N,leftDelim:void 0,listSep:rO.Union,label:1,spans:{}}}(E.config.localeInfo,v,A,N),y=QO(eC,O,0,F);if(!1===y){L="calc.parse.parseTokens: internal error: failed to parse "+H(O);return X.ULS.assertTag(595980834,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}var P=y[0],V=y[1];if(V<C){L="calc.parse.parseTokens: internal error: consumed "+V+" out of "+C+" in "+H(O);return X.ULS.assertTag(595980835,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}return CA.formula(P,F.spans)}oC.impl=IL;var DL={"=":1,"+":0,"-":0,"@":-1};function sL(E){return{parseFormula:function(v,A,N,O){return function(E,v,A,N,O){var C=O[0],L=null!=C?DL[C]:void 0;if(null==L)return yA.failure(MA("first character is not '=', '+', '-' or '@'"));if(L<0)return yA.failure(sA(["Lotus 1-2-3 syntax"]));if(v===CA.RefStyle.A1&&null==A)return X.ULS.assertTag(595980825,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.parseFormula: in A1 style, expected range to be defined");var F=fL(E,v,A,N,zO(E,v,A,O,L));return yA.success(F)}(E,v,A,N,O)},formatFormula:function(E,v,A,N){return function(E,v,A,N,O){if(v===CA.RefStyle.A1&&null==A)return X.ULS.assertTag(595980826,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.formatFormula: in A1 style, expected range to be defined");return yA.failure(sA(["formatFormula"]))}(0,E,v)}}}var TL=CA.QualifierKind,ML=CA.CellRefKind,gL=CA.NodeKind,dL=yA.ResultKind;function lL(E){return E.kind===dL.Success}function pL(E,v){var A=E[v];return null==A?j("ParseResultHelper.getFormulaSpan: expected span for label "+v+" to be defined"):A}function cL(E,v,A){return!!lL(E)&&(function(E,v,A){if(null==E||null==A)return;var N={};null!=v?v.forEach(function(E){N[E]=!0}):N["*"]=!0;var O=[];O.push(E.node);for(;O.length>0;){var C=O.pop();if(null!=C)switch(C.kind){case gL.Literal:U("literal")&&A("literal",{label:C.label,value:C});break;case gL.Array:C.nodes.map(function(E){return E.map(function(E){O.push(E)})});break;case gL.App:if("object"!=typeof C.head)U("literal")&&A("literal",{label:C.label,value:C.head});else{var L=C.head;switch(L.kind){case gL.Operator:U("operator")&&A("operator",{label:C.label,value:L.id});break;case gL.Name:U("function")&&A("function",{label:C.label,name:L.whole});break;default:O.push(L)}}C.args.map(function(E){O.push(E)});break;case gL.Paren:O.push(C.node);break;case gL.Name:if(U("namedRange")){var F=C.whole.split(".");A("namedRange",{label:C.label,name:F[0],names:F.slice(1),qualifier:y(C)})}break;case gL.CellRef:U("range")&&P(C);break;case gL.Bad:break;default:return J("calc.parse.traverseFormula",C)}}function U(E){return N[E]||N["*"]}function y(E){if(null!=E.qualifier){var v={};switch(E.qualifier.kind){case TL.Sheet:var A=E.qualifier;v.type=TL.Sheet,v.sheet=A.sheet,null!=A.document&&(v.document=A.document.document,null!=A.document.path&&(v.documentPath=A.document.path));break;case TL.SheetRange:var N=E.qualifier;v.type=TL.SheetRange,v.sheet1=N.sheet1,v.sheet2=N.sheet2;break;case TL.Ident:var O=E.qualifier;v.type=TL.Ident,v.name=O.name;break;case TL.Document:var C=E.qualifier;v.document=C.document,null!=C.path&&(v.documentPath=C.path)}return v}}function P(v){if(null!=E&&null!=A)switch(v.ref.kind){case ML.Error:break;case ML.Col:var N=v.ref;A("range",{label:v.label,type:"col",startIndex:N.col1,endIndex:N.col2,span:pL(E.spans,N.label),qualifier:y(v)});break;case ML.Row:var O=v.ref;A("range",{label:v.label,type:"row",startIndex:O.row1,endIndex:O.row2,span:pL(E.spans,O.label),qualifier:y(v)});break;case ML.Single:var C=v.ref;A("range",{label:v.label,type:"cell",row:C.row,col:C.col,span:pL(E.spans,C.label),qualifier:y(v)});break;case ML.Range:var L=v.ref;A("range",{label:v.label,type:"range",top:L.ref1.row,left:L.ref1.col,bottom:L.ref2.row,right:L.ref2.col,topLeftSpan:pL(E.spans,L.ref1.label),bottomRightSpan:pL(E.spans,L.ref2.label),qualifier:y(v)})}}}(E.value,v,A),!0)}var kL,tL={isSuccess:lL,traverse:cL,extractReferences:function(E){if(lL(E)){var v=[];return cL(E,["range","namedRange"],function(A,N){var O={kind:A,ref:N,span:pL(E.value.spans,N.label)};v.push(O)}),v.sort(function(E,v){return E.span.start-v.span.start}),v}}};!function(E){E[E.SyntaxError=0]="SyntaxError",E[E.TypeError=1]="TypeError"}(kL||(kL={}));var aL={Unclosed_expression:{code:1,category:kL.SyntaxError},Illegal_array_literal_element:{code:2,category:kL.SyntaxError},Empty_array_literal:{code:3,category:kL.SyntaxError},Irregular_array_shape:{code:4,category:kL.SyntaxError},Empty_parenthesis:{code:5,category:kL.SyntaxError},Missing_operation_argument:{code:6,category:kL.SyntaxError},Bad_node:{code:7,category:kL.SyntaxError},Invalid_binder:{code:8,category:kL.SyntaxError},Empty_formula:{code:9,category:kL.SyntaxError},Invalid_rel_sheet_qualifier_in_cell:{code:10,category:kL.SyntaxError},Types_not_related:{code:1001,category:kL.TypeError},Unexpected_application_head:{code:1002,category:kL.TypeError},Unexpected_application_head_with_fix:{code:1003,category:kL.TypeError},Incorrect_number_of_operator_arguments:{code:1004,category:kL.TypeError},Excess_function_arguments:{code:1005,category:kL.TypeError},Insufficient_function_arguments:{code:1006,category:kL.TypeError}},iL=CA.NodeKind,oL=CA.QualifierKind,eL=CA.BadType,nL=CA.CellRefKind,EF=vA.FormulaSource,vF=NA.OperKind,AF=NA.ErrorType,NF=FA.SignatureType,OF=FA.SpecialPrecs,CF=FA.getOperatorType,LF=FA.WorksheetFuncId,FF=FA.getWorksheetFuncType,UF=yA.operKind,yF=yA.getArguments,PF=yA.getArgType,VF=yA.defaultLiteralVisitor,GF=yA.defaultFormulaVisitor,HF=yA.dispatch,bF=yA.startVisit,_F={};function KF(E,v){return{context:E,result:v}}function WF(E){return function(v){return v.kind===iL.Literal&&E(v.oper)}}var XF=WF(function(E){return UF(E)===vF.Missing}),YF=WF(function(E){return UF(E)===vF.Error&&E.type===AF.REF}),JF=WF(function(E){return 0!=(UF(E)&(vF.String|vF.Error|vF.Boolean))});function jF(E){return E.kind===iL.Name&&void 0===E.qualifier}function ZF(E,v,A,N){void 0===N&&(N=!1),N||(E.errorData=E.reportError(v,A,E.errorData))}function $F(E,v){return v!==vF.Range||0!=(E&vF.Range)}function RF(E,v){if(v.kind===iL.Literal)switch(ZF(E,v,aL.Unclosed_expression,v.isClosed),UF(v.oper)){case vF.Number:case vF.Boolean:case vF.String:case vF.Error:return;default:return void ZF(E,v,aL.Illegal_array_literal_element)}ZF(E,v,aL.Illegal_array_literal_element)}function hF(E,v,A){ZF(E,v,aL.Types_not_related,$F(vF.Array,A)),ZF(E,v,aL.Unclosed_expression,v.isClosed);var N=v.nodes.length>0;if(ZF(E,v,aL.Empty_array_literal,N),!N)return KF(E,A);for(var O=v.nodes[0].length,C=0;C<v.nodes.length;C+=1){var L=v.nodes[C],F=L.length;ZF(E,v,aL.Irregular_array_shape,F===O);for(var U=0;U<F;U+=1)RF(E,L[U])}return KF(E,A)}function BF(E,v,A){if(E.earlyExit&&!E.isOk())throw _F;switch(v.kind){case iL.Array:return hF(E,v,A);case iL.Paren:return ZF(E,v,aL.Unclosed_expression,v.isClosed),ZF(E,v,aL.Empty_parenthesis,!XF(v.node)),BF(E,v.node,A);case iL.Bad:case iL.Name:case iL.CellRef:case iL.App:case iL.Literal:var N=qF(E,v);return ZF(E,v,aL.Types_not_related,$F(N.result,A)),N.result=A,N;default:return J("calc.analyze.checker.check: unhandled formula case",v)}}function wF(E,v,A){var N,O=FF(v),C=A.args,L=C.length,F=yF(A),U=F.length,y=E.isOk();U<O.minArgs&&ZF(E,void 0===(N=C[L-1])?A:N,aL.Insufficient_function_arguments);0===O.restTypes.length&&U>O.headTypes.length&&ZF(E,void 0===(N=C[L-1])?A:N,aL.Excess_function_arguments);O.restTypes.length>1&&v!==LF.SWITCH&&((U-O.headTypes.length)%O.restTypes.length!=0&&ZF(E,void 0===(N=C[L-1])?A:N,aL.Insufficient_function_arguments));for(var P=0;P<U;P+=1)BF(E,F[P],PF(O,P));var V=!y||E.isOk();return V&&(E.specialDependencies|=O.staticPrecs,function(E,v,A){switch(v){case LF.LET:var N=A[0];return void 0!==N?ZF(E,N,aL.Invalid_binder,jF(N)):J("calc.anaylze.checker.applySpecificWorksheetFunctionChecks: undefined binder",N);case LF.FUN:for(var O=0;O<A.length-1;O+=1){var C=A[O];ZF(E,C,aL.Invalid_binder,jF(C))}}}(E,v,C)),KF(E,V?O.returnType:NF.All)}function xF(E,v){ZF(E,v,aL.Unclosed_expression,v.isClosed);var A=v.args;if(v.head.kind===iL.Operator)return function(E,v,A){var N=CF(v.id),O=A.length,C=O===N.minArgs;ZF(E,v,aL.Incorrect_number_of_operator_arguments,C);for(var L=0;L<O;L+=1){var F=A[L];XF(F)&&(C=!1,ZF(E,F,aL.Missing_operation_argument)),BF(E,F,PF(N,L))}return C?(E.specialDependencies|=N.staticPrecs,KF(E,N.returnType)):KF(E,NF.All)}(E,v.head,A);if(jF(v.head)){var N=E.globals.config.localeInfo.getWorksheetFuncId(v.head.whole.toLocaleUpperCase());if(void 0!==N)return wF(E,N,v)}for(var O=0;O<A.length;O+=1)BF(E,A[O],NF.All);var C=v.head,L=qF(E,C);return $F(L.result,vF.Range)||L.result===vF.Error&&function(E){for(var v=E;v.kind===iL.Paren;)v=v.node;return YF(v)}(C)?KF(E,NF.All):(ZF(E,C,JF(C)||C.kind===iL.Array?aL.Unexpected_application_head:aL.Unexpected_application_head_with_fix),KF(E,NF.All))}function qF(E,v){if(E.earlyExit&&!E.isOk())throw _F;switch(v.kind){case iL.App:return xF(E,v);case iL.Array:return hF(E,v,vF.Array);case iL.Bad:return ZF(E,v,aL.Bad_node),KF(E,NF.All);case iL.CellRef:return E.source!==EF.Cell&&E.source!==EF.Range||void 0===v.qualifier||v.qualifier.kind!==oL.Relative?KF(E,vF.Range):(ZF(E,v,aL.Invalid_rel_sheet_qualifier_in_cell),KF(E,NF.All));case iL.Literal:return ZF(E,v,aL.Unclosed_expression,v.isClosed),KF(E,UF(v.oper));case iL.Name:return KF(E,NF.All);case iL.Paren:return ZF(E,v,aL.Unclosed_expression,v.isClosed),ZF(E,v,aL.Empty_parenthesis,!XF(v.node)),qF(E,v.node);default:return J("calc.analyze.checker.infer: unhandled formula case",v)}}var zF={ok:!0,isOk:fv,collect:function(E,v,A){return!1}};function QF(E,v,A,N,O){void 0===O&&(O=!0);var C={globals:E,location:v,source:A,reportError:N.collect,isOk:function(){return N.isOk(C.errorData)},earlyExit:O,specialDependencies:OF.None,errorData:N.ok};return C}function mF(E,v){try{return ZF(E,v.node,aL.Empty_formula,!XF(v.node)),BF(E,v.node,NF.All)}catch(v){return v!==_F&&X.ULS.traceTag(595952020,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"Exception in calc.analyze.check.runChecker: "+H(v)),KF(E,NF.All)}}function rF(E,v){if(v.kind!==iL.Bad||v.type!==eL.Sequence||3!==v.contents.length)return!1;var A=v.contents[0],N=v.contents[2];return A.kind===iL.Bad&&A.type===eL.Unexpected&&A.contents===E.leftBracket&&(N.kind===iL.Bad&&N.type===eL.Unexpected&&N.contents===E.rightBracket)}function SF(E,v){if(2===v.length){var A,N=v[0],O=v[1];return rF(E,N)?(A=O).kind===iL.Name&&null!=A.qualifier&&A.qualifier.kind===oL.Ident?iL.Name:function(E){return E.kind===iL.CellRef&&null!=E.qualifier&&E.qualifier.kind===oL.Sheet&&null==E.qualifier.document}(O)?iL.CellRef:void 0:function(E,v){return v.kind===iL.Bad&&v.type===eL.Qualifier&&v.contents.indexOf(E.leftBracket)>=0}(E,N)?jF(O)?iL.Name:function(E){return E.kind===iL.CellRef&&null==E.qualifier}(O)?iL.CellRef:void 0:void 0}}function uF(E){if(E.kind===iL.Literal&&E.isClosed)switch(UF(E.oper)){case vF.Number:case vF.Boolean:case vF.String:case vF.Error:return!0;default:return!1}return!1}function IF(E,v){var A=v.head,N=A.kind!==iL.Operator;if(!v.isClosed||v.args.some(function(v){return!fF(E,v,N)}))return!1;if(A.kind===iL.Operator)return(C=CF(A.id)).minArgs===v.args.length;if(!fF(E,A,!1))return!1;if(jF(A)){var O=E.config.localeInfo.getWorksheetFuncId(A.whole.toLocaleUpperCase());if(void 0!==O){var C=FF(O),L=yF(v).length;if(L<C.minArgs)return!1;if(0===C.restTypes.length&&L>C.headTypes.length)return!1;if(C.restTypes.length>1&&O!==LF.SWITCH)if((L-C.headTypes.length)%C.restTypes.length!=0)return!1;return function(E,v){switch(E){case LF.LET:return jF(v[0]);case LF.FUN:return v.slice(0,v.length-1).every(jF);default:return!0}}(O,v.args)}}return!0}function fF(E,v,A){switch(v.kind){case iL.Literal:return v.isClosed&&(!!A||UF(v.oper)!==vF.Missing);case iL.Name:case iL.CellRef:return!0;case iL.Array:return v.isClosed&&v.nodes.length>0&&v.nodes.every(function(E){return A=E,N=v.nodes[0].length,A.length===N&&A.every(uF);var A,N});case iL.App:return IF(E,v);case iL.Paren:return v.isClosed&&fF(E,v.node,!1);case iL.Bad:return!1;default:return J("calc.analyze.isWF",v)}}function DF(E,v,A){switch(v.kind){case iL.Literal:case iL.Name:break;case iL.CellRef:v.ref.kind===nL.Row&&(A.rowRef+=1),v.ref.kind===nL.Col&&(A.colRef+=1);break;case iL.Array:v.nodes.forEach(function(v){return v.forEach(function(v){return DF(E,v,A)})});break;case iL.App:v.head.kind!==iL.Operator&&DF(E,v.head,A),v.args.forEach(function(v){return DF(E,v,A)});break;case iL.Paren:DF(E,v.node,A);break;case iL.Bad:if(v.type===eL.Sequence){var N=v.contents;if(function(E,v){return 2===v.length&&jF(v[0])&&rF(E,v[1])}(E,N))A.structRef+=1;else{var O=SF(E,N);null!=O?(O===iL.Name?A.docQualName+=1:O===iL.CellRef&&(A.docQualCellRef+=1),DF(E,N[1],A)):N.forEach(function(v){return DF(E,v,A)})}}else v.type===eL.Qualifier&&(A.badQual+=1);break;default:return J("calc.analyze.collectRefStats",v)}}var sF=GF(VF(function(E){return 1}),function(E){return 1},{vArray:function(E){var v=-1;return E.nodes.forEach(function(E){E.forEach(function(E){var A=HF(E,sF);v=Math.max(v,A)})}),1+v},vRange:function(E){var v=HF(E.ref1,sF),A=HF(E.ref2,sF);return 1+Math.max(v,A)},vBad:function(E){if(E.type===eL.Sequence){var v=-1;return E.contents.forEach(function(E){var A=HF(E,sF);v=Math.max(v,A)}),1+v}return 1},vCellRef:function(E){var v=-1;if(void 0!==E.qualifier){var A=HF(E.qualifier,sF);v=Math.max(v,A)}return 1+Math.max(v,HF(E.ref,sF))},vParen:function(E){return 1+HF(E.node,sF)},vApp:function(E){var v=-1;return E.args.forEach(function(E){var A=HF(E,sF);v=Math.max(v,A)}),1+v}});var TF=[];function MF(E,v,A,N,O){var C,L={rowRef:0,colRef:0,structRef:0,docQualName:0,docQualCellRef:0,badQual:0};if(DF(E.config.localeInfo,N.node,L),L.rowRef+L.colRef+L.structRef+L.docQualName+L.docQualCellRef+L.badQual>0&&X.ULS.traceTag(595961670,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.analyze.checkFormula: possible unsupported references; operation: "+O+"; anonymize: "+H(N.node)+"; stats = "+JSON.stringify(L)),uv(Qv.CalcStrictFormulaChecking))if(TF.length<10){var F=(C=N.node,bF(C,sF,-1));TF.push(F)}else X.ULS.traceTag(595957962,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.analyze.checkFormula: 10 tree depths = "+TF.join("; ")),TF=[];var y=uv(Qv.CalcStrictFormulaChecking)?function(E,v,A,N){return mF(QF(E,v,A,zF),N).context.errorData}(E,v,A,N):fF(E,N.node,!1);return y||function(E){E.kind!==iL.App||E.isClosed||X.ULS.traceTag(595949718,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.analyze.tracePossibleFixes: formula missing paren that could be automatically closed")}(N.node),IA({},N,{isWellFormed:y})}var gF,dF,lF=NA.SpecialPrecs,pF=NA.precedents;function cF(E){return{findStaticPrecedents:function(E){return pF([],[],lF.All,!1)},checkFormula:function(v,A,N,O){return MF(E,v,A,N,void 0!==O?O:"undefined")},checkFormulaWithCodes:function(v,A,N){return function(E,v,A,N){return mF(QF(E,v,A,{ok:[],isOk:function(E){return 0===E.length},collect:function(E,v,A){return A.push({label:E.label,errorCode:v.code}),A}},!1),N).context.errorData}(E,v,A,N)},findBestFormat:function(E,v,A){A.node}}}!function(E){E.WorksheetFunction="WorksheetFunction"}(gF||(gF={})),function(E){E.RangeValues="RangeValues"}(dF||(dF={}));var kF=NA.div0ErrorOper,tF=NA.numErrorOper,aF=Math.pow(2,-52),iF=Math.pow(2,-1022);function oF(E){return Math.abs(E)<iF?0:E}function eF(E){return isFinite(E)?oF(E):tF}var nF=Math.pow(2,32)-2;function EU(E,v){var A=Math.pow(E,v);return isFinite(A)?oF(A):v<0?kF:tF}var vU,AU,NU,OU={sqrt:function(E){return eF(Math.sqrt(E))},sqrtpi:function(E){return eF(function(E){var v=E*Math.PI;return isFinite(v)?Math.sqrt(v):Math.sqrt(E)*Math.sqrt(Math.PI)}(E))},exp:function(E){return eF(Math.exp(E))},power:function(E,v){return 0===v?0===E?tF:1:0===E?v<0?kF:0:E>0?EU(E,v):function(E){if(E<-nF||E>nF)return!1;if(E===Math.floor(E))return!0;var v=Math.abs(E);return 1+-22.5*aF<=v&&v<=1+2*aF}(v)?EU(E,Math.round(v)):tF},ln:function(E){return eF(Math.log(E))},log10:function(E){return eF(Math.log(E)/Math.LN10)},log:function(E,v){if(E<=0||v<=0)return tF;var A=Math.log(E)/Math.log(v);return isFinite(A)?oF(A):kF},sin:function(E){return Math.abs(E)<Math.pow(2,27)?eF(Math.sin(E)):tF},cos:function(E){return Math.abs(E)<Math.pow(2,27)?eF(Math.cos(E)):tF},tan:function(E){return Math.abs(E)<Math.pow(2,27)?eF(Math.tan(E)):tF},asin:function(E){return eF(Math.asin(E))},acos:function(E){return eF(Math.acos(E))},atan:function(E){return eF(Math.atan(E))},atan2:function(E,v){return 0===E&&0===v?kF:oF(Math.atan2(v,E))}};!function(E){E[E.Array=-2147483648]="Array",E[E.Fun=-2147483647]="Fun",E[E.Let=-2147483646]="Let",E[E.App=-2147483645]="App",E[E.Name=-2147483643]="Name",E[E.CellRef=-2147483642]="CellRef",E[E.Ident=-2147483641]="Ident",E[E.If=-2147483640]="If"}(NU||(NU={}));var CU=(vU=Iv(fv,fv)).wrap,LU=vU.unwrap,FU=(AU=Iv(function(E){return-E},function(E){return-E})).wrap,UU=AU.unwrap;function yU(E){return E>0}function PU(E){return{kind:E,data:void 0,children:void 0}}function VU(E,v,A){var N=PU(NU.Array);return N.children=A,N.data={rows:E,cols:v},N}function GU(E,v){var A=PU(NU.Fun);return A.children=v,A.data=E,A}function HU(E,v,A){var N=PU(NU.Let);return N.children=[v,A],N.data=E,N}function bU(E,v,A){var N=PU(NU.App);return N.children=A,N.data={funName:E,funType:v},N}function _U(E){var v=PU(NU.Ident);return v.data=E,v}function KU(E,v,A){var N=PU(NU.If);return N.children=[E,v,A],N}function WU(E){return"object"!=typeof E||E.kind>0}function XU(E,v){for(var A,N=0;N<E.length;N+=1){var O=E[N],C=v(O);void 0===A?C!==O&&(A=E.slice(0,N)).push(C):A.push(C)}return void 0!==A?A:E}function YU(E,v){return XU(E,function(E){return function(v){return XU(v,E)}}(v))}function JU(E,v){return v(function(E,v){if(WU(E))return E;switch(E.kind){case NU.Let:var A=E.children,N=A[0],O=A[1],C=v(N),L=v(O);return N===C&&O===L?E:HU(E.data,C,L);case NU.App:var F=XU(E.children,v);return F===E.children?E:bU(E.data.funName,E.data.funType,F);case NU.If:var U=E.children,y=U[0],P=U[1],V=U[2],G=v(y),H=v(P),b=v(V);return y===G&&P===H&&V===b?E:KU(G,H,b);case NU.Fun:var _=v(E.children);return _===E.children?E:GU(E.data,_);case NU.Array:var K=YU(E.children,v);return K===E.children?E:VU(E.data.rows,E.data.cols,K);case NU.Name:case NU.CellRef:case NU.Ident:return E}}(E,function(E){return JU(E,v)}))}var jU=function(){function E(E,v,A){Z("calc.common.StrictArray2D",E),Z("calc.common.StrictArray2D",v);var N=A.length;N<E&&j("calc.common.StrictArray2D: expected elements.length >= "+E+"; given "+N);for(var O=0;O<N;O+=1){var C=A[O].length;C<v&&j("calc.common.StrictArray2D: expected elements["+O+"].length >= "+E+"; given "+C)}this.rows=E,this.cols=v,this.elements=A}return E.prototype.get=function(E,v){return R("calc.common.StrictArray2D.get",E,this.rows),R("calc.common.StrictArray2D.get",v,this.cols),this.elements[E][v]},E.prototype.strict=function(){return this},E.prototype.map=function(E){var v=this;return new ZU(this.rows,this.cols,function(A,N){return E(v.elements[A][N])})},E}();var ZU=function(){function E(E,v,A){Z("calc.common.NonstrictArray2D",E),Z("calc.common.NonstrictArray2D",v),this.rows=E,this.cols=v,this.func=A}return E.prototype.get=function(E,v){return R("calc.common.NonstrictArray2D.get",E,this.rows),R("calc.common.NonstrictArray2D.get",v,this.cols),this.func(E,v)},E.prototype.strict=function(){var E=$U(this.rows,this.cols,this.func);return new jU(this.rows,this.cols,E)},E.prototype.map=function(v){var A=this;return new E(this.rows,this.cols,function(E,N){return v(A.func(E,N))})},E}();function $U(E,v,A){for(var N=[],O=0;O<E;O+=1){for(var C=[],L=0;L<v;L+=1)C[L]=A(O,L);N[O]=C}return N}function RU(E){return $U(E.rows,E.cols,E.get.bind(E))}function hU(E,v,A){for(var N=[],O=[],C=0;C<v;C+=1)O[C]=A;for(var L=0;L<E;L+=1)N[L]=O;return N}function BU(E,v,A){return new ZU(E,v,function(E,v){return A})}var wU,xU=vA.FormulaSource,qU=yA.ResultKind,zU=yA.isGridCell,QU=yA.ReasonKind,mU=yA.notImplemented,rU=yA.unavailable;!function(E){E.Timeout="Timeout",E.Stopped="Stopped",E.Unevaluated="Unevaluated",E.NameCycle="NameCycle",E.CellCycle="CellCycle",E.PreviousFailure="PreviousFailure",E.JavaScriptError="JavaScriptError",E.IllFormedFormula="IllFormedFormula"}(wU||(wU={}));var SU,uU,IU=IA({},QU,wU);function fU(E){return{kind:IU.IllFormedFormula,message:E}}function DU(E){return{kind:SU.FinalValue,oper:E}}function sU(E){return{kind:SU.PendingValue,anchor:E}}function TU(E,v,A){return v!==xU.Cell||zU(E.range)||j("calc.runtime.cellFormula: expected single-cell range; given "+H(E)),{kind:SU.Formula,range:E,source:v,formula:A}}!function(E){E.FinalValue="FinalValue",E.PendingValue="PendingValue",E.Formula="Formula"}(SU||(SU={})),function(E){E[E.Continue=1]="Continue",E[E.Stop=2]="Stop"}(uU||(uU={}));var MU={kind:IU.Stopped};function gU(E){return 0===E.length&&j("calc.runtime.unevaluated: expected nonempty array"),{kind:IU.Unevaluated,anchors:E}}function dU(E,v,A,N,O,C,L,F,U,y,P,V,G,H,b,_){return void 0===_&&(_=function(E){return Wv(mU(["getUsedRange"]))}),{config:E,mathpack:v,getDocumentLoc:function(E,v){return jv(A(E,v))},getSheetIndex:N,getCellValue:O,getCellValues:C,getFirstOrderFunc:L,getNameFormula:F,getCellFormula:U,interruptToken:[uU.Continue],schedulerInfo:null!=b?b:{},setCellValue:y,setCellValues:P,setCellFailure:V,setDynamicPrecs:G,loadObjects:H,getUsedRange:_}}function lU(E){return{kind:IU.NameCycle,names:E}}function pU(E){return{kind:IU.CellCycle,cells:E}}function cU(E){return{kind:IU.PreviousFailure,range:E}}function kU(E){return{kind:IU.JavaScriptError,error:E}}function tU(E){return{kind:qU.Paused,reason:IU.Timeout,resume:E}}function aU(E){if(E.kind===qU.Failure)return E.reason.kind}var iU=vA.gridCell,oU=vA.gridRange,eU=NA.arrayOper,nU=NA.naErrorOper,Ey=NA.OperKind,vy=Ey.Number|Ey.String|Ey.Boolean|Ey.Error|Ey.Rich|Ey.Array,Ay=Ey.Number|Ey.String|Ey.Boolean|Ey.Error|Ey.Blank|Ey.Rich,Ny=Ay|Ey.Array;function Oy(E,v,A){var N=E+": generated Excel error, type "+v+"; "+A;X.ULS.traceTag(596120270,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,N)}function Cy(E){return"object"==typeof E&&E.kind===Ey.Error}function Ly(E){return"object"==typeof E&&E.kind===Ey.Blank}function Fy(E){return"object"==typeof E&&E.kind===Ey.Array}function Uy(E){return E.kind===gE.Success?E.value:void 0}function yy(E,v){switch(E.kind){case gE.Success:return Kv(DU(E.value));case gE.Failure:return Wv(cU(v))}}function Py(E,v,A){var N=Fy(A)?function(E,v,A,N,O,C){if(E===A&&v===N)return O;if(1===E&&1===v)return hU(A,N,void 0===O[0]?C:O[0][0]);var L,F=[];L=1===E?function(E,A){return A<v?O[0][A]:C}:1===v?function(v,A){return v<E?O[v][0]:C}:function(A,N){return A<E&&N<v?O[A][N]:C};for(var U=0;U<A;U+=1){F.push([]);for(var y=0;y<N;y+=1)F[U][y]=L(U,y)}return F}(A.rows,A.cols,E,v,A.opers,nU):hU(E,v,A);return eU(E,v,N)}function Vy(E,v){var A=E.row,N=E.col,O=E.rows,C=E.cols,L=v.row,F=v.col,U=v.rows,y=v.cols,P=Math.min(A,L),V=Math.min(N,F),G=Math.max(A+O,L+U)-P,H=Math.max(N+C,F+y)-V;return oU(P,V,G,H)}function Gy(E){return 0===E.length&&j("calc.runtime.gridRangesJoin: expected nonempty range array"),E.reduce(Vy)}function Hy(E,v){var A=E.row,N=E.col,O=E.rows,C=E.cols,L=v.row,F=v.col,U=v.rows,y=v.cols,P=Math.max(A,L),V=Math.max(N,F),G=Math.min(A+O,L+U)-P,H=Math.min(N+C,F+y)-V;if(!(G<=0||H<=0))return oU(P,V,G,H)}function by(E){return E.rows*E.cols}var _y,Ky=CA.NodeKind,Wy=yA.getArguments,Xy=NA.arrayOper,Yy=FA.WorksheetFuncId,Jy=yA.success,jy=(_y=0,function(){var E=_y;return _y+=1,E});function Zy(E){return"object"!=typeof E||WU(E)&&("object"!=typeof(v=E)||v.kind===Ey.Error||v.kind===Ey.Array||v.kind===Ey.Rich);var v}function $y(E,v,A){var N=Wy(A).map(function(A){return Ry(E,v,A)}),O=FA.getWorksheetFuncType(Yy._UDF);return bU(FU(Yy._UDF),O,[Ry(E,v,A.head)].concat(N))}function Ry(E,v,A){switch(A.kind){case Ky.Array:var N=A.nodes.map(function(A){return A.map(function(A){return Ry(E,v,A)})});return W=(K=N).length,Y=void 0===K[0]?0:K[0].length,K.every(function(E){return E.every(Zy)})?Xy(W,Y,K):VU(W,Y,K);case Ky.App:var O=A.head;if(O.kind===Ky.Operator){var C=Wy(A).map(function(A){return Ry(E,v,A)}),L=FA.getOperatorType(O.id);return bU(CU(O.id),L,C)}if(O.kind===Ky.Name&&null==O.qualifier)if(null!=(y=E.config.localeInfo.getWorksheetFuncId(O.whole.toLocaleUpperCase()))){var F=void 0;switch(y){case Yy.LET:F=function(E,v,A){if(3===A.args.length){var N=A.args[0];if(N.kind===Ky.Name&&null==N.qualifier){var O=N.whole,C=jy(),L=sv(v);return L[O]=C,HU(C,Ry(E,v,A.args[1]),Ry(E,L,A.args[2]))}}}(E,v,A);break;case Yy.FUN:F=function(E,v,A){var N=A.args.slice(0,A.args.length-1);if(N.length>0&&N.every(function(E){return E.kind===Ky.Name&&null==E.qualifier})){for(var O=N.map(function(E){return E.whole}),C=O.map(jy),L=sv(v),F=0;F<O.length;F+=1)L[O[F]]=C[F];return GU(C,Ry(E,L,A.args[N.length-1]))}}(E,v,A);break;case Yy.IF:F=function(E,v,A){var N=A.args;return 3===N.length?KU(Ry(E,v,N[0]),Ry(E,v,N[1]),Ry(E,v,N[2])):2===N.length?KU(Ry(E,v,N[0]),Ry(E,v,N[1]),!1):void 0}(E,v,A);break;default:C=Wy(A).map(function(A){return Ry(E,v,A)}),L=FA.getWorksheetFuncType(y);F=bU(FU(y),L,C)}return void 0===F?$y(E,v,A):F}return $y(E,v,A);case Ky.Paren:return Ry(E,v,A.node);case Ky.Name:var y;if(null==A.qualifier)if(void 0!==(y=v[A.whole]))return _U(y);return V=A.whole,G=A.whole.split("."),b=A.qualifier,(_=PU(NU.Name)).data={whole:V.toLocaleUpperCase(),split:G.map(function(E){return E.toLocaleUpperCase()}),qualifier:b},_;case Ky.CellRef:return function(E,v){var A=PU(NU.CellRef);return A.data={ref:E,qualifier:v},A}(A.ref,A.qualifier);case Ky.Literal:return A.oper;case Ky.Bad:var P="calc.runtime.compile: unexpected bad node "+H(A);return X.ULS.assertTag(595980820,U.LogCategory.msoulscat_ES_EWAJS,!1,P);default:return J("calc.runtime.compile",A)}var V,G,b,_,K,W,Y}var hy=function(E){if(!WU(E)&&E.kind===NU.App&&!yU(E.data.funName)){var v=UU(E.data.funName);if(v===Yy.IFERROR||v===Yy.IFNA){var A=jy(),N=_U(A),O=v===Yy.IFERROR?Yy.ISERROR:Yy.ISNA,C=FA.getWorksheetFuncType(O),L=KU(bU(FU(O),C,[N]),E.children[1],N);return HU(A,E.children[0],L)}}return E};var By,wy=function(){return function(E){this.term=E}}();function xy(E,v){return v instanceof wy?v.term:j(E+": expected known compiled formula type; given "+H(v))}function qy(E,v,A,N){var O=Ry(E,Dv(),N.node),C=JU(O,hy);return Jy(new wy(C))}function zy(E){return{compileFormula:function(v,A,N){return qy(E,0,0,N)}}}function Qy(E,v){return 0==(E&v)}function my(E,v){return(E|v-1)&~v}!function(E){E[E.Empty=0]="Empty",E[E.Lf=1]="Lf",E[E.Br=2]="Br"}(By||(By={}));var ry={kind:By.Empty};function Sy(E){return E===ry}function uy(E,v){return{kind:By.Lf,key:E,value:v}}function Iy(E,v,A,N){return{kind:By.Br,prefix:E,mask:v,l:A,r:N}}function fy(E,v,A,N){var O=function(E,v){return A=E^v,A|=A>>>1,A|=A>>>2,A|=A>>>4,A|=A>>>8,(A|=A>>>16)^A>>>1;var A}(E,A),C=my(E,O),L=Qy(E,O);return Iy(C,O,L?v:N,L?N:v)}var Dy,sy=ry,Ty=function E(v,A,N){switch(N.kind){case By.Empty:return uy(v,A);case By.Lf:var O=uy(v,A);return N.key===v?O:fy(v,O,N.key,N);case By.Br:return function(E,v,A){return my(E,A)===v}(v,N.prefix,N.mask)?Qy(v,N.mask)?Iy(N.prefix,N.mask,E(v,A,N.l),N.r):Iy(N.prefix,N.mask,N.l,E(v,A,N.r)):fy(v,uy(v,A),N.prefix,N)}},My=function(E,v){for(var A=v;A.kind===By.Br;)A=Qy(E,A.mask)?A.l:A.r;if(!Sy(A))return E===A.key?A.value:void 0},gy=vA.FormulaSource,dy=yA.isSheetGridCell,ly=function(E){this.reason=E,this.name="EvaluationError",this.stack="EvaluationError",this.message=E.kind};function py(E){throw new ly(E)}function cy(E,v,A,N){return{range:E,source:v,precedents:A,visitedCellMap:N}}function ky(E,v,A,N){if(v===gy.Cell){if(dy(E))return cy(E,v,A,N);j("calc.runtime.evalLocals: expected single-cell range; given "+H(E))}return cy(E,v,A,N)}ly.prototype=Object.create(Error.prototype),ly.prototype.constructor=ly,function(E){E[E.Default=1]="Default",E[E.Dependency=2]="Dependency",E[E.Call=3]="Call",E[E.Write=4]="Write",E[E.Return=5]="Return"}(Dy||(Dy={}));var ty={kind:Dy.Default},ay=function(){function E(E){this.context=E,this.latestTransition=Dy.Default}return E.prototype.cleanup=function(){},E.prototype.performDefaultTransition=function(){return this.latestTransition=Dy.Default,ty},E.prototype.performDependencyTransition=function(E){return this.latestTransition=Dy.Dependency,{kind:Dy.Dependency,machines:E}},E.prototype.performCallTransition=function(E){return this.latestTransition=Dy.Call,{kind:Dy.Call,machine:E}},E.prototype.performWriteTransition=function(E,v){return this.latestTransition=Dy.Write,{kind:Dy.Write,result:E,locals:v}},E.prototype.performReturnTransition=function(E){return this.latestTransition=Dy.Return,{kind:Dy.Return,result:E}},E}(),iy={newVisitedMap:ey,visit:function(E,v,A){return ny(OP,E,v,A)},unVisit:function(E,v,A){return EP(OP,E,v,A)},lookup:function(E,v){return vP(OP,E,v)},runFrom:function(E,v){return AP(OP,E,v)}},oy={newVisitedMap:ey,visit:function(E,v,A){return ny(CP,E,v,A)},unVisit:function(E,v,A){return EP(CP,E,v,A)},lookup:function(E,v){return vP(CP,E,v)},runFrom:function(E,v){return AP(CP,E,v)}};function ey(){return{run:[],visited:Dv()}}function ny(E,v,A,N){var O=E(v);N.visited[O]=A,N.run.push([O,v])}function EP(E,v,A,N){var O=E(v);N.visited[O]=A,N.run.pop()}function vP(E,v,A){return A.visited[E(v)]}function AP(E,v,A){for(var N=[],O=A.run,C=0;C<O.length;){var L=O[C][0];if(E(v)===L)break;C+=1}for(;C<O.length;)N.push(O[C][1]),C+=1;return N}function NP(E){var v=E.document,A=E.index,N="$";return null!=v.path&&(N+=v.path),N+=";",N+=v.name,N+=";",null!=A&&(N+=A,N+=";"),N}function OP(E){var v=NP(E.scope);return v+=";",v+=E.name}function CP(E){var v=NP(E.sheet);return v+=";",v+=E.range.row,v+=";",v+=E.range.col}var LP=NA.SpecialPrecs,FP=NA.precedents,UP=NA.OperKind,yP=yA.failure,PP=yA.sheetGridRangeAnchor,VP=yA.success,GP=yA.ResultKind,HP=function(E){function v(v,A){var N=E.call(this,v)||this;return N.cell=A,N.locals=void 0,N}return uA(v,E),v.prototype.getRealReason=function(E){if(E.kind!==IU.PreviousFailure)return E;var v=PP(E.range),A=oy.lookup(v,this.context.visitedCellMap);return"object"==typeof A&&A.kind===GP.Failure?A.reason:E},v.prototype.visitAnchor=function(E){var v=PP(E.range),A=oy.lookup(v,this.context.visitedCellMap);if(null!=A){var N="calc.runtime.CellEvaluationMachine.visitAnchor: "+("unexpected visitValue at "+H(v)+"; given "+H(A));return X.ULS.assertTag(595980812,U.LogCategory.msoulscat_ES_EWAJS,!1,N)}oy.visit(v,SU.PendingValue,this.context.visitedCellMap);var O=FP([],[],LP.None,!0);return this.locals=ky(E.range,E.source,O,this.context.visitedCellMap),this.locals},v.prototype.unVisitAnchor=function(E){var v=this.locals;if(null!=v){var A=PP(v.range);return oy.unVisit(A,E,this.context.visitedCellMap),this.locals=void 0,v}},v.prototype.next=function(){var E=this.context.globals.getCellValue(this.cell);if(E.kind===GP.Failure)return this.performReturnTransition(yP(this.getRealReason(E.reason)));var v=E.value;if(v.kind===SU.FinalValue)return this.performReturnTransition(VP(v.oper));var A=this.context.globals.getCellFormula(v.anchor);if(A.kind===GP.Failure){var N="calc.runtime.CellEvaluationMachine.next: returning Failure from getCellFormula is deprecated";return X.ULS.assertTag(595980813,U.LogCategory.msoulscat_ES_EWAJS,!1,N)}var O=A.value;if(null==O){N="calc.runtime.CellEvaluationMachine.next: "+("client error: expected getCellFormula("+H(v.anchor)+") != null");return X.ULS.assertTag(595980814,U.LogCategory.msoulscat_ES_EWAJS,!1,N)}var C=this.visitAnchor(O),L=this.context.createFormulaEvaluationMachine(this.context,C,O.formula);return this.performCallTransition(L)},v.prototype.receiveSuccess=function(E){var v=E.value;if("object"==typeof v&&(v.kind===UP.Range||v.kind===UP.Missing)){var A="calc.runtime.CellEvaluationMachine.receiveSuccess: "+("expected ReadOper; given "+H(v));return X.ULS.assertTag(595980815,U.LogCategory.msoulscat_ES_EWAJS,!1,A)}var N=this.unVisitAnchor(void 0);if(null==N){A="calc.runtime.CellEvaluationMachine.receiveSuccess: expected this.locals != null";return X.ULS.assertTag(595980816,U.LogCategory.msoulscat_ES_EWAJS,!1,A)}return this.performWriteTransition(E,N)},v.prototype.receiveFailure=function(E){var v=this.getRealReason(E.reason);if(v.kind===IU.Unevaluated){var A="calc.runtime.CellEvaluationMachine.receiveFailure: "+("unexpected reason "+H(v));return X.ULS.assertTag(595980817,U.LogCategory.msoulscat_ES_EWAJS,!1,A)}var N=v===E.reason?E:yP(v),O=this.unVisitAnchor(N);if(null==O){A="calc.runtime.CellEvaluationMachine.receiveFailure: expected this.locals != null";return X.ULS.assertTag(595980818,U.LogCategory.msoulscat_ES_EWAJS,!1,A)}return this.performWriteTransition(N,O)},v.prototype.cleanup=function(){this.unVisitAnchor(void 0)},v}(ay);function bP(E,v){return new HP(E,v)}function _P(E,v){if(0===v.length)return[];for(var A=DV(E),N=[],O=0;O<v.length;O+=1)N.push(bP(A.machineContext,v[O]));return function E(v,A){var N=v.evaluate(A);return N instanceof Array?N:tU(function(N){return E(v,"number"==typeof N?N:A)})}(new MV(A,N),IV(uV(E.schedulerInfo)))}var KP=vA.FormulaSource,WP=vA.sheetGridCell,XP=vA.sheetGridRange,YP=NA.OperKind,JP=NA.ErrorType,jP=NA.refErrorOper,ZP=NA.valueErrorOper,$P=NA.arrayOper,RP=yA.ResultKind,hP=yA.isGridCell,BP=yA.isSheetIndex,wP=yA.getArgType;function xP(E,v){if(oy.lookup(E,v.visitedCellMap)===SU.PendingValue)return py(pU(oy.runFrom(E,v.visitedCellMap)))}function qP(E,v,A,N){v.precedents.cells.push(A);var O=E.getCellValue(A);if(O.kind===RP.Failure)return py(O.reason);var C=O.value;if(C.kind===SU.FinalValue)return C.oper;xP(C.anchor,v),N.push(C.anchor)}function zP(E,v,A,N){v.precedents.cells.push(A);var O=E.getCellValues(A);if(O.kind===RP.Failure)return py(O.reason);var C=N.length,L=function(E,v,A){for(var N=[],O=v.length,C=0,L=0;L<O;L+=1){N.push([]);var F=v[L].length;C=0===C?F:Math.min(F,C);for(var U=0;U<F;U+=1){var y=v[L][U];SU.FinalValue===y.kind?N[L][U]=y.oper:(xP(y.anchor,E),A.push(y.anchor),N[L][U]=jP)}}return new jU(O,C,N)}(v,O.value,N);return C===N.length?L:void 0}function QP(E,v,A,N){var O=zP(E,v,A,N);if(null!=O)return $P(O.rows,O.cols,RU(O.map(function(E){return Ly(E)?0:E})))}function mP(E,v,A,N,O){if(0!=(N&YP.Range))return A;if("object"!=typeof A||A.kind!==YP.Range)return A;var C=A.sheets;if(!BP(C))return Oy("calc.runtime.dereference",JP.REF,"3D range, oper = "+H(A)),jP;if(1!==A.ranges.length)return Oy("calc.runtime.dereference",JP.VALUE,"union range, oper = "+H(A)),ZP;var L=A.ranges[0];if(0!=(N&Ay)){if(hP(L))return qP(E,v,WP(C,L),O);if(v.source===KP.Cell){var F=function(E,v){var A=E.row,N=E.col,O=v.row,C=v.col,L=v.rows,F=v.cols,U=O<=A&&A<O+L,y=C<=N&&N<C+F;return U&&y?iU(A,N):U&&1===F?iU(A,C):y&&1===L?iU(O,N):void 0}(v.range.range,L);return null==F?(Oy("calc.runtime.dereference",JP.VALUE,"empty intersection, oper = "+H(A)),ZP):qP(E,v,WP(C,F),O)}return QP(E,v,XP(C,L),O)}return 0!=(N&YP.Array)?QP(E,v,XP(C,L),O):(Oy("calc.runtime.dereference",JP.VALUE,"bad target type "+N),ZP)}function rP(E,v,A,N){for(var O=[],C=0;C<A.length;C+=1){var L=mP(E,v,A[C],wP(N,C),O);null!=L&&(A[C]=L)}if(O.length>0)return py(gU(O))}var SP=NA.OperKind,uP=NA.valueErrorOper,IP=NA.arrayOper,fP=yA.operKind,DP=[uP,0,"",!1,!1],sP=SP.Number|SP.String|SP.Boolean;function TP(E){var v=E&sP;return DP[v&-v]}function MP(E,v,A){var N=function E(v,A,N){if("number"==typeof A)return 0!=(N&SP.Number)?A:0!=(N&SP.String)?v.formatNumber(A):0!=(N&SP.Boolean)?0!==A:0!=(N&SP.Array)?IP(1,1,[[A]]):uP;if("string"==typeof A){if(0!=(N&SP.String))return A;if(0!=(N&SP.Number)){if(0===A.length)return uP;var O=v.parseNumber(A);return _v(O)?O:uP}return 0!=(N&SP.Boolean)?0===v.stringCompareCI(A,v.trueName)||0!==v.stringCompareCI(A,v.falseName)&&uP:uP}if("boolean"==typeof A)return 0!=(N&SP.Boolean)?A:0!=(N&SP.Number)?A?1:0:0!=(N&SP.String)?A?v.trueName:v.falseName:uP;if(0!=(N&A.kind))return A;switch(A.kind){case SP.Error:return A;case SP.Missing:return 0!=(N&SP.Blank)?NA.blankOper:TP(N);case SP.Blank:return TP(N);case SP.Rich:return E(v,A.getFallback(),N);default:return uP}}(E.config.localeInfo,v,A);return Cy(N)&&!Cy(v)&&Oy("calc.runtime.coerceOper",N.type,"kind = "+fP(v)),N}var gP=vA.sheetIndex,dP=NA.OperKind,lP=NA.rangeSeqOper,pP=NA.ErrorType,cP=NA.valueErrorOper,kP=NA.div0ErrorOper,tP=NA.nullErrorOper,aP=FA.OperatorId,iP=yA.operKind,oP=yA.isSheetIndex;function eP(E,v){switch(E){case aP.Eq:return 0===v;case aP.Ne:return 0!==v;case aP.Lt:return v<0;case aP.Gt:return v>0;case aP.Le:return v<=0;case aP.Ge:return v>=0}}function nP(E,v,A){return eP(E,v-A)}function EV(E,v,A){return eP(E,v.toLocaleUpperCase().localeCompare(A.toLocaleUpperCase()))}function vV(E,v,A){return eP(E,v<A?-1:v>A?1:0)}function AV(E,v,A){if(oP(v.sheets))if(oP(A.sheets))if(v.sheets.document===A.sheets.document){if(v.sheets.index===A.sheets.index)return gP(v.sheets.document,v.sheets.index);N="different sheet, range1 = "+H(v)+", range2 = "+H(A);Oy(E,pP.VALUE,N)}else{var N="different document, range1 = "+H(v)+", range2 = "+H(A);Oy(E,pP.VALUE,N)}else Oy(E,pP.VALUE,"3D reference, range2 = "+H(A));else Oy(E,pP.VALUE,"3D reference, range1 = "+H(v))}function NV(E,v,A){if(1===A.length){var N=A[0];switch(v){case aP.Percent:return oF(N/100);case aP.Neg:return-N;case aP.Pos:return N;default:var O="bad application of "+v+" to 1 argument";return Oy("calc.runtime.applyOperator",pP.VALUE,O),cP}}if(2===A.length){N=A[0];var C=A[1];switch(v){case aP.Add:return eF(N+C);case aP.Sub:return eF(N-C);case aP.Mul:return eF(N*C);case aP.Div:return 0===C?(Oy("calc.runtime.applyOperator",pP.DIV0,"division by zero"),kP):eF(N/C);case aP.Pow:return E.mathpack.power(N,C);case aP.Concat:return N+C;case aP.Eq:case aP.Ne:case aP.Lt:case aP.Le:case aP.Gt:case aP.Ge:return function(E,v,A){var N=iP(v),O=iP(A);if(N!==O){if(N===dP.Blank)switch(O){case dP.Number:return vV(E,0,A);case dP.String:return EV(E,"",A);case dP.Boolean:return nP(E,!1,A)}if(O===dP.Blank)switch(N){case dP.Number:return vV(E,v,0);case dP.String:return EV(E,v,"");case dP.Boolean:return nP(E,v,!1)}return eP(E,N-O)}switch(N){case dP.Number:return vV(E,v,A);case dP.String:return EV(E,v,A);case dP.Boolean:return nP(E,v,A);case dP.Blank:return eP(E,0);default:return!1}}(v,N,C);case aP.Range:return function(E,v){var A=AV("calc.runtime.applyRangeOp",E,v);if(null==A)return cP;var N=[Vy(Gy(E.ranges),Gy(v.ranges))];return lP(A,N)}(N,C);case aP.Isect:return function(E,v){var A=AV("calc.runtime.applyIsectOp",E,v);if(null==A)return cP;for(var N=[],O=0;O<E.ranges.length;O+=1)for(var C=0;C<v.ranges.length;C+=1){var L=Hy(E.ranges[O],v.ranges[C]);null!=L&&N.push(L)}if(0===N.length){var F="empty intersection, range1 = "+H(E)+", range2 = "+H(v);return Oy("calc.runtime.applyIsectOp",pP.NULL,F),tP}return lP(A,N)}(N,C);case aP.Union:return null==(y=AV("calc.runtime.applyUnionOp",F=N,U=C))?cP:lP(y,F.ranges.concat(U.ranges));case aP.And:return N&&C;case aP.Or:return N||C;case aP.Xor:return N!==C;case aP.Min:return Math.min(N,C);case aP.Max:return Math.max(N,C);default:var L="bad application of "+v+" to 2 arguments";return Oy("calc.runtime.applyOperator",pP.VALUE,L),cP}}var F,U,y,P="bad application of "+v+" to "+A.length+" arguments";return Oy("calc.runtime.applyOperator",pP.VALUE,P),cP}var OV=vA.sheetIndex,CV=vA.sheetGridRange,LV=NA.arrayOper,FV=NA.nameErrorOper,UV=NA.naErrorOper,yV=NA.numErrorOper,PV=NA.valueErrorOper,VV=NA.OperKind,GV=NA.ErrorType,HV=NA.SpecialPrecs,bV=FA.functionType,_V=FA.FunctionFlags,KV=FA.SignatureType,WV=FA.WorksheetFuncId,XV=FA.getOperatorType,YV=FA.getWorksheetFuncType,JV=yA.operKind,jV=yA.ResultKind,ZV=yA.success,$V=yA.getArgType,RV=yA.isValidArgsLength,hV=VV.Number|VV.String|VV.Boolean|VV.Rich|VV.Error|VV.Blank,BV=bV(3,[VV.Boolean,hV,hV],[],KV.All,HV.None,_V.None),wV=function(){function E(E,v){this.globals=E,this.locals=v}return E.prototype.getMathpack=function(){return this.globals.mathpack},E.prototype.applyFunction=function(E,v){var A=YV(E),N=v.some(function(E){return"object"==typeof E&&E.kind===VV.Range})?v.slice(0):v;return rP(this.globals,this.locals,N,A),this.runFunctionToCompletion(FU(E),A,N)},E.prototype.applyOperatorOrFunction=function(E,v){if(yU(E))return NV(this.globals,LU(E),v);var A=UU(E);if(A===WV._UDF)return py(mU(["call UDF"]));var N=this.globals.getFirstOrderFunc(A);if(N.kind===jV.Failure)return py(N.reason);var O=N.value;if(null==O){var C="nonexistent worksheet function "+A;return Oy("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",GV.NAME,C),FV}var L=O(this,v);if("object"==typeof L&&L.kind===VV.Error){C="worksheet function "+A+" return value";Oy("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",L.type,C)}return L},E.prototype.arrayLift=function(E,v,A){for(var N=this,O=0,C=0,L=0;L<A.length;L+=1){var F=A[L];Fy(F)&&0==($V(E,L)&VV.Array)?(O=Math.max(O,F.rows),C=Math.max(C,F.cols)):(O=Math.max(O,1),C=Math.max(C,1))}var U=A.map(function(v,A){return N.broadcastOper(O,C,v,$V(E,A))}),y=new ZU(O,C,function(E,A){return v(U.map(function(v){return v.get(E,A)}))}).map(function(E){var v;if("object"!=typeof(v="object"==typeof E&&E.kind===gF.WorksheetFunction?N.runFunctionMachineToCompletion(E):E))return v;switch(v.kind){case VV.Range:return PV;case VV.Missing:case VV.Blank:return 0;default:return v}});return LV(y.rows,y.cols,RU(y))},E.prototype.dispatchFunction=function(E,v,A){var N=this;if(!RV(v,A.length)){var O=JSON.stringify(v),C="bad application of "+JSON.stringify(E)+" to "+A.length+" arguments, ftype = "+O;return Oy("calc.runtime.FunctionDispatcher.dispatchFunction",GV.NUM,C),yV}for(var L=A.length,F=KV.None,U=0;U<L;U+=1){var y=JV(A[U]);0==(y&$V(v,U))&&(F|=y)}if(F===KV.None)return this.applyOperatorOrFunction(E,A);if(0!=(F&VV.Array)){return this.arrayLift(v,function(A){return N.dispatchFunction(E,v,A)},A)}if(0!=((F&=~VV.Array)&VV.Rich))return py(mU(["calc.runtime.evalFunction.FunctionDispatcher.dispatchFunction: overloading"]));F&=~VV.Rich;var P=[];for(U=0;U<L;U+=1){var V=A[U];if(0!=(F&JV(V))){var G=$V(v,U);if(V=this.coerceOper(V,G),JV(V)===VV.Error&&0==(G&VV.Error))return V}P[U]=V}return this.applyOperatorOrFunction(E,P)},E.prototype.dispatchStrictIf=function(E){var v=this,A=E[0];if("object"!=typeof A){var N=this.coerceOper(A,VV.Boolean);return!0===N?E[1]:!1===N?E[2]:N}switch(A.kind){case VV.Error:return A;case VV.Missing:case VV.Blank:return E[2];case VV.Array:return this.arrayLift(BV,function(E){return v.dispatchStrictIf(E)},E);case VV.Rich:return py(mU(["calc.runtime.evalFunction.FunctionDispatcher.dispatchStrictIf: Strict IF with a rich value condition"]));case VV.Range:var O="calc.runtime.FunctionDispatcher.dispatchStrictIf: "+("internal error: range condition "+H(A));return X.ULS.assertTag(595980809,U.LogCategory.msoulscat_ES_EWAJS,!1,O);default:return J("calc.runtime.FunctionDispatcher.dispatchStrictIf",A)}},E.prototype.dereferenceOper=function(E,v){return function(E,v,A,N){var O=[],C=mP(E,v,A,N,O);if(null==C){if(O.length>0)return py(gU(O));var L="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = "+H(A);return X.ULS.assertTag(595980819,U.LogCategory.msoulscat_ES_EWAJS,!1,L)}return C}(this.globals,this.locals,E,v)},E.prototype.dereferenceOpers=function(E,v){rP(this.globals,this.locals,E,v)},E.prototype.dereferenceAllOpers=function(E){for(var v=[],A=[],N=0;N<E.length;N+=1){var O=E[N];if("object"==typeof O&&O.kind===VV.Range){for(var C=[],L=O.sheets,F=L.index,U=L.length,y=0;y<U;y+=1)for(var P=OV(O.sheets.document,y+F),V=0;V<O.ranges.length;V+=1){var G=CV(P,O.ranges[V]),H=zP(this.globals,this.locals,G,v);null!=H&&C.push(H)}A.push({kind:dF.RangeValues,arrays:C})}else A.push(O)}return v.length>0?py(gU(v)):A},E.prototype.makeOperatorReducer=function(E,v){var A=this.getBinaryOperator(E);return function(E,N){return void 0===E?null!=v?v(N):N:A(E,N)}},E.prototype.makeBranchOperatorReducer=function(E,v){var A=this;return function(N,O){var C=A.makeOperatorReducer(E,v)(N,O);return void 0!==N&&!0===C?N:O}},E.prototype.reduceDerefOpers=function(E,v,A){function N(A,N){if("object"==typeof N){if(N.kind===VV.Array)return O(A,new jU(N.rows,N.cols,N.opers));if(N.kind===VV.Rich)return A}var C=v(N);return null==C?A:E(A,C)}function O(E,v){for(var A=E,O=0;O<v.rows;O+=1)for(var C=0;C<v.cols;C+=1)A=N(A,v.get(O,C));return A}return A.reduce(function(E,v){return"object"==typeof v&&v.kind===dF.RangeValues?v.arrays.reduce(O,E):N(E,v)},void 0)},E.prototype.broadcastOper=function(E,v,A,N){if("object"!=typeof A)return BU(E,v,A);switch(A.kind){case VV.Missing:case VV.Blank:return BU(E,v,0);case VV.Array:return 0!=(N&VV.Array)?BU(E,v,A):function(E,v,A,N){return A.rows===E&&A.cols===v?A:1===A.rows&&1===A.cols?BU(E,v,A.get(0,0)):1===A.rows?new ZU(E,v,function(E,v){return v<A.cols?A.get(0,v):N}):1===A.cols?new ZU(E,v,function(E,v){return E<A.rows?A.get(E,0):N}):new ZU(E,v,function(E,v){return E<A.rows&&v<A.cols?A.get(E,v):N})}(E,v,new jU(A.rows,A.cols,A.opers),UV);case VV.Range:default:return BU(E,v,A)}},E.prototype.coerceOper=function(E,v){return MP(this.globals,E,v)},E.prototype.getBinaryOperator=function(E){var v=this,A=XV(E),N=[0,0];return function(O,C){return N[0]=O,N[1]=C,rP(v.globals,v.locals,N,A),v.runFunctionToCompletion(CU(E),A,N)}},E.prototype.getUnaryOperator=function(E){var v=this,A=XV(E),N=[0];return function(O){return N[0]=O,rP(v.globals,v.locals,N,A),v.runFunctionToCompletion(CU(E),A,N)}},E.prototype.runFunctionToCompletion=function(E,v,A){var N=this.dispatchFunction(E,v,A);return"object"==typeof N&&N.kind===gF.WorksheetFunction?this.runFunctionMachineToCompletion(N):N},E.prototype.runFunctionMachineToCompletion=function(E){for(;;){var v=E.next();if(null!=v)return v}},E}(),xV=function(E){function v(v,A){var N=E.call(this,v)||this;return N.func=A,N}return uA(v,E),v.prototype.next=function(){var E=this.func.next();return null==E?this.performDefaultTransition():this.performReturnTransition(ZV(E))},v.prototype.receiveSuccess=function(E){return X.ULS.assertTag(595980810,U.LogCategory.msoulscat_ES_EWAJS,!1,"calc.runtime.FunctionEvaluationMachine.receiveSuccess: received unexpected result")},v.prototype.receiveFailure=function(E){var v=E.reason;switch(v.kind){case IU.Unevaluated:for(var A=[],N=v.anchors,O=N.length-1;O>=0;O-=1){var C=this.context.createCellEvaluationMachine(this.context,N[O]);A.push(C)}return this.performDependencyTransition(A);default:return this.performReturnTransition(E)}},v}(ay);function qV(E,v){return new xV(E,v)}var zV=vA.FormulaSource,QV=NA.naErrorOper,mV=yA.failure,rV=yA.ResultKind,SV=yA.createResolver;function uV(E){return{yieldIntervalMs:E.yieldIntervalMs,endTimeMs:null==E.totalTimeMs?void 0:Date.now()+E.totalTimeMs,scheduleFunction:null!=E.scheduleFunction?E.scheduleFunction:function(E){return setTimeout(E,0)}}}function IV(E){if(void 0!==E.yieldIntervalMs||void 0!==E.endTimeMs){if(void 0===E.yieldIntervalMs)return E.endTimeMs;var v=Date.now()+E.yieldIntervalMs;return void 0===E.endTimeMs?v:Math.min(E.endTimeMs,v)}}var fV={kind:IU.Timeout};function DV(E){return{globals:E,timer:{doTimeout:function(E){return void 0!==E&&Date.now()>=E}},machineContext:sV(E)}}function sV(E){return{globals:E,visitedCellMap:oy.newVisitedMap(),resolver:SV(E),createCellEvaluationMachine:bP,createFormulaEvaluationMachine:bG,createFunctionEvaluationMachine:qV}}var TV,MV=function(){function E(E,v){$("calc.runtime.EvaluationRuntime",v.length),this.context=E,this.inputMachines=v.slice(),this.evaluationStack=[],this.results=[],this.nextIndex=0,this.currentResult=void 0}return E.prototype.evaluateAsync=function(E){var v=this;if(this.context.globals.interruptToken[0]===uU.Stop)return this.generatePartialResults(),X.ULS.traceTag(595953880,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime cancelled."),Promise.resolve(this.results);if(this.context.timer.doTimeout(E.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var A=this.evaluate(IV(E));return A instanceof Array?(X.ULS.traceTag(595953881,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime complete."),Promise.resolve(A)):(X.ULS.traceTag(595953882,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Evaluation runtime yielding."),new Promise(function(A){return E.scheduleFunction(function(){return X.ULS.traceTag(595964228,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.runtime.evalRuntime.evaluateAsync: Resuming async evaluation."),A(v.evaluateAsync(E))})}))}catch(E){return Promise.reject(mV(E))}},E.prototype.evaluate=function(E){try{for(;;){if(0===this.evaluationStack.length){if(!(this.nextIndex<this.inputMachines.length))return this.results;this.evaluationStack.push(this.inputMachines[this.nextIndex]),this.nextIndex+=1}if(this.context.timer.doTimeout(E))return fV;var v=this.evaluationStack[this.evaluationStack.length-1],A=this.evaluateMachine(v);switch(this.currentResult=void 0,A.kind){case Dy.Default:break;case Dy.Dependency:for(var N=0;N<A.machines.length;N+=1)this.evaluationStack.push(A.machines[N]);break;case Dy.Call:this.evaluationStack.push(A.machine);break;case Dy.Return:case Dy.Write:this.performResultTransition(A);break;case IU.JavaScriptError:this.stopEvaluatingWithJavaScriptError(A);break;default:return J("calc.runtime.EvaluationRuntime.evaluate",A)}}}catch(E){var O="calc.runtime.EvaluationRuntime.evaluate: unhandled error "+E.message;return X.ULS.assertTag(595980807,U.LogCategory.msoulscat_ES_EWAJS,!1,O)}},E.prototype.evaluateMachine=function(E){try{if(null==this.currentResult)return E.next();if(this.currentResult.kind===rV.Success)return E.receiveSuccess(this.currentResult)}catch(E){if(!(E instanceof ly))return kU(E);this.currentResult=mV(E.reason)}try{return E.receiveFailure(this.currentResult)}catch(E){return kU(E)}},E.prototype.performResultTransition=function(E){if(E.kind===Dy.Write)try{this.writeResult(E.locals,E.result)}catch(E){return this.stopEvaluatingWithJavaScriptError(kU(E))}var v=this.evaluationStack.pop();if(null!=v&&v.cleanup(),0===this.evaluationStack.length)this.results.push(E.result);else if(E.result.kind===rV.Success){(A=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Dy.Call&&(this.currentResult=E.result)}else{for(;this.evaluationStack.length>0;){var A;if((A=this.evaluationStack[this.evaluationStack.length-1]).latestTransition===Dy.Dependency)break;if(A.latestTransition===Dy.Call){this.currentResult=E.result;break}var N=this.evaluationStack.pop();null!=N&&N.cleanup()}if(0===this.evaluationStack.length){var O="calc.runtime.EvaluationRuntime.evaluate: "+("internal error: empty stack while returning "+H(E.result));return X.ULS.assertTag(595980808,U.LogCategory.msoulscat_ES_EWAJS,!1,O)}}},E.prototype.writeResult=function(E,v){switch(v.kind){case rV.Success:this.setFormulaValue(E,v.value);break;case rV.Failure:this.context.globals.setCellFailure(E.range,v.reason)}this.context.globals.setDynamicPrecs(E.range,E.precedents)},E.prototype.setFormulaValue=function(E,v){var A=Ly(v)?0:v;if(E.source===zV.Cell){if(Fy(A)){var N=void 0===A.opers[0]?QV:A.opers[0][0];return this.context.globals.setCellValue(E.range,N)}return this.context.globals.setCellValue(E.range,A)}var O=E.range.range,C=Py(O.rows,O.cols,A).opers;return this.context.globals.setCellValues(E.range,C)},E.prototype.generatePartialResults=function(){for(var E=this.inputMachines.length-this.results.length,v=0;v<E;v+=1)this.results.push(mV(MU))},E.prototype.stopEvaluatingWithJavaScriptError=function(E){for(;;){var v=this.evaluationStack.pop();if(null==v)break;v.cleanup()}this.results.push(mV(E))},E}(),gV=vA.documentScope,dV=vA.nameLoc,lV=vA.sheetIndex,pV=vA.sheetRange,cV=vA.gridCell,kV=CA.documentQualifier,tV=CA.QualifierKind,aV=CA.PosKind,iV=CA.CellRefKind,oV=NA.ErrorType,eV=NA.nameErrorOper,nV=NA.refErrorOper,EG=NA.OperKind,vG=NA.arrayOper,AG=NA.range3DOper,NG=NA.rangeSeqOper,OG=yA.gridCellRange,CG=yA.ResultKind,LG=yA.success,FG=yA.failure,UG=yA.sheetGridRangeAnchor,yG=yA.createResolutionHandler,PG=yA.createNameFinder,VG=[void 0,eV],GG=sy;!function(E){E.Document="document",E.Sheet="sheet",E.Ident="sheet, then document"}(TV||(TV={}));var HG=function(E){function v(v,A,N){var O=E.call(this,v)||this;return O.nameEvaluator=yG(PG(function(E){var v=O.getNameFormulaAsTerm(O.locals,E);return void 0!==v&&O.checkForNameCycle(E,O.visitedNameMap),v},VG),function(E){var v="name resolution; qualifier = "+H(E);return Oy("calc.runtime.FormulaEvaluationMachine.evalName",oV.NAME,v),VG},py),O.cellEvaluator=yG(function(E){return AG(E.sheet,E.range)},function(E){var v="error ref, qualifier = "+H(E.data.qualifier);return Oy("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",oV.REF,v),nV},py),O.term=xy("calc.runtime.FormulaEvaluationMachine",N),O.locals=A,O.continuation=[],O.env=GG,O.visitedNameMap=iy.newVisitedMap(),O.dispatcher=new wV(O.context.globals,A),O}return uA(v,E),v.prototype.next=function(){if(WU(this.term)){var E=this.continuation;if(0===E.length){var v=this.dispatcher.dereferenceOper(this.term,Ny),A=this.dispatcher.coerceOper(v,Ny);return X.ULS.traceTag(595964229,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.runtime.evalFormula.next: Formula evaluation finished."),this.performReturnTransition(LG(A))}var N=E[E.length-1];return this.applyContinuation(this.term,N)}return this.reduceFormula(this.term)},v.prototype.receiveSuccess=function(E){return this.updateTermTransition(E.value)},v.prototype.receiveFailure=function(E){var v=E.reason;switch(v.kind){case IU.Unevaluated:for(var A=[],N=v.anchors,O=N.length-1;O>=0;O-=1){var C=this.context.createCellEvaluationMachine(this.context,N[O]);A.push(C)}return this.performDependencyTransition(A);default:return this.performReturnTransition(E)}},v.prototype.applyContinuation=function(E,v){var A=v.context;switch(A.kind){case NU.App:var N=v.holeIndex,O=A.children.length;if((y=v.locals)[N]=E,N+1<O)return this.nextHoleTransition(v,A.children[N+1]);var C=A.data.funName,L=A.data.funType;this.dispatcher.dereferenceOpers(y,L);var F=this.dispatcher.dispatchFunction(C,L,y);return"object"==typeof F&&F.kind===gF.WorksheetFunction?this.evaluateFunctionTransition(F,v.env):this.popContextTransition(v.env,F);case NU.If:var y;if(0===(N=v.holeIndex)){var P=this.dispatcher.dereferenceOper(E,EG.Boolean);if("object"!=typeof P){var V=this.dispatcher.coerceOper(P,EG.Boolean),G=!0===V?A.children[1]:!1===V?A.children[2]:V;return this.popContextTransition(v.env,G)}switch(P.kind){case EG.Error:return this.popContextTransition(v.env,P);case EG.Missing:case EG.Blank:return this.popContextTransition(v.env,A.children[2]);case EG.Array:return v.locals=[P],this.nextHoleTransition(v,A.children[N+1]);case EG.Rich:return this.performReturnTransition(FG(mU(["IF with a rich value condition"])));case EG.Range:var b="calc.runtime.FormulaEvaluationMachine.applyContinuation: "+("internal error: range condition "+H(P));return X.ULS.assertTag(595980811,U.LogCategory.msoulscat_ES_EWAJS,!1,b);default:return J("calc.runtime.FormulaEvaluationMachine.applyContinuation (if)",P)}}if((y=v.locals)[N]=E,1===N)return this.nextHoleTransition(v,A.children[N+1]);this.dispatcher.dereferenceOpers(y,BV);var _=this.dispatcher.dispatchStrictIf(y);return this.popContextTransition(v.env,_);case NU.Name:var K=v.locals;return iy.unVisit(K,void 0,this.visitedNameMap),this.popContextTransition(v.env,E);case NU.Let:var W=A.data,Y=E,j=v.env;return this.popContextTransition(Ty(W,Y,j),A.children[1]);case NU.Array:var Z=this.dispatcher.dereferenceOper(E,vy),$=A.data,R=$.rows,h=$.cols,B=v.holeIndex,w=B%h,x=h===w+1,q=(B-w)/h,z=v.locals;if(z[q][w]=this.dispatcher.coerceOper(Z,vy),R===q+1&&x)return this.popContextTransition(v.env,vG(R,h,z));var Q=x?q+1:q,m=x?0:w+1;return this.nextHoleTransition(v,A.children[Q][m]);default:return J("calc.runtime.FormulaEvaluationMachine.applyContinuation",A)}},v.prototype.reduceFormula=function(E){switch(E.kind){case NU.CellRef:return this.updateTermTransition(this.evalCellRefTerm(this.locals,E));case NU.App:var v=E.data.funName;if(!yU(v)){var A=this.context.globals.getFirstOrderFunc(UU(v));if(A.kind===CG.Failure)return py(A.reason)}if(0===E.children.length){var N=this.dispatcher.dispatchFunction(v,E.data.funType,[]);return"object"==typeof N&&N.kind===gF.WorksheetFunction?this.evaluateFunctionTransition(N,void 0):this.updateTermTransition(N)}return this.pushContextTransition(E,E.children[0],[]);case NU.If:case NU.Let:return this.pushContextTransition(E,E.children[0],void 0);case NU.Name:var O=this.evalName(this.locals,E.data.qualifier,E.data.whole,this.visitedNameMap);return void 0!==O[0]?this.pushContextTransition(E,O[1],O[0]):this.updateTermTransition(O[1]);case NU.Ident:var C=My(E.data,this.env);if(null==C){var L="undefined local "+E.data;Oy("calc.runtime.FormulaEvaluationMachine.reduceFormula",oV.NAME,L)}return this.updateTermTransition(void 0===C?eV:C);case NU.Array:return this.pushContextTransition(E,E.children[0][0],E.children.map(function(){return[]}));case NU.Fun:return this.performReturnTransition(FG(mU(["Step: FunNode to closure"])));default:return J("calc.runtime.FormulaEvaluationMachine.reduceFormula",E)}},v.prototype.pushContextTransition=function(E,v,A){var N=function(E,v,A){return{context:E,holeIndex:0,env:v,locals:A}}(E,this.env,A);return this.continuation[this.continuation.length]=N,this.updateTermTransition(v)},v.prototype.popContextTransition=function(E,v){return this.env=E,this.continuation.pop(),this.updateTermTransition(v)},v.prototype.evaluateFunctionTransition=function(E,v){void 0!==v&&(this.env=v,this.continuation.pop());var A=this.context.createFunctionEvaluationMachine(this.context,E);return this.performCallTransition(A)},v.prototype.nextHoleTransition=function(E,v){return E.holeIndex+=1,this.env=E.env,this.updateTermTransition(v)},v.prototype.updateTermTransition=function(E){return this.term=E,this.performDefaultTransition()},v.prototype.evalDocumentQualifier=function(E){var v=this.context.globals.getDocumentLoc(E.path,E.document);return null!=v?v:TV.Document},v.prototype.getSheetIndex=function(E,v){var A=this.context.globals.getSheetIndex(E,v);return A.kind===CG.Failure?py(A.reason):null==A.value?void 0:A.value},v.prototype.evalSheetQualifier=function(E,v){var A=null==v.document?E.range.sheet.document:this.evalDocumentQualifier(v.document);if("string"==typeof A)return A;var N=this.getSheetIndex(A,v.sheet);return null==N?TV.Sheet:lV(A,N)},v.prototype.evalNameQualifier=function(E,v){var A;switch(v.kind){case tV.Document:return"string"!=typeof(A=this.evalDocumentQualifier(v))?gV(A):A;case tV.Sheet:return this.evalSheetQualifier(E,v);case tV.Ident:A=E.range.sheet.document;var N=this.getSheetIndex(A,v.name);return null!=N?lV(A,N):"string"!=typeof(A=this.evalDocumentQualifier(kV(v.name)))?gV(A):TV.Ident;default:return J("calc.runtime.FormulaEvaluationMachine.evalNameQualifier",v)}},v.prototype.getNameFormulaAsTerm=function(E,v){E.precedents.names.push(v);var A=this.context.globals.getNameFormula(v);if(A.kind===CG.Failure)return py(A.reason);var N=A.value;return null!=N?xy("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",N):void 0},v.prototype.checkNameCycle=function(E,v,A){return void 0!==iy.lookup(E,A)?py(lU(iy.runFrom(E,A))):(iy.visit(E,!0,A),[E,v])},v.prototype.checkForNameCycle=function(E,v){if(void 0!==iy.lookup(E,v))return py(lU(iy.runFrom(E,v)));iy.visit(E,!0,v)},v.prototype.evalName=function(E,v,A,N){if(uv(Qv.CalcUnifyRangeResolutionCode)){var O=UG(E.range),C=this.context.resolver.resolveName(O,v,A);return this.nameEvaluator(v,C)}if(null==v||v.kind===tV.Relative){var L=E.range.sheet,F=dV(L,A);if(null!=(P=this.getNameFormulaAsTerm(E,F)))return this.checkNameCycle(F,P,N);if(F=dV(gV(L.document),A),null!=(P=this.getNameFormulaAsTerm(E,F)))return this.checkNameCycle(F,P,N);var U="name resolution; qualifier = "+H(v);return Oy("calc.runtime.FormulaEvaluationMachine.evalName",oV.NAME,U),[void 0,eV]}var y=this.evalNameQualifier(E,v);if("string"!=typeof y){var P;F=dV(y,A);if(null!=(P=this.getNameFormulaAsTerm(E,F)))return this.checkNameCycle(F,P,N);var V=null==y.index?"document":"sheet",G="name resolution, qualifier = "+H(v)+", resolved to "+V;return Oy("calc.runtime.FormulaEvaluationMachine.evalName",oV.NAME,G),[void 0,eV]}var b="qualifier resolution, qualifier = "+H(v)+", failed on "+y;return Oy("calc.runtime.FormulaEvaluationMachine.evalname",oV.NAME,b),[void 0,eV]},v.prototype.evalPos=function(E,v){return v.kind===aV.Abs?v.index:E+v.index},v.prototype.evalCellRefSingle=function(E,v){return cV(this.evalPos(E.row,v.row),this.evalPos(E.col,v.col))},v.prototype.evalCellRef=function(E,v){var A=E.range.range;switch(v.kind){case iV.Error:return;case iV.Single:var N=this.evalCellRefSingle(A,v);return OG(N,N);case iV.Range:var O=this.evalCellRefSingle(A,v.ref1),C=this.evalCellRefSingle(A,v.ref2);return OG(O,C);case iV.Row:return py(mU(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-row ranges"]));case iV.Col:return py(mU(["calc.runtime.evalFormula.FormulaEvaluationMachine.evalCellRef: whole-column ranges"]))}},v.prototype.evalCellRefTerm=function(E,v){if(uv(Qv.CalcUnifyRangeResolutionCode)){var A=UG(this.locals.range),N=this.context.resolver.resolveCellRef(A,v.data.qualifier,v.data.ref);return this.cellEvaluator(v,N)}var O=E.range.sheet.document,C=v.data.qualifier,L=this.evalCellRef(E,v.data.ref);if(null==L){var F="error ref, qualifier = "+H(C);return Oy("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",oV.REF,F),nV}if(null!=C&&C.kind===tV.Error){F="qualifier resolution, qualifier = "+H(C);return Oy("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",oV.REF,F),nV}if(null!=C&&C.kind===tV.SheetRange){var U=this.getSheetIndex(O,C.sheet1);if(null==U){F="qualifier resolution, qualifier = "+H(C)+", sheet 1";return Oy("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",oV.REF,F),nV}var y=this.getSheetIndex(O,C.sheet2);if(null==y){F="qualifier resolution, qualifier = "+H(C)+", sheet 2";return Oy("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",oV.REF,F),nV}if(U===y)return NG(lV(O,U),[L]);var P=pV(O,Math.min(U,y),Math.abs(y-U)+1);return AG(P,L)}var V=null==C||C.kind===tV.Relative?E.range.sheet:this.evalSheetQualifier(E,C);if("string"==typeof V){F="qualifier resolution, qualifier = "+H(C)+", failed on "+V;return Oy("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",oV.REF,F),nV}return NG(V,[L])},v}(ay);function bG(E,v,A){return X.ULS.traceTag(595964230,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"calc.runtime.evalFormula.createFormulaEvaluationMachine: Creating formula evaluator."),new HG(E,v,A)}function _G(E,v,A,N){var O=DV(E),C=bG(O.machineContext,v,A);return function E(v,A){var N=v.evaluate(A);return N instanceof Array?N[0]:tU(function(N){return E(v,"number"==typeof N?N:A)})}(new MV(O,[C]),N)}var KG=NA.SpecialPrecs,WG=NA.precedents;function XG(E){var v=oy.newVisitedMap();return{evalFormula:function(A,N,O,C){var L=ky(A,N,WG([],[],KG.None,!0),v);return _G(E,L,O,C)},evalCells:function(v){return _P(E,v)},evalCellsAsync:function(v){return function(E,v){if(0===v.length)return Promise.resolve([]);for(var A=DV(E),N=[],O=0;O<v.length;O+=1)N.push(bP(A.machineContext,v[O]));var C=new MV(A,N),L=uV(E.schedulerInfo);return C.evaluateAsync(L)}(E,v)}}}var YG=NA.OperKind,JG=NA.valueErrorOper,jG=NA.div0ErrorOper,ZG=FA.OperatorId,$G=yA.isSheetIndex,RG=32767;function hG(E){if("object"!=typeof E)return"number"==typeof E?E:void 0;switch(E.kind){case YG.Error:return E;case YG.Missing:case YG.Blank:case YG.Rich:return;default:return J("calc.funcs.arithmeticOperationCoerce",E)}}function BG(E,v){var A=E.dereferenceAllOpers(v),N=E.reduceDerefOpers(E.makeOperatorReducer(ZG.Concat,function(v){return E.coerceOper(v,YG.String)}),function(E){return E},A);if(null==N){var O="calc.funcs.concat: returned undefined; args = "+H(v);return X.ULS.assertTag(595969627,U.LogCategory.msoulscat_ES_EWAJS,!1,O)}return"string"==typeof N&&N.length>RG?NA.valueErrorOper:N}function wG(E){var v="object"==typeof E&&E.kind===YG.Blank;return(v=v||""===E)?1:0}function xG(E){return"object"!=typeof E||E.kind!==YG.Blank?1:0}function qG(E,v){var A=v[0];if("object"!=typeof A||A.kind!==YG.Range||!$G(A.sheets)||1!==A.ranges.length)return JG;var N=E.dereferenceAllOpers(v),O=E.makeOperatorReducer(ZG.Add),C=E.reduceDerefOpers(O,xG,N);return null==C?0:C}function zG(E){return function(v){if("boolean"==typeof v)return v;if("number"==typeof v)return E.coerceOper(v,YG.Boolean);if("string"!=typeof v)switch(v.kind){case YG.Error:return v;case YG.Missing:case YG.Blank:case YG.Rich:return;default:return J("funcs.aggregationFuncs: booleanOperationCoerce",v)}}}function QG(E,v){var A=E.dereferenceAllOpers(v),N=E.reduceDerefOpers(E.makeOperatorReducer(ZG.And),zG(E),A);return null==N?JG:N}function mG(E,v){var A=E.dereferenceAllOpers(v),N=E.reduceDerefOpers(E.makeOperatorReducer(ZG.Or),zG(E),A);return null==N?JG:N}function rG(E){return function(v,A){return E(v)(A[0])}}function SG(E){return function(v,A){return E(v)(A[0],A[1])}}var uG=NA.numErrorOper,IG=NA.div0ErrorOper,fG=180/Math.PI,DG=Math.PI/180;function sG(E,v){return Math.PI}var TG=rG(function(E){return E.getMathpack().sqrt}),MG=rG(function(E){return E.getMathpack().exp}),gG=SG(function(E){return E.getMathpack().power}),dG=rG(function(E){return E.getMathpack().ln}),lG=rG(function(E){return E.getMathpack().log10});function pG(E,v){var A=v[0],N=v.length<2?10:v[1];return E.getMathpack().log(A,N)}var cG=rG(function(E){return E.getMathpack().sin}),kG=rG(function(E){return E.getMathpack().cos}),tG=rG(function(E){return E.getMathpack().tan}),aG=rG(function(E){return E.getMathpack().asin}),iG=rG(function(E){return E.getMathpack().acos}),oG=rG(function(E){return E.getMathpack().atan}),eG=SG(function(E){return E.getMathpack().atan2});function nG(E,v){var A=v,N=A[0],O=A[1],C=Math.pow(10,Math.ceil(O));return N<0?-Math.round(-N*C)/C:Math.round(N*C)/C}function EH(E,v){var A=v,N=A[0],O=A[1],C=Math.pow(10,O<0?-Math.floor(-O):Math.floor(O));return N<0?-Math.ceil(-N*C)/C:Math.ceil(N*C)/C}function vH(E,v){var A=v,N=A[0],O=A[1],C=Math.pow(10,O<0?-Math.floor(-O):Math.floor(O));return N<0?-Math.floor(-N*C)/C:Math.floor(N*C)/C}function AH(E,v){var A=v,N=A[0],O=A[1];return 0===O?0:O<0&&N>0?uG:O*Math.ceil(N/O)}function NH(E,v){var A=v,N=A[0],O=A[1];return 0===O?0===N?0:IG:O<0&&N>0?uG:O*Math.floor(N/O)}function OH(E,v){var A=v[0];return 2*(A<0?Math.floor(A/2):Math.ceil(A/2))}function CH(E,v){var A=v[0];return Math.abs(A)}function LH(E,v){var A=v[0];return A>0?1:0===A?0:A<0?-1:uG}function FH(E,v){return v[0]*fG}function UH(E,v){return v[0]*DG}var yH=170;function PH(E,v){var A=v[0];if(!isFinite(A)||A<0)return uG;var N=Math.floor(A+2147483648-2147483648);return N>yH?uG:function E(v){return Z("call just Fact with non Natural value",v),0===v?1:v*E(v-1)}(N)}function VH(E,v){var A=v[0];if(yA.operKind(A)===NA.OperKind.Range){var N=A.sheets,O=A.ranges[0];if(1!==N.length||1!==O.rows||1!==O.cols)return NA.valueErrorOper;A=E.dereferenceOper(A,NA.OperKind.Number)}switch(yA.operKind(A)===NA.OperKind.String&&(A=E.coerceOper(A,NA.OperKind.Number)),yA.operKind(A)){case NA.OperKind.Number:return 0==(1&Math.floor(Math.abs(A)));case NA.OperKind.Error:return A;case NA.OperKind.Missing:return NA.naErrorOper;case NA.OperKind.Blank:return!0;default:return NA.valueErrorOper}}var GH=NA.valueErrorOper;function HH(E){return[E[0],Math.floor(E.length>1?E[1]:1)]}function bH(E,v){var A=HH(v),N=A[0],O=A[1];return O<0?GH:O>=N.length?N:N.substr(N.length-O,O)}function _H(E,v){var A=HH(v),N=A[0],O=A[1];return O<0?GH:O>=N.length?N:N.substr(0,O)}function KH(E,v){var A=v[0],N=v[1]-1,O=Math.floor(v[2]);return N<0||O<0?GH:A.substr(N,O)}function WH(E,v){return v[0].length}var XH={};XH[FA.WorksheetFuncId.SUM]=function(E,v){var A=E.dereferenceAllOpers(v),N=E.reduceDerefOpers(E.makeOperatorReducer(ZG.Add),hG,A);return null==N?0:N},XH[FA.WorksheetFuncId.PRODUCT]=function(E,v){var A=E.dereferenceAllOpers(v),N=E.reduceDerefOpers(E.makeOperatorReducer(ZG.Mul),hG,A);return null==N?0:N},XH[FA.WorksheetFuncId.AVERAGE]=function(E,v){var A,N=E.makeOperatorReducer(ZG.Add),O=E.dereferenceAllOpers(v),C=E.reduceDerefOpers(N,hG,O),L=E.reduceDerefOpers(N,(A=hG,function(E){if(null!=A(E))return 1}),O);if(null!=C&&null!=L)return E.getBinaryOperator(ZG.Div)(C,L);if(null==C&&null==L)return jG;var F="calc.funcs.average: (sumOper == null) !== (countOper == null); args = "+H(v);return X.ULS.assertTag(595980871,U.LogCategory.msoulscat_ES_EWAJS,!1,F)},XH[FA.WorksheetFuncId.CONCAT]=BG,XH[FA.WorksheetFuncId.CONCATENATE]=BG,XH[FA.WorksheetFuncId.COUNTBLANK]=function(E,v){var A=v[0];if("object"!=typeof A||A.kind!==YG.Range||!$G(A.sheets)||1!==A.ranges.length)return JG;var N=E.dereferenceAllOpers(v),O=E.makeOperatorReducer(ZG.Add),C=E.reduceDerefOpers(O,wG,N);return null==C?0:C},XH[FA.WorksheetFuncId.MAX]=function(E,v){var A=E.dereferenceAllOpers(v),N=E.makeBranchOperatorReducer(ZG.Gt,function(E){return!1}),O=E.reduceDerefOpers(N,hG,A);return null==O?0:O},XH[FA.WorksheetFuncId.MIN]=function(E,v){var A=E.dereferenceAllOpers(v),N=E.makeBranchOperatorReducer(ZG.Lt,function(E){return!1}),O=E.reduceDerefOpers(N,hG,A);return null==O?0:O},XH[FA.WorksheetFuncId.ISERROR]=function(E,v){return yA.operKind(v[0])===NA.OperKind.Error},XH[FA.WorksheetFuncId.ISERR]=function(E,v){var A=v[0];return yA.operKind(A)===NA.OperKind.Error&&A.type!==NA.ErrorType.NA},XH[FA.WorksheetFuncId.ISBLANK]=function(E,v){return yA.operKind(v[0])===NA.OperKind.Blank},XH[FA.WorksheetFuncId.ISLOGICAL]=function(E,v){return yA.operKind(v[0])===NA.OperKind.Boolean},XH[FA.WorksheetFuncId.ISNA]=function(E,v){var A=v[0];return yA.operKind(A)===NA.OperKind.Error&&A.type===NA.ErrorType.NA},XH[FA.WorksheetFuncId.ISNONTEXT]=function(E,v){return yA.operKind(v[0])!==NA.OperKind.String},XH[FA.WorksheetFuncId.ISTEXT]=function(E,v){return yA.operKind(v[0])===NA.OperKind.String},XH[FA.WorksheetFuncId.ISNUMBER]=function(E,v){return yA.operKind(v[0])===NA.OperKind.Number},XH[FA.WorksheetFuncId.ISREF]=function(E,v){return yA.operKind(v[0])===NA.OperKind.Range},XH[FA.WorksheetFuncId.ISEVEN]=VH,XH[FA.WorksheetFuncId.ISODD]=function(E,v){var A=VH(E,v);return yA.operKind(A)===NA.OperKind.Boolean?!A:A};var YH,JH,jH=!1;function ZH(E){return jH||(jH=!0,uv(Qv.CalcNewFunctions)&&(XH[FA.WorksheetFuncId.AND]=QG,XH[FA.WorksheetFuncId.OR]=mG,XH[FA.WorksheetFuncId.COUNTA]=qG,XH[FA.WorksheetFuncId.ABS]=CH,XH[FA.WorksheetFuncId.CEILING]=AH,XH[FA.WorksheetFuncId.DEGREES]=FH,XH[FA.WorksheetFuncId.FLOOR]=NH,XH[FA.WorksheetFuncId.RADIANS]=UH,XH[FA.WorksheetFuncId.ROUND]=nG,XH[FA.WorksheetFuncId.ROUNDUP]=EH,XH[FA.WorksheetFuncId.ROUNDDOWN]=vH,XH[FA.WorksheetFuncId.EVEN]=OH,XH[FA.WorksheetFuncId.SIGN]=LH,XH[FA.WorksheetFuncId.PI]=sG,XH[FA.WorksheetFuncId.SQRT]=TG,XH[FA.WorksheetFuncId.EXP]=MG,XH[FA.WorksheetFuncId.POWER]=gG,XH[FA.WorksheetFuncId.LN]=dG,XH[FA.WorksheetFuncId.LOG10]=lG,XH[FA.WorksheetFuncId.LOG]=pG,XH[FA.WorksheetFuncId.SIN]=cG,XH[FA.WorksheetFuncId.COS]=kG,XH[FA.WorksheetFuncId.TAN]=tG,XH[FA.WorksheetFuncId.ASIN]=aG,XH[FA.WorksheetFuncId.ACOS]=iG,XH[FA.WorksheetFuncId.ATAN]=oG,XH[FA.WorksheetFuncId.ATAN2]=eG,XH[FA.WorksheetFuncId.FACT]=PH,XH[FA.WorksheetFuncId.LEFT]=_H,XH[FA.WorksheetFuncId.RIGHT]=bH,XH[FA.WorksheetFuncId.MID]=KH,XH[FA.WorksheetFuncId.LEN]=WH)),XH[E]}(JH=YH||(YH={})).DerefOperKind=dF,JH.FuncKind=gF;var $H=[];function RH(E,v){$H.push(v),50===$H.length&&(X.ULS.traceTag(595944340,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,E+" - collisions: "+$H.join(";")+"."),$H=[])}function hH(E){if(null==E)return"";var v,A=jv(E.sheet.document);A===h?v="illegalDocument":v=(null==A.path?"":"p:"+A.path.toLocaleUpperCase()+",")+"n:"+A.name.toLocaleUpperCase();return v+",i:"+E.sheet.index+",r:"+E.range.row+",c:"+E.range.col}function BH(E){var v=1;return v=31*(v=31*(v=31*(v=31*v+E.sheet.index)+E.range.col)+E.range.row)+E.sheet.document.name.length,void 0!==E.sheet.document.path&&(v=31*v+E.sheet.document.path.length),v}function wH(E,v){var A,N,O=E.sheet.document,C=v.sheet.document;return O.name.toLocaleUpperCase()===C.name.toLocaleUpperCase()&&(A=O.path,N=C.path,null==A?null==N:null==N?null==A:A.toLocaleUpperCase()===N.toLocaleUpperCase())&&E.sheet.index===v.sheet.index&&E.range.col===v.range.col&&E.range.row===v.range.row}function xH(){return{map:{},keyToHash:E=BH,keyEquals:wH,nelements:0,add:function(v){var A=E(v);if(Mv(this.map[A]))this.map[A]=[v],this.nelements+=1;else{for(var N=this.map[A],O=0;O<N.length;O+=1)if(this.keyEquals(v,N[O]))return;RH("calc.common.ds.hashSet",H(v)+" and "+H(N)),N.push(v),this.nelements+=1}},contains:function(v){var A=E(v),N=this.map[A];if(Mv(N))return!1;for(var O=0;O<N.length;O+=1)if(this.keyEquals(v,N[O]))return!0;return RH("calc.common.ds.hashSet",H(v)+" and "+H(N)),!1},forEach:function(E){var v=this;Object.keys(this.map).forEach(function(A){v.map[+A].forEach(function(v){E(v)})})},size:function(){return this.nelements},remove:function(v){var A=this,N=E(v),O=this.map[N];if(Mv(O))return!1;var C=[],L=!1;return O.forEach(function(E){A.keyEquals(v,E)?(A.nelements-=1,L=!0):C.push(E)}),this.map[N]=C,L||RH("calc.common.ds.hashSet",H(v)+" and "+H(O)),L}};var E}var qH=yA.createResolutionHandler,zH=yA.createNameFinder;function QH(E,v){return void 0===E&&void 0===v||void 0!==E&&void 0!==v&&mH(E.name,v.name)&&mH(E.path,v.path)}function mH(E,v){return null==E&&null==v||null!=E&&null!=v&&E.toLocaleUpperCase()===v.toLocaleUpperCase()}function rH(E,v,A,N){var O=function(E,v){if(void 0===E){var A=v.getCurrentDocumentLoc(),N=v.getCurrentSheetIndex();if(null==A||null==N)return;return q(A,N)}switch(E.kind){case LE.Error:return;case LE.Relative:var A=v.getCurrentDocumentLoc(),N=v.getCurrentSheetIndex();if(null==A||null==N)return;return q(A,N);case LE.Sheet:var O=void 0!==E.document?B(E.document.path,E.document.document):v.getCurrentDocumentLoc();if(null==O)return;var C=v.getSheetIndex(O,E.sheet);if(null==C)return;return q(O,C);case LE.SheetRange:if(null==(O=v.getCurrentDocumentLoc()))return;var L=v.getSheetIndex(O,E.sheet1),F=v.getSheetIndex(O,E.sheet2);if(null==L||null==F)return;return L===F?q(O,L):x(O,Math.min(L,F),Math.abs(L-F)+1);default:return J("calc.calc.qualifierToSheet",E)}}(E.qualifier,A);if(void 0!==O)if(QH(v.sheet.document,O.document)||(N.crossDocRefs+=1),Ov(O))switch(O.index!==v.sheet.index&&(N.crossSheetRefs+=1),E.ref.kind){case FE.Error:return void(N.errRefs+=1);case FE.Col:return void(N.columnRefs+=1);case FE.Row:return void(N.rowRefs+=1);case FE.Range:var C=Pv(SH(E.ref.ref1,v),SH(E.ref.ref2,v));return A.maxRangeSize>0&&by(C)>A.maxRangeSize?void(N.largeRanges+=1):M(O,C);case FE.Single:var L=SH(E.ref,v);return g(O,L);default:return J("calc.calc.cellRefToGridLoc",E.ref)}else N.crossSheetRefs+=1;else N.errRefs+=1}function SH(E,v){return m(uH(E.row,v.range.row),uH(E.col,v.range.col))}function uH(E,v){switch(E.kind){case UE.Abs:return E.index;case UE.Rel:return E.index+v}}function IH(E,v){var A=void 0;if(void 0===E.qualifier){var N=v.getCurrentDocumentLoc(),O=v.getCurrentSheetIndex();if(null==N||null==O)return;A=q(N,O)}else switch(E.qualifier.kind){case LE.Document:A=d(B(E.qualifier.path,E.qualifier.document));break;case LE.Relative:N=v.getCurrentDocumentLoc(),O=v.getCurrentSheetIndex();if(null==N||null==O)return;A=q(N,O);break;case LE.Ident:var C=v.getCurrentDocumentLoc();if(null==C)return;var L=v.getSheetIndex(C,E.qualifier.name);A=null==L?d(B(void 0,E.qualifier.name)):q(C,L);break;case LE.Sheet:if(null==(C=void 0!==E.qualifier.document?B(E.qualifier.document.path,E.qualifier.document.document):v.getCurrentDocumentLoc()))return;if(null==(L=v.getSheetIndex(C,E.qualifier.sheet)))return;A=q(C,L);break;default:return J("calc.calc.nameNodeToNameLoc",E.qualifier)}return l(A,E.whole)}function fH(E,v){switch(v.ref.kind){case FE.Error:E.errRefs+=1;break;case FE.Col:E.columnRefs+=1;break;case FE.Row:E.rowRefs+=1}}function DH(E,v){var A=v[E];return void 0===A&&(A=0),A}function sH(){var E={columnRefs:0,crossDocRefs:0,crossSheetRefs:0,dependents:[],errRefs:0,functionsCount:Dv(),largeRanges:0,nameRefs:0,operatorsCount:{},parserErrors:0,rowRefs:0,tableRefs:0,merge:function(v){E.columnRefs+=v.columnRefs,E.crossDocRefs+=v.crossDocRefs,E.crossSheetRefs+=v.crossSheetRefs,E.largeRanges+=v.largeRanges,E.nameRefs+=v.nameRefs,E.parserErrors+=v.parserErrors,E.rowRefs+=v.rowRefs,E.tableRefs+=v.tableRefs,E.errRefs+=v.errRefs,function(E,v){if(uv(Qv.CalcHashSet)){var A=xH();E.forEach(function(E){A.add(E)}),v.forEach(function(v){A.contains(v)||E.push(v)})}else{var N=Dv();E.forEach(function(E){N[hH(E)]=!0}),v.forEach(function(v){var A=hH(v);N[A]||(E.push(v),N[A]=!0)})}}(E.dependents,v.dependents),Object.keys(v.functionsCount).forEach(function(A){var N=E.functionsCount[A];void 0===N&&(N=0),E.functionsCount[A]=N+v.functionsCount[A]}),Object.keys(v.operatorsCount).forEach(function(A){var N=Number(A),O=E.operatorsCount[N];void 0===O&&(O=0),E.operatorsCount[N]=O+v.operatorsCount[N]})}};return E}function TH(E){var v={_logger:E,_dependencyGraph:Dv(),haveDependents:function(E){return void 0!==v._dependencyGraph[hH(E)]},directDependents:function(E){var A=[],N=v._dependencyGraph[hH(E)];return void 0!==N&&N.forEach(function(E){A.push(E)}),A},allDependents:function(E){return v.getDependents(E,!1)},rootDependents:function(E){return v.getDependents(E,!0)},reset:function(){v._dependencyGraph=Dv()},add:function(E,A,N){var O=IA({},E);O.getCurrentDocumentLoc=function(){return jv(E.getCurrentDocumentLoc())};var C=sH();if(null==N)return C;var L=void 0,F=void 0;uv(Qv.CalcUnifyRangeResolutionCode)&&(L=function(E,v,A,N){return qH(zH(function(O){var C=v.nameRefToSheetGridRange(E,O);return null==C?C:(A.addDependency(C,E,v.maxRangeSize,N),C)},void 0),fv,function(){})}(A,O,v,C),F=function(E,v,A,N){return qH(function(O){Ov(O.sheet)||(N.crossSheetRefs+=1),QH(E.sheet.document,O.sheet.document)||(N.crossDocRefs+=1),O.sheet.index!==E.sheet.index&&(N.crossSheetRefs+=1),Lv(O)&&A.addDependency(O,E,v.maxRangeSize,N)},function(E){return fH(N,E)},function(E,v){E.kind===dE.NotImplemented?fH(N,v):N.errRefs+=1})}(A,O,v,C));var y,P,V,G=[];for(G.push(N.node);G.length>0;){var H=G.pop();if(null!=H)switch(H.kind){case yE.Literal:break;case yE.Array:H.nodes.map(function(E){return E.map(function(E){G.push(E)})});break;case yE.App:if("object"==typeof H.head){var b=H.head;switch(b.kind){case yE.Operator:C.operatorsCount[b.id]=(y=b.id,P=C.operatorsCount,V=void 0,void 0===(V=P[y])&&(V=0),V+1);break;case yE.Name:C.functionsCount[b.whole]=DH(b.whole,C.functionsCount)+1;break;default:G.push(b)}}H.args.map(function(E){G.push(E)});break;case yE.Paren:G.push(H.node);break;case yE.Name:if(C.nameRefs+=1,uv(Qv.CalcUnifyRangeResolutionCode)&&void 0!==L)L(void 0,O.resolver.resolveName(A,H.qualifier,H.whole));else if(void 0===L){var _=IH(H,O);if(void 0!==_)null!=(K=O.nameRefToSheetGridRange(A,_))&&v.addDependency(K,A,O.maxRangeSize,C)}else X.ULS.traceTag(595952269,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Error,"Unreachable code hit: nameMapper should never be defined when Resolution BRS is off");break;case yE.CellRef:if(uv(Qv.CalcUnifyRangeResolutionCode)&&void 0!==F)F(H,O.resolver.resolveCellRef(A,H.qualifier,H.ref));else if(void 0===F){var K;void 0!==(K=rH(H,A,O,C))&&v.addDependency(K,A,O.maxRangeSize,C)}else X.ULS.traceTag(595952270,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Error,"Unreachable code hit: cellMapper should never be defined when Resolution BRS is off");break;case yE.Bad:C.parserErrors+=1;break;default:return J("calc.calc.recalcMapperImpl",H)}}return C},merge:function(E){v.mergeGraph(E.dependencyGraph())},dependencyGraph:function(){var E=TH(v._logger);return E.mergeGraph(v._dependencyGraph),E._dependencyGraph},mergeGraph:function(E){var A=function(A){var N=v._dependencyGraph[A],O=E[A];void 0===N&&(N=[]);var C=N;if(uv(Qv.CalcHashSet)){var L=xH();C.forEach(function(E){L.add(E)}),O.forEach(function(E){L.contains(E)||C.push(E)})}else{var F=Dv();C.forEach(function(E){F[hH(E)]=!0}),O.forEach(function(E){F[hH(E)]||C.push(E)})}v._dependencyGraph[A]=C};for(var N in E)A(N)},addDependency:function(E,A,N,O){if(Fv(E)){var C=hH(E);v.updateDependency(C,A)&&O.dependents.push(E)}else if(by(E.range)>N)O.largeRanges+=1;else for(var L=E.range.row;L<E.range.row+E.range.rows;L+=1)for(var F=E.range.col;F<E.range.col+E.range.cols;F+=1){var U=g(E.sheet,m(L,F));v.addDependency(U,A,N,O)}},updateDependency:function(E,A){var N=v._dependencyGraph[E];return void 0===N&&(N=[]),!N.some(function(E){return N=A,O=(v=E).sheet,C=N.sheet,O.document===C.document&&O.index===C.index&&function(E,v){return E.row===v.row&&E.col===v.col}(v.range,N.range);var v,N,O,C})&&(N.push(A),v._dependencyGraph[E]=N,!0)},getDependents:function(E,A){if(uv(Qv.CalcHashSet)){for(var N=xH(),O=[],C=v.directDependents(E);C.length>0;){if(void 0!==(y=C.shift()))if(!N.contains(y))N.add(y),(P=v.directDependents(y)).length>0&&P.forEach(function(E){C.push(E)}),A&&0!==P.length||O.push(y)}return O}for(var L=Dv(),F=[],U=v.directDependents(E);U.length>0;){var y;if(void 0!==(y=U.shift())){var P,V=hH(y);if(!L[V])L[V]=!0,(P=v.directDependents(y)).length>0&&(U=U.concat(P)),A&&0!==P.length||F.push(y)}}return F},stats:function(){var E=Object.keys(v._dependencyGraph);if(void 0===E||0===E.length)return MH(0,0);var A=E.length,N=0;return E.forEach(function(E){var A=v._dependencyGraph[E];N+=A.length}),MH(A,N)}};return v}function MH(E,v){return{nodes:E,arcs:v}}var gH=yA.createResolver,dH=yA.success;function lH(E){return Y(E),TH(E)}function pH(E,v,A,N,O,C,L,F,U,y){return{maxRangeSize:E,nameRefs:v,rowRefs:A,columnRefs:N,crossSheetRefs:O,crossDocRefs:C,getCurrentDocumentLoc:L,getCurrentSheetIndex:F,getSheetIndex:U,nameRefToSheetGridRange:y,resolver:gH({getSheetIndex:function(E,v){return dH(U(E,v))},getDocumentLoc:L})}}var cH=vA.FormulaSource,kH=vA.sheetGridCell,tH=vA.gridCell,aH=vA.documentLoc,iH=vA.sheetIndex,oH=CA.RefStyle,eH=yA.ResultKind,nH=yA.failure;function Eb(E,v,A,N){return{getNumberFormatCategory:E,getCellFormat:v,knownFormats:A,formatValueTypes:N}}function vb(E,v,A){return{config:E,mathpack:v,formatInfo:A}}function Ab(E){var v,A,N,O,C,L,F,y,P,V={globals:E,runtime:(A=(v=E).config,N=v.mathpack,O={config:A},C=IA({config:A},v.formatInfo),L={config:A,mathpack:N},F=sL(O),y=cF(C),P=zy(L),{parser:F,analyzer:y,compiler:P}),cache:Dv(),lazyCreateCacheItem:function(E){var v,A=hH(E),N=V.cache[A];return void 0===N&&(N={cell:E,rawValue:v,formula:void 0,compiledFormula:void 0,evalResult:void 0,format:void 0},V.cache[A]=N),N},size:function(){var E=0;for(var v in V.cache)E+=1;return E},clear:function(){V.cache=Dv()},cells:function(){var E=Object.keys(V.cache);return void 0===E||0===E.length?[]:E.map(function(E){return V.cache[E].cell})},getItem:function(E){var v=hH(E);return V.cache[v]},getValue:function(E){var v=V.getItem(E);if(void 0!==v&&null!==v.rawValue)return v.rawValue},getFormula:function(E,v,A){var N=V.getItem(E);if(void 0!==N&&Nb(V.runtime,N,v,A)&&Ob(N.formula))return N.formula},getFormulaFormat:function(E){var v=V.getItem(E);if(void 0!==v)return v.format},getCompiledFormula:function(E,v){var A=V.getItem(E);if(void 0!==A&&function(E,v,A){if(Ob(v.compiledFormula))return!0;if(!Nb(E,v,A))return!1;if(void 0!==A&&A)return!1;v.compiledFormula=null;try{var N=E.compiler.compileFormula(v.cell,cH.Cell,v.formula);return N.kind===eH.Success&&(v.compiledFormula=N.value,!0)}catch(E){return X.ULS.traceTag(595968586,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"Exception in formulaCache.lazyCompileFormula: "+H(E)),!1}}(V.runtime,A,v)&&Ob(A.compiledFormula))return A.compiledFormula},getEvalResult:function(E){var v=V.getItem(E);if(void 0!==v)return v.evalResult},isEqualValue:function(E,v){var A=V.getItem(E);return void 0!==A&&A.rawValue===v},updateCellValue:function(E,v,A,N,O){if(!V.isEqualValue(E,v)){var C=V.lazyCreateCacheItem(E);if(C.rawValue=v,C.formula=void 0,C.compiledFormula=void 0,C.evalResult=void 0,C.format=void 0,null!=A){var L=A.getValue(E);void 0!==L&&v===L&&(C.formula=A.getFormula(E,!0),C.compiledFormula=A.getCompiledFormula(E,!0),C.evalResult=void 0,C.format=C.format)}null!=O&&(C.format=O),null!=N&&N.forEach(function(E){var v=V.getItem(E);void 0!==v&&(v.evalResult=void 0)})}},updateEvalResult:function(E,v,A){var N=V.lazyCreateCacheItem(E);N.evalResult=v,null!=A&&(N.format=A)},merge:function(E,v){E.cells().forEach(function(A){var N=E.getValue(A);void 0===N||!0!==v&&void 0!==V.getItem(A)||V.updateCellValue(A,N,E)})},parseCompileNameFormula:function(E,v,A){var N,O=void 0===A?oH.A1:A,C=cH.NameManager;if(void 0!==v)N=V.runtime.parser.parseFormula(O,v,C,E);else{var L=iH(aH(void 0,"Doc"),0),F=tH(0,0);N=V.runtime.parser.parseFormula(O,kH(L,F),C,E)}var y=H(E);if(N.kind!==eH.Success){var P="calc.formulaCache.parseCompileNameFormula: couldn't parse "+y;return X.ULS.traceTag(595969230,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,P),nH(MA(P))}var G=V.runtime.analyzer.checkFormula(v,cH.NameManager,N.value);if(G.isWellFormed)return V.runtime.compiler.compileFormula(v,C,G);var b="calc.formulaCache.parseCompileNameFormula: formula "+y+" is not well-formed.";return X.ULS.traceTag(595969231,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,b),nH(fU(b))}};return V}function Nb(E,v,A,N){if(Ob(v.formula))return!0;if(!Ob(v.rawValue))return!1;if(void 0!==v.formula&&null===v.formula)return!1;if(void 0!==A&&A)return!1;v.formula=null;var O=v.rawValue;try{var C=E.parser.parseFormula(CA.RefStyle.A1,v.cell,cH.Cell,O);if(C.kind!==eH.Success)return!1;var L=E.analyzer.checkFormula(v.cell,cH.Cell,C.value,N);if(!L.isWellFormed)return!1;if(v.formula=L,uv(Qv.CalcFormatCalculations)){var F=E.analyzer.findBestFormat(v.cell,cH.Cell,L);v.format=void 0===F?void 0:F.iformat}return!0}catch(E){return X.ULS.traceTag(595968585,U.LogCategory.msoulscat_ES_EWAJS,U.TraceLevel.Info,"Exception in formulaCache.lazyParseFormula: "+H(E)),!1}}function Ob(E){return null!=E}A.d(v,"location",function(){return vA}),A.d(v,"formula",function(){return CA}),A.d(v,"value",function(){return NA}),A.d(v,"signature",function(){return FA}),A.d(v,"util",function(){return yA}),A.d(v,"config",function(){return VA}),A.d(v,"parse",function(){return N}),A.d(v,"analyze",function(){return O}),A.d(v,"runtime",function(){return C}),A.d(v,"calc",function(){return L}),A.d(v,"funcs",function(){return F})}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map